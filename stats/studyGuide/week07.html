<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Study Guide: Statistics for Informatics - 7&nbsp; More about Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week08.html" rel="next">
<link href="./week06.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
#quarto-sidebar .menu-text {
  display: flex;
}
#quarto-sidebar .chapter-number {
  display: block;
  width: 1.5rem;
  text-align: right;
}
#quarto-sidebar .chapter-title {
  display: block;
  padding-left: 8px;
  text-indent: -2px;
  width: 100%;
}
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week07.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">More about Inference</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Study Guide: Statistics for Informatics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to the Course</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Numerical and Visual Data Summaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">More about R and Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Distributions of Random Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Details of <code>ggplot2</code>; Introduction to Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week07.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">More about Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for Numerical Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">More Linear Regression; Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Coping with Time and Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Milestone 4; Take-home Exam</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Human Computer Interaction Experiments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#recap-week-06" id="toc-recap-week-06" class="nav-link active" data-scroll-target="#recap-week-06"><span class="header-section-number">7.1</span> Recap Week 06</a>
  <ul class="collapse">
  <li><a href="#a-useful-ggplot-trick" id="toc-a-useful-ggplot-trick" class="nav-link" data-scroll-target="#a-useful-ggplot-trick"><span class="header-section-number">7.1.1</span> A useful ggplot trick</a></li>
  <li><a href="#preparing-data" id="toc-preparing-data" class="nav-link" data-scroll-target="#preparing-data"><span class="header-section-number">7.1.2</span> Preparing data</a></li>
  </ul></li>
  <li><a href="#textbook-section-6.1-inference-for-a-single-proportion" id="toc-textbook-section-6.1-inference-for-a-single-proportion" class="nav-link" data-scroll-target="#textbook-section-6.1-inference-for-a-single-proportion"><span class="header-section-number">7.2</span> Textbook section 6.1 Inference for a single proportion</a>
  <ul class="collapse">
  <li><a href="#is-the-sample-proportion-nearly-normal" id="toc-is-the-sample-proportion-nearly-normal" class="nav-link" data-scroll-target="#is-the-sample-proportion-nearly-normal"><span class="header-section-number">7.2.1</span> Is the sample proportion nearly normal?</a></li>
  <li><a href="#confidence-interval-for-a-proportion" id="toc-confidence-interval-for-a-proportion" class="nav-link" data-scroll-target="#confidence-interval-for-a-proportion"><span class="header-section-number">7.2.2</span> Confidence interval for a proportion</a></li>
  <li><a href="#prepare-check-calculate-conclude-cycle" id="toc-prepare-check-calculate-conclude-cycle" class="nav-link" data-scroll-target="#prepare-check-calculate-conclude-cycle"><span class="header-section-number">7.2.3</span> Prepare, Check, Calculate, Conclude Cycle</a></li>
  <li><a href="#same-cycle-for-hypothesis-testing-for-a-proportion" id="toc-same-cycle-for-hypothesis-testing-for-a-proportion" class="nav-link" data-scroll-target="#same-cycle-for-hypothesis-testing-for-a-proportion"><span class="header-section-number">7.2.4</span> Same cycle for hypothesis testing for a proportion</a></li>
  <li><a href="#choosing-sample-size-when-estimating-a-proportion" id="toc-choosing-sample-size-when-estimating-a-proportion" class="nav-link" data-scroll-target="#choosing-sample-size-when-estimating-a-proportion"><span class="header-section-number">7.2.5</span> Choosing sample size when estimating a proportion</a></li>
  </ul></li>
  <li><a href="#textbook-section-6.2-difference-of-two-proportions" id="toc-textbook-section-6.2-difference-of-two-proportions" class="nav-link" data-scroll-target="#textbook-section-6.2-difference-of-two-proportions"><span class="header-section-number">7.3</span> Textbook section 6.2 Difference of two proportions</a>
  <ul class="collapse">
  <li><a href="#confidence-intervals-for-p_1-p_2" id="toc-confidence-intervals-for-p_1-p_2" class="nav-link" data-scroll-target="#confidence-intervals-for-p_1-p_2"><span class="header-section-number">7.3.1</span> Confidence intervals for <span class="math inline">\(p_1-p_2\)</span></a></li>
  <li><a href="#hypothesis-testing-for-p_1-p_2" id="toc-hypothesis-testing-for-p_1-p_2" class="nav-link" data-scroll-target="#hypothesis-testing-for-p_1-p_2"><span class="header-section-number">7.3.2</span> Hypothesis testing for <span class="math inline">\(p_1-p_2\)</span></a></li>
  </ul></li>
  <li><a href="#textbook-section-6.3-testing-goodness-of-fit-using-chi2" id="toc-textbook-section-6.3-testing-goodness-of-fit-using-chi2" class="nav-link" data-scroll-target="#textbook-section-6.3-testing-goodness-of-fit-using-chi2"><span class="header-section-number">7.4</span> Textbook section 6.3 Testing goodness of fit using <span class="math inline">\(\chi^2\)</span></a>
  <ul class="collapse">
  <li><a href="#the-chi2-distribution" id="toc-the-chi2-distribution" class="nav-link" data-scroll-target="#the-chi2-distribution"><span class="header-section-number">7.4.1</span> The <span class="math inline">\(\chi^2\)</span> distribution</a></li>
  <li><a href="#chi2-test" id="toc-chi2-test" class="nav-link" data-scroll-target="#chi2-test"><span class="header-section-number">7.4.2</span> <span class="math inline">\(\chi^2\)</span> test</a></li>
  </ul></li>
  <li><a href="#textbook-section-6.4-testing-independence-in-2-way-tables" id="toc-textbook-section-6.4-testing-independence-in-2-way-tables" class="nav-link" data-scroll-target="#textbook-section-6.4-testing-independence-in-2-way-tables"><span class="header-section-number">7.5</span> Textbook section 6.4 Testing independence in 2-way tables</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">More about Inference</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="recap-week-06" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="recap-week-06"><span class="header-section-number">7.1</span> Recap Week 06</h2>
<ul>
<li>ggplot2</li>
<li>Foundations for Inference
<ul>
<li>Point estimates</li>
<li>Confidence Intervals</li>
<li>Hypothesis Tests</li>
</ul></li>
</ul>
<section id="a-useful-ggplot-trick" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="a-useful-ggplot-trick"><span class="header-section-number">7.1.1</span> A useful ggplot trick</h3>
<p>Some of you have struggled to produce boxplots of variables like <code>price</code> and <code>odometer</code> because they have ridiculous outliers. One way to overcome this that we’ve explored is to remove the extreme observations. A possibly better way, though, is illustrated below. Saying <code>outlier.shape=NA</code> in the <code>geom_boxplot()</code> function removes outliers before the dimensions of the plot are calculated. The result is a much more readable boxplot containing most of the cars.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/vehicles.Rdata"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(condition,odometer))<span class="sc">+</span><span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>)<span class="sc">+</span>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>odometer, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 131132 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="week07_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(condition,price))<span class="sc">+</span><span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>)<span class="sc">+</span>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>price, <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 127440 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="week07_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that, in the above example, I’ve stored <code>df</code> in <code>vehicles.Rdata</code> using the <code>save()</code> function. Before saving it I converted <code>condition</code> to a factor and both <code>price</code> and <code>odometer</code> to numeric.</p>
</section>
<section id="preparing-data" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="preparing-data"><span class="header-section-number">7.1.2</span> Preparing data</h3>
<p>Note that you can use the above quantile trick in other ways. For example, here I’m filtering out the extreme values of price, without necessarily knowing what they are.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price <span class="sc">&gt;=</span> <span class="fu">quantile</span>(price,.<span class="dv">10</span>) <span class="sc">&amp;</span> price <span class="sc">&lt;=</span> <span class="fu">quantile</span>(price,.<span class="dv">90</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n=</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 51 × 2
   state     n
   &lt;chr&gt; &lt;int&gt;
 1 ca    39707
 2 fl    23260
 3 tx    18285
 4 ny    15956
 5 oh    15086
 6 mi    14959
 7 pa    11787
 8 nc    11105
 9 or    10875
10 wi    10194
11 tn     9466
12 co     9335
# ℹ 39 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="textbook-section-6.1-inference-for-a-single-proportion" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="textbook-section-6.1-inference-for-a-single-proportion"><span class="header-section-number">7.2</span> Textbook section 6.1 Inference for a single proportion</h2>
<section id="is-the-sample-proportion-nearly-normal" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="is-the-sample-proportion-nearly-normal"><span class="header-section-number">7.2.1</span> Is the sample proportion nearly normal?</h3>
<p>Note: The book uses <span class="math inline">\(p\)</span> in two ways: as a <span class="math inline">\(p\)</span>-value in a hypothesis test, and as <span class="math inline">\(p\)</span>, a population proportion. Related to the population proportion is the sample proportion, <span class="math inline">\(\hat{p}\)</span>, pronounced p-hat. Too many <span class="math inline">\(p\)</span>s!</p>
<p>The sampling distribution for <span class="math inline">\(\hat{p}\)</span> based on a sample of size <span class="math inline">\(n\)</span> from a population with a true proportion <span class="math inline">\(p\)</span> is nearly normal when:</p>
<ol type="1">
<li>The sample’s observations are independent, e.g., are from a simple random sample.</li>
<li>We expected to see at least 10 successes and 10 failures in the sample, i.e., <span class="math inline">\(np \geqslant 10\)</span> and <span class="math inline">\(n(1 − p) \geqslant 10\)</span>. This is called the success-failure condition.</li>
</ol>
<p>When these conditions are met, then the sampling distribution of <span class="math inline">\(\hat{p}\)</span> is nearly normal with mean <span class="math inline">\(p\)</span> and standard error <span class="math inline">\(\text{SE}=\sqrt{p(1-p)/n}\)</span>.</p>
</section>
<section id="confidence-interval-for-a-proportion" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="confidence-interval-for-a-proportion"><span class="header-section-number">7.2.2</span> Confidence interval for a proportion</h3>
<p>A confidence interval provides a range of plausible values for the parameter <span class="math inline">\(p\)</span>, and when <span class="math inline">\(\hat{p}\)</span> can be modeled using a normal distribution, the confidence interval for <span class="math inline">\(p\)</span> takes the form</p>
<p><span class="math display">\[ \hat{p} \pm z^{*} \times \text{SE} \]</span></p>
<p>where <span class="math inline">\(z^{*}\)</span> marks the <span class="math inline">\(x\)</span>-axis for the selected confidence interval, e.g., 1.96 for a 95 percent confidence interval.</p>
</section>
<section id="prepare-check-calculate-conclude-cycle" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="prepare-check-calculate-conclude-cycle"><span class="header-section-number">7.2.3</span> Prepare, Check, Calculate, Conclude Cycle</h3>
<p>The OpenIntro Stats book recommends a four step cycle for both confidence intervals and hypothesis tests. It differs a bit from the seven step hypothesis testing method given in Week 06, but achieves the same result.</p>
<ul>
<li>Prepare. Identify <span class="math inline">\(\hat{p}\)</span> and <span class="math inline">\(n\)</span>, and determine what confidence level you wish to use.</li>
<li>Check. Verify the conditions to ensure <span class="math inline">\(\hat{p}\)</span> is nearly normal. For one-proportion confidence intervals, use <span class="math inline">\(\hat{p}\)</span> in place of <span class="math inline">\(p\)</span> to check the success-failure condition.</li>
<li>Calculate. If the conditions hold, compute SE using <span class="math inline">\(\hat{p}\)</span>, find <span class="math inline">\(z^{*}\)</span>, and construct the interval.</li>
<li>Conclude. Interpret the confidence interval in the context of the problem.</li>
</ul>
</section>
<section id="same-cycle-for-hypothesis-testing-for-a-proportion" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="same-cycle-for-hypothesis-testing-for-a-proportion"><span class="header-section-number">7.2.4</span> Same cycle for hypothesis testing for a proportion</h3>
<ul>
<li>Prepare. Identify the parameter of interest, list hypotheses, identify the significance level, and identify <span class="math inline">\(\hat{p}\)</span> and <span class="math inline">\(n\)</span>.</li>
<li>Check. Verify conditions to ensure <span class="math inline">\(\hat{p}\)</span> is nearly normal under <span class="math inline">\(H_0\)</span>. For one-proportion hypothesis tests, use the null value to check the success-failure condition.</li>
<li>Calculate. If the conditions hold, compute the standard error, again using <span class="math inline">\(p_0\)</span>, compute the <span class="math inline">\(Z\)</span>-score, and identify the <span class="math inline">\(p\)</span>-value.</li>
<li>Conclude. Evaluate the hypothesis test by comparing the <span class="math inline">\(p\)</span>-value to <span class="math inline">\(\alpha\)</span>, and provide a conclusion in the context of the problem.</li>
</ul>
</section>
<section id="choosing-sample-size-when-estimating-a-proportion" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="choosing-sample-size-when-estimating-a-proportion"><span class="header-section-number">7.2.5</span> Choosing sample size when estimating a proportion</h3>
<p>This is probably the most important part of this section for practical purposes. The following expression denotes the <em>margin of error</em>:</p>
<p><span class="math display">\[ z^{*}\sqrt{\frac{p(1-p)}{n}} \]</span></p>
<p>You have to choose the margin of error you want to report. The book gives an example of 0.04. So you want to find</p>
<p><span class="math display">\[ z^{*}\sqrt{\frac{p(1-p)}{n}} &lt; 0.04 \]</span></p>
<p>The problem is that you don’t know <span class="math inline">\(p\)</span>. Since the worst-case scenario is <span class="math inline">\(p=0.5\)</span>, you have to use that unless you have some information about <span class="math inline">\(p\)</span>. Recall that <span class="math inline">\(z^{*}\)</span> represents the <span class="math inline">\(z\)</span>-score for the desired confidence level, so you have to choose that. The book gives an example where you want a 95 percent confidence level, so you choose 1.96. You could find this out in R by saying</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.025</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
</div>
<p>returning the <span class="math inline">\(z\)</span>-score for the upper tail. The reason for saying that 0.025 instead of 0.05 is that the probability of 0.05 is split between the tails. The complementary function is <code>pnorm(1.959964,lower.tail=FALSE)</code>, which will return 0.025.</p>
<p>Once you have decided on values for <span class="math inline">\(p\)</span> and <span class="math inline">\(z^*\)</span>, solve the above inequality for <span class="math inline">\(n\)</span>.</p>
</section>
</section>
<section id="textbook-section-6.2-difference-of-two-proportions" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="textbook-section-6.2-difference-of-two-proportions"><span class="header-section-number">7.3</span> Textbook section 6.2 Difference of two proportions</h2>
<p>In this section, we’re just modifying the previous section to account for a difference instead of a single proportion.</p>
<p>The difference <span class="math inline">\(\hat{p}_1-\hat{p}_2\)</span> can be modeled using the normal distribution when</p>
<ul>
<li>The data are independent within and between the two groups (random samples or randomized experiment)</li>
<li>The success-failure condition holds for both groups (at least 10 successes and 10 failures in each sample)</li>
</ul>
<section id="confidence-intervals-for-p_1-p_2" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="confidence-intervals-for-p_1-p_2"><span class="header-section-number">7.3.1</span> Confidence intervals for <span class="math inline">\(p_1-p_2\)</span></h3>
<p><span class="math display">\[ \text{point estimate } \pm z^* \times \text{SE} \rightarrow \hat{p}_1 - \hat{p}_2 \times \sqrt{\frac{p_1(1-p_1)}{n_1}+\frac{p_2(1-p_2)}{n_2}} \]</span></p>
</section>
<section id="hypothesis-testing-for-p_1-p_2" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="hypothesis-testing-for-p_1-p_2"><span class="header-section-number">7.3.2</span> Hypothesis testing for <span class="math inline">\(p_1-p_2\)</span></h3>
<p>When the null hypothesis is that the proportions are equal, use the pooled proportion (<span class="math inline">\(\hat{p}_\text{pooled}\)</span>) to verify the success-failure condition and estimate the standard error</p>
<p><span class="math display">\[ \hat{p}_\text{pooled} = \frac{\text{number of “successes”}}{\text{number of cases}} = \frac{\hat{p}_1n_1+\hat{p}_2n_2}{n_1+n_2} \]</span></p>
<p>Here <span class="math inline">\(\hat{p}_1n_1\)</span> represents the number of successes in sample 1 since</p>
<p><span class="math display">\[ \hat{p}_1 = \frac{\text{number of successes in sample 1}}{n_1} \]</span></p>
<p>Similarly, <span class="math inline">\(\hat{p}_2n_2\)</span> represents the number of successes in sample 2.</p>
</section>
</section>
<section id="textbook-section-6.3-testing-goodness-of-fit-using-chi2" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="textbook-section-6.3-testing-goodness-of-fit-using-chi2"><span class="header-section-number">7.4</span> Textbook section 6.3 Testing goodness of fit using <span class="math inline">\(\chi^2\)</span></h2>
<p>The <span class="math inline">\(\chi^2\)</span> test, pronounced k<span class="math inline">\(\overline{\text{i}}\)</span> square, is useful in many circumstances. The textbook treats two such circumstances:</p>
<ol type="1">
<li>Suppose your sample can be divided into groups, as can the general population. Does your sample represent the general population?</li>
<li>Does your sample resemble a particular distribution, such as the normal distribution?</li>
</ol>
<p>For the first circumstance, we could divide a sample of people into races or genders and we would like to examine all at once for resemblance to the general population, rather than in pairs. The <span class="math inline">\(\chi^2\)</span> statistic will permit an all-at-once comparison.</p>
<p>The <span class="math inline">\(\chi^2\)</span> statistic is given by the following formula for <span class="math inline">\(g\)</span> groups.</p>
<p><span class="math display">\[ \chi^2 = \frac{(\text{observed count}_1-\text{null count}_1)^2}{\text{null count}_1} + \cdots + \frac{(\text{observed count}_g-\text{null count}_g)^2}{\text{null count}_g} \]</span></p>
<p>where the expression <em>null count</em> refers to the expected number of objects in the group. You have to be careful about how you determine the null count. For instance, the textbook gives an example of races of jurors. In such a case, the null counts should come from the population who can be selected as jurors. This might be a matter of some dispute since jurors are usually recruited through voting records and these records may not reflect the correct proportions. Statisticians tend to like things they can count, and some people are harder (more expensive) to count than others, particularly people in marginalized populations.</p>
<section id="the-chi2-distribution" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="the-chi2-distribution"><span class="header-section-number">7.4.1</span> The <span class="math inline">\(\chi^2\)</span> distribution</h3>
<p>The <span class="math inline">\(\chi^2\)</span> distribution is sometimes used to characterize data sets and statistics that are always positive and typically right skewed. Recall a normal distribution had two parameters – mean and standard deviation – that could be used to describe its exact characteristics. The <span class="math inline">\(\chi^2\)</span> distribution has just one parameter called degrees of freedom (df), which influences the shape, center, and spread of the distribution. Here is a picture of the <span class="math inline">\(\chi^2\)</span> distribution for several values of df.</p>
<div class="cell" data-engine.opts="{&quot;extra.preamble&quot;:[&quot;\usepackage{pgfplots,stix,pagecolor}&quot;,&quot;\pgfplotsset{compat=1.18}&quot;]}">
<div class="cell-output-display">
<p><img src="week07_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the jurors example, we can calculate the appropriate <span class="math inline">\(p\)</span>-value in R by using the <span class="math inline">\(\chi^2\)</span> statistic calculated from the sample, 5.89, and the parameter <span class="math inline">\(k-1\)</span> which is the number of groups minus one, using R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fl">5.89</span>,<span class="dv">3</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1170863</code></pre>
</div>
</div>
<p>This is a relatively large <span class="math inline">\(p\)</span>-value given our earlier choices of cutoffs of 0.1, 0.05, and 0.01.</p>
</section>
<section id="chi2-test" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="chi2-test"><span class="header-section-number">7.4.2</span> <span class="math inline">\(\chi^2\)</span> test</h3>
<p>The <span class="math inline">\(\chi^2\)</span> test can be conducted in R for the juror example given in the book as follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">205</span>,<span class="dv">26</span>,<span class="dv">25</span>,<span class="dv">19</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">198</span>,<span class="fl">19.25</span>,<span class="dv">33</span>,<span class="fl">24.75</span>)<span class="sc">/</span><span class="fu">sum</span>(o)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(o,<span class="at">p=</span>e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  o
X-squared = 5.8896, df = 3, p-value = 0.1171</code></pre>
</div>
</div>
<p>Note that I had to make an adjustment in R. The R variable <code>p</code> is supposed to be a vector of probabilities summing to 1. The way the table in the book presented it, it was not a vector of probabilities summing to one. So I divided each element of the input vector for <code>e</code> by the sum of the vector <code>o</code>.</p>
</section>
</section>
<section id="textbook-section-6.4-testing-independence-in-2-way-tables" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="textbook-section-6.4-testing-independence-in-2-way-tables"><span class="header-section-number">7.5</span> Textbook section 6.4 Testing independence in 2-way tables</h2>
<p>Suppose you have a two way table. Datacamp gives an example of gender and sport as the two ways. The following data frame lists the number of males and females who like the following three sports: archery, boxing, and cycling. The <span class="math inline">\(\chi^2\)</span> tests suggests that the genders are not independent for the three sports, meaning that the preferences may differ by gender.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">15</span>,<span class="dv">50</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>male <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">60</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(male,female)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"archery"</span>,<span class="st">"boxing"</span>,<span class="st">"cycling"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        male female
archery   10     35
boxing    30     15
cycling   60     50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  df
X-squared = 19.798, df = 2, p-value = 5.023e-05</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week06.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Details of <code>ggplot2</code>; Introduction to Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week08.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for Numerical Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>