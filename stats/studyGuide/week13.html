<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Study Guide: Statistics for Informatics - 13&nbsp; Human Computer Interaction Experiments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./week12.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
#quarto-sidebar .menu-text {
  display: flex;
}
#quarto-sidebar .chapter-number {
  display: block;
  width: 1.5rem;
  text-align: right;
}
#quarto-sidebar .chapter-title {
  display: block;
  padding-left: 8px;
  text-indent: -2px;
  width: 100%;
}
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week13.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Human Computer Interaction Experiments</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Study Guide: Statistics for Informatics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to the Course</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Numerical and Visual Data Summaries</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">More about R and Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Distributions of Random Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Details of <code>ggplot2</code>; Introduction to Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">More about Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for Numerical Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">More Linear Regression; Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Coping with Time and Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Milestone 4; Take-home Exam</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week13.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Human Computer Interaction Experiments</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#how-many-prefer-this-over-that-tests-of-proportions" id="toc-how-many-prefer-this-over-that-tests-of-proportions" class="nav-link active" data-scroll-target="#how-many-prefer-this-over-that-tests-of-proportions"><span class="header-section-number">13.1</span> How many prefer this over that? (Tests of proportions)</a>
  <ul class="collapse">
  <li><a href="#how-many-prefer-website-a-over-b-one-sample-test-of-proportions-in-two-categories" id="toc-how-many-prefer-website-a-over-b-one-sample-test-of-proportions-in-two-categories" class="nav-link" data-scroll-target="#how-many-prefer-website-a-over-b-one-sample-test-of-proportions-in-two-categories"><span class="header-section-number">13.1.1</span> How many prefer website A over B? (One sample test of proportions in two categories)</a></li>
  <li><a href="#how-many-prefer-website-a-b-or-c-one-sample-test-of-proportions-in-three-categories" id="toc-how-many-prefer-website-a-b-or-c-one-sample-test-of-proportions-in-three-categories" class="nav-link" data-scroll-target="#how-many-prefer-website-a-b-or-c-one-sample-test-of-proportions-in-three-categories"><span class="header-section-number">13.1.2</span> How many prefer website A, B, or C? (One sample test of proportions in three categories)</a></li>
  <li><a href="#how-many-males-vs-females-prefer-website-a-over-b-two-sample-tests-of-proportions-in-two-categories" id="toc-how-many-males-vs-females-prefer-website-a-over-b-two-sample-tests-of-proportions-in-two-categories" class="nav-link" data-scroll-target="#how-many-males-vs-females-prefer-website-a-over-b-two-sample-tests-of-proportions-in-two-categories"><span class="header-section-number">13.1.3</span> How many males vs females prefer website A over B? (Two-sample tests of proportions in two categories)</a></li>
  <li><a href="#what-if-the-data-are-lopsided-g-test-alternative-to-chi-square" id="toc-what-if-the-data-are-lopsided-g-test-alternative-to-chi-square" class="nav-link" data-scroll-target="#what-if-the-data-are-lopsided-g-test-alternative-to-chi-square"><span class="header-section-number">13.1.4</span> What if the data are lopsided? (G-test, alternative to chi-square)</a></li>
  <li><a href="#how-many-males-vs-females-prefer-website-a-b-or-c-two-sample-tests-of-proportions-in-three-categories" id="toc-how-many-males-vs-females-prefer-website-a-b-or-c-two-sample-tests-of-proportions-in-three-categories" class="nav-link" data-scroll-target="#how-many-males-vs-females-prefer-website-a-b-or-c-two-sample-tests-of-proportions-in-three-categories"><span class="header-section-number">13.1.5</span> How many males vs females prefer website A, B, or C? (Two-sample tests of proportions in three categories)</a></li>
  </ul></li>
  <li><a href="#how-do-groups-compare-in-reading-performance-independent-samples-t-test" id="toc-how-do-groups-compare-in-reading-performance-independent-samples-t-test" class="nav-link" data-scroll-target="#how-do-groups-compare-in-reading-performance-independent-samples-t-test"><span class="header-section-number">13.2</span> How do groups compare in reading performance? (Independent samples <span class="math inline">\(t\)</span>-test)</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">13.3</span> ANOVA</a>
  <ul class="collapse">
  <li><a href="#how-long-does-it-take-to-perform-tasks-on-two-ides" id="toc-how-long-does-it-take-to-perform-tasks-on-two-ides" class="nav-link" data-scroll-target="#how-long-does-it-take-to-perform-tasks-on-two-ides"><span class="header-section-number">13.3.1</span> How long does it take to perform tasks on two IDEs?</a></li>
  <li><a href="#testing-anova-assumptions" id="toc-testing-anova-assumptions" class="nav-link" data-scroll-target="#testing-anova-assumptions"><span class="header-section-number">13.3.2</span> Testing ANOVA assumptions</a></li>
  <li><a href="#kolmogorov-smirnov-test-for-log-normality" id="toc-kolmogorov-smirnov-test-for-log-normality" class="nav-link" data-scroll-target="#kolmogorov-smirnov-test-for-log-normality"><span class="header-section-number">13.3.3</span> Kolmogorov-Smirnov test for log-normality</a></li>
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation"><span class="header-section-number">13.3.4</span> Data transformation</a></li>
  <li><a href="#what-if-anova-assumptions-dont-hold-nonparametric-equivalent-of-independent-samples-t-test" id="toc-what-if-anova-assumptions-dont-hold-nonparametric-equivalent-of-independent-samples-t-test" class="nav-link" data-scroll-target="#what-if-anova-assumptions-dont-hold-nonparametric-equivalent-of-independent-samples-t-test"><span class="header-section-number">13.3.5</span> What if ANOVA assumptions don’t hold? (Nonparametric equivalent of independent-samples t-test)</a></li>
  <li><a href="#mann-whitney-u-test" id="toc-mann-whitney-u-test" class="nav-link" data-scroll-target="#mann-whitney-u-test"><span class="header-section-number">13.3.6</span> Mann-Whitney U test</a></li>
  <li><a href="#how-long-does-it-take-to-do-tasks-on-one-of-three-tools-one-way-anova-preparation" id="toc-how-long-does-it-take-to-do-tasks-on-one-of-three-tools-one-way-anova-preparation" class="nav-link" data-scroll-target="#how-long-does-it-take-to-do-tasks-on-one-of-three-tools-one-way-anova-preparation"><span class="header-section-number">13.3.7</span> How long does it take to do tasks on one of three tools? (One-way ANOVA preparation)</a></li>
  <li><a href="#can-we-transform-data-so-it-fits-assumptions-one-way-anova-suitable-now-to-logtime" id="toc-can-we-transform-data-so-it-fits-assumptions-one-way-anova-suitable-now-to-logtime" class="nav-link" data-scroll-target="#can-we-transform-data-so-it-fits-assumptions-one-way-anova-suitable-now-to-logtime"><span class="header-section-number">13.3.8</span> Can we transform data so it fits assumptions? (One-way ANOVA, suitable now to logTime)</a></li>
  <li><a href="#what-if-we-cant-transform-data-to-fit-anova-assumptions-nonparametric-equivalent-of-one-way-anova" id="toc-what-if-we-cant-transform-data-to-fit-anova-assumptions-nonparametric-equivalent-of-one-way-anova" class="nav-link" data-scroll-target="#what-if-we-cant-transform-data-to-fit-anova-assumptions-nonparametric-equivalent-of-one-way-anova"><span class="header-section-number">13.3.9</span> What if we can’t transform data to fit ANOVA assumptions? (Nonparametric equivalent of one-way ANOVA)</a></li>
  <li><a href="#another-example-of-tasks-using-two-tools-more-on-oneway-anova" id="toc-another-example-of-tasks-using-two-tools-more-on-oneway-anova" class="nav-link" data-scroll-target="#another-example-of-tasks-using-two-tools-more-on-oneway-anova"><span class="header-section-number">13.3.10</span> Another example of tasks using two tools (More on oneway ANOVA)</a></li>
  <li><a href="#differences-in-writing-speed-among-three-tools-three-levels-of-a-factor-in-anova" id="toc-differences-in-writing-speed-among-three-tools-three-levels-of-a-factor-in-anova" class="nav-link" data-scroll-target="#differences-in-writing-speed-among-three-tools-three-levels-of-a-factor-in-anova"><span class="header-section-number">13.3.11</span> Differences in writing speed among three tools (Three levels of a factor in ANOVA)</a></li>
  </ul></li>
  <li><a href="#same-person-using-two-different-tools-paired-samples-t-test" id="toc-same-person-using-two-different-tools-paired-samples-t-test" class="nav-link" data-scroll-target="#same-person-using-two-different-tools-paired-samples-t-test"><span class="header-section-number">13.4</span> Same person using two different tools (Paired samples <span class="math inline">\(t\)</span>-test)</a>
  <ul class="collapse">
  <li><a href="#running-the-paired-t-test" id="toc-running-the-paired-t-test" class="nav-link" data-scroll-target="#running-the-paired-t-test"><span class="header-section-number">13.4.1</span> Running the paired <span class="math inline">\(t\)</span>-test</a></li>
  <li><a href="#exploring-a-poisson-distributed-factor" id="toc-exploring-a-poisson-distributed-factor" class="nav-link" data-scroll-target="#exploring-a-poisson-distributed-factor"><span class="header-section-number">13.4.2</span> Exploring a Poisson-distributed factor</a></li>
  <li><a href="#examining-a-likert-scale-response-item" id="toc-examining-a-likert-scale-response-item" class="nav-link" data-scroll-target="#examining-a-likert-scale-response-item"><span class="header-section-number">13.4.3</span> Examining a Likert scale response item</a></li>
  </ul></li>
  <li><a href="#people-doing-tasks-on-different-phones-in-different-postures-factorial-anova" id="toc-people-doing-tasks-on-different-phones-in-different-postures-factorial-anova" class="nav-link" data-scroll-target="#people-doing-tasks-on-different-phones-in-different-postures-factorial-anova"><span class="header-section-number">13.5</span> People doing tasks on different phones in different postures (Factorial ANOVA)</a>
  <ul class="collapse">
  <li><a href="#read-and-describe-the-data" id="toc-read-and-describe-the-data" class="nav-link" data-scroll-target="#read-and-describe-the-data"><span class="header-section-number">13.5.1</span> Read and describe the data</a></li>
  <li><a href="#explore-the-wpm-words-per-minute-data" id="toc-explore-the-wpm-words-per-minute-data" class="nav-link" data-scroll-target="#explore-the-wpm-words-per-minute-data"><span class="header-section-number">13.5.2</span> Explore the WPM (words per minute) data</a></li>
  <li><a href="#histograms-for-both-factors" id="toc-histograms-for-both-factors" class="nav-link" data-scroll-target="#histograms-for-both-factors"><span class="header-section-number">13.5.3</span> Histograms for both factors</a></li>
  <li><a href="#boxplot-of-both-factors" id="toc-boxplot-of-both-factors" class="nav-link" data-scroll-target="#boxplot-of-both-factors"><span class="header-section-number">13.5.4</span> Boxplot of both factors</a></li>
  <li><a href="#an-interaction-plot" id="toc-an-interaction-plot" class="nav-link" data-scroll-target="#an-interaction-plot"><span class="header-section-number">13.5.5</span> An interaction plot</a></li>
  <li><a href="#test-for-a-posture-order-effect" id="toc-test-for-a-posture-order-effect" class="nav-link" data-scroll-target="#test-for-a-posture-order-effect"><span class="header-section-number">13.5.6</span> Test for a Posture order effect</a></li>
  </ul></li>
  <li><a href="#differences-between-peoples-performance-and-within-a-persons-performance-two-way-mixed-factorial-anova" id="toc-differences-between-peoples-performance-and-within-a-persons-performance-two-way-mixed-factorial-anova" class="nav-link" data-scroll-target="#differences-between-peoples-performance-and-within-a-persons-performance-two-way-mixed-factorial-anova"><span class="header-section-number">13.6</span> Differences between people’s performance and within a person’s performance (Two-way mixed factorial ANOVA)</a></li>
  <li><a href="#anova-results-from-aov" id="toc-anova-results-from-aov" class="nav-link" data-scroll-target="#anova-results-from-aov"><span class="header-section-number">13.7</span> ANOVA results from <code>aov()</code></a>
  <ul class="collapse">
  <li><a href="#manual-post-hoc-pairwise-comparisons" id="toc-manual-post-hoc-pairwise-comparisons" class="nav-link" data-scroll-target="#manual-post-hoc-pairwise-comparisons"><span class="header-section-number">13.7.1</span> Manual post hoc pairwise comparisons</a></li>
  <li><a href="#compare-iphone-sit-and-walk" id="toc-compare-iphone-sit-and-walk" class="nav-link" data-scroll-target="#compare-iphone-sit-and-walk"><span class="header-section-number">13.7.2</span> Compare iPhone ‘sit’ and ‘walk’</a></li>
  </ul></li>
  <li><a href="#what-if-anova-assumptions-arent-met-nonparametric-approach-to-factorial-anova" id="toc-what-if-anova-assumptions-arent-met-nonparametric-approach-to-factorial-anova" class="nav-link" data-scroll-target="#what-if-anova-assumptions-arent-met-nonparametric-approach-to-factorial-anova"><span class="header-section-number">13.8</span> What if ANOVA assumptions aren’t met? (Nonparametric approach to factorial ANOVA)</a>
  <ul class="collapse">
  <li><a href="#the-aligned-rank-transform-art-procedure" id="toc-the-aligned-rank-transform-art-procedure" class="nav-link" data-scroll-target="#the-aligned-rank-transform-art-procedure"><span class="header-section-number">13.8.1</span> The Aligned Rank Transform (ART) procedure</a></li>
  <li><a href="#explore-the-error_rate-data" id="toc-explore-the-error_rate-data" class="nav-link" data-scroll-target="#explore-the-error_rate-data"><span class="header-section-number">13.8.2</span> Explore the Error_Rate data</a></li>
  <li><a href="#histograms-of-error_rate" id="toc-histograms-of-error_rate" class="nav-link" data-scroll-target="#histograms-of-error_rate"><span class="header-section-number">13.8.3</span> Histograms of Error_Rate</a></li>
  <li><a href="#box-plots-of-error_rate" id="toc-box-plots-of-error_rate" class="nav-link" data-scroll-target="#box-plots-of-error_rate"><span class="header-section-number">13.8.4</span> Box plots of Error_Rate</a></li>
  <li><a href="#interaction-plot-of-error_rate" id="toc-interaction-plot-of-error_rate" class="nav-link" data-scroll-target="#interaction-plot-of-error_rate"><span class="header-section-number">13.8.5</span> Interaction plot of Error_Rate</a></li>
  <li><a href="#aligned-rank-transform-on-error_rate" id="toc-aligned-rank-transform-on-error_rate" class="nav-link" data-scroll-target="#aligned-rank-transform-on-error_rate"><span class="header-section-number">13.8.6</span> Aligned Rank Transform on Error_Rate</a></li>
  <li><a href="#examine-the-normality-assumption" id="toc-examine-the-normality-assumption" class="nav-link" data-scroll-target="#examine-the-normality-assumption"><span class="header-section-number">13.8.7</span> Examine the normality assumption</a></li>
  <li><a href="#interaction-plot" id="toc-interaction-plot" class="nav-link" data-scroll-target="#interaction-plot"><span class="header-section-number">13.8.8</span> Interaction plot</a></li>
  <li><a href="#conduct-post-hoc-pairwise-comparisons-within-each-factor" id="toc-conduct-post-hoc-pairwise-comparisons-within-each-factor" class="nav-link" data-scroll-target="#conduct-post-hoc-pairwise-comparisons-within-each-factor"><span class="header-section-number">13.8.9</span> Conduct post hoc pairwise comparisons within each factor</a></li>
  </ul></li>
  <li><a href="#experiments-with-interaction-effects" id="toc-experiments-with-interaction-effects" class="nav-link" data-scroll-target="#experiments-with-interaction-effects"><span class="header-section-number">13.9</span> Experiments with interaction effects</a>
  <ul class="collapse">
  <li><a href="#sentiments-about-avatars-among-males-and-females-interaction-effects" id="toc-sentiments-about-avatars-among-males-and-females-interaction-effects" class="nav-link" data-scroll-target="#sentiments-about-avatars-among-males-and-females-interaction-effects"><span class="header-section-number">13.9.1</span> Sentiments about Avatars among males and females (Interaction effects)</a></li>
  <li><a href="#writing-notes-with-builtin-or-addon-apps-on-two-phones-mixed-factorial-design" id="toc-writing-notes-with-builtin-or-addon-apps-on-two-phones-mixed-factorial-design" class="nav-link" data-scroll-target="#writing-notes-with-builtin-or-addon-apps-on-two-phones-mixed-factorial-design"><span class="header-section-number">13.9.2</span> Writing notes with builtin or addon apps on two phones (mixed factorial design)</a></li>
  <li><a href="#social-media-value-judged-by-people-after-watching-clips-two-by-two-within-subject-design" id="toc-social-media-value-judged-by-people-after-watching-clips-two-by-two-within-subject-design" class="nav-link" data-scroll-target="#social-media-value-judged-by-people-after-watching-clips-two-by-two-within-subject-design"><span class="header-section-number">13.9.3</span> Social media value judged by people after watching clips (two-by-two within subject design)</a></li>
  </ul></li>
  <li><a href="#what-if-errors-are-not-normally-distributed-generalized-linear-models" id="toc-what-if-errors-are-not-normally-distributed-generalized-linear-models" class="nav-link" data-scroll-target="#what-if-errors-are-not-normally-distributed-generalized-linear-models"><span class="header-section-number">13.10</span> What if errors are not normally distributed? (Generalized linear models)</a>
  <ul class="collapse">
  <li><a href="#preferences-among-websites-by-males-and-females-glm-1-nominal-logistic-regression-for-preference-responses" id="toc-preferences-among-websites-by-males-and-females-glm-1-nominal-logistic-regression-for-preference-responses" class="nav-link" data-scroll-target="#preferences-among-websites-by-males-and-females-glm-1-nominal-logistic-regression-for-preference-responses"><span class="header-section-number">13.10.1</span> Preferences among websites by males and females (GLM 1: Nominal logistic regression for preference responses)</a></li>
  <li><a href="#multinomial-distribution-with-logit-link-function" id="toc-multinomial-distribution-with-logit-link-function" class="nav-link" data-scroll-target="#multinomial-distribution-with-logit-link-function"><span class="header-section-number">13.10.2</span> Multinomial distribution with logit link function</a></li>
  <li><a href="#judgments-of-perceived-effort-glm-2-ordinal-logistic-regression-for-likert-responses" id="toc-judgments-of-perceived-effort-glm-2-ordinal-logistic-regression-for-likert-responses" class="nav-link" data-scroll-target="#judgments-of-perceived-effort-glm-2-ordinal-logistic-regression-for-likert-responses"><span class="header-section-number">13.10.3</span> Judgments of perceived effort (GLM 2: Ordinal logistic regression for Likert responses)</a></li>
  <li><a href="#multinomial-distribution-with-cumulative-logit-link-function" id="toc-multinomial-distribution-with-cumulative-logit-link-function" class="nav-link" data-scroll-target="#multinomial-distribution-with-cumulative-logit-link-function"><span class="header-section-number">13.10.4</span> Multinomial distribution with cumulative logit link function</a></li>
  <li><a href="#counting-errors-in-a-task-glm-3-poisson-regression-for-count-responses" id="toc-counting-errors-in-a-task-glm-3-poisson-regression-for-count-responses" class="nav-link" data-scroll-target="#counting-errors-in-a-task-glm-3-poisson-regression-for-count-responses"><span class="header-section-number">13.10.5</span> Counting errors in a task (GLM 3: Poisson regression for count responses)</a></li>
  <li><a href="#poisson-distribution-with-log-link-function" id="toc-poisson-distribution-with-log-link-function" class="nav-link" data-scroll-target="#poisson-distribution-with-log-link-function"><span class="header-section-number">13.10.6</span> Poisson distribution with log link function</a></li>
  </ul></li>
  <li><a href="#more-experiments-without-normally-distributed-errors-more-generalized-linear-models" id="toc-more-experiments-without-normally-distributed-errors-more-generalized-linear-models" class="nav-link" data-scroll-target="#more-experiments-without-normally-distributed-errors-more-generalized-linear-models"><span class="header-section-number">13.11</span> More experiments without normally distributed errors (More generalized linear models)</a>
  <ul class="collapse">
  <li><a href="#preference-between-touchpads-vs-trackballs-by-non-disabled-people-and-males-females" id="toc-preference-between-touchpads-vs-trackballs-by-non-disabled-people-and-males-females" class="nav-link" data-scroll-target="#preference-between-touchpads-vs-trackballs-by-non-disabled-people-and-males-females"><span class="header-section-number">13.11.1</span> Preference between touchpads vs trackballs by non / disabled people and males / females</a></li>
  <li><a href="#handwriting-recognition-speed-between-different-tools-and-right-handed-vs-left-handed-people" id="toc-handwriting-recognition-speed-between-different-tools-and-right-handed-vs-left-handed-people" class="nav-link" data-scroll-target="#handwriting-recognition-speed-between-different-tools-and-right-handed-vs-left-handed-people"><span class="header-section-number">13.11.2</span> Handwriting recognition speed between different tools and right-handed vs left-handed people</a></li>
  <li><a href="#ease-of-booking-international-or-domestic-flights-on-three-different-services" id="toc-ease-of-booking-international-or-domestic-flights-on-three-different-services" class="nav-link" data-scroll-target="#ease-of-booking-international-or-domestic-flights-on-three-different-services"><span class="header-section-number">13.11.3</span> Ease of booking international or domestic flights on three different services</a></li>
  </ul></li>
  <li><a href="#same-person-using-different-tools-within-subjects-studies" id="toc-same-person-using-different-tools-within-subjects-studies" class="nav-link" data-scroll-target="#same-person-using-different-tools-within-subjects-studies"><span class="header-section-number">13.12</span> Same person using different tools (Within subjects studies)</a>
  <ul class="collapse">
  <li><a href="#two-search-engines-compared" id="toc-two-search-engines-compared" class="nav-link" data-scroll-target="#two-search-engines-compared"><span class="header-section-number">13.12.1</span> Two search engines compared</a></li>
  <li><a href="#same-but-with-three-search-engines" id="toc-same-but-with-three-search-engines" class="nav-link" data-scroll-target="#same-but-with-three-search-engines"><span class="header-section-number">13.12.2</span> Same but with three search engines</a></li>
  </ul></li>
  <li><a href="#experiments-with-people-in-groups-doing-tasks-with-different-tools-mixed-models" id="toc-experiments-with-people-in-groups-doing-tasks-with-different-tools-mixed-models" class="nav-link" data-scroll-target="#experiments-with-people-in-groups-doing-tasks-with-different-tools-mixed-models"><span class="header-section-number">13.13</span> Experiments with people in groups doing tasks with different tools (Mixed models)</a>
  <ul class="collapse">
  <li><a href="#searching-to-find-facts-and-effort-of-searching-a-linear-mixed-model" id="toc-searching-to-find-facts-and-effort-of-searching-a-linear-mixed-model" class="nav-link" data-scroll-target="#searching-to-find-facts-and-effort-of-searching-a-linear-mixed-model"><span class="header-section-number">13.13.1</span> Searching to find facts and effort of searching (A linear mixed model)</a></li>
  <li><a href="#people-judging-social-media-posts-after-viewing-clips-another-linear-mixed-model" id="toc-people-judging-social-media-posts-after-viewing-clips-another-linear-mixed-model" class="nav-link" data-scroll-target="#people-judging-social-media-posts-after-viewing-clips-another-linear-mixed-model"><span class="header-section-number">13.13.2</span> People judging social media posts after viewing clips (Another linear mixed model)</a></li>
  <li><a href="#people-watching-teasers-in-different-orders-and-judging-yet-another-linear-mixed-model" id="toc-people-watching-teasers-in-different-orders-and-judging-yet-another-linear-mixed-model" class="nav-link" data-scroll-target="#people-watching-teasers-in-different-orders-and-judging-yet-another-linear-mixed-model"><span class="header-section-number">13.13.3</span> People watching teasers in different orders and judging (Yet another linear mixed model)</a></li>
  <li><a href="#finding-number-of-unique-words-used-in-posts-by-males-and-females-a-generalized-linear-mixed-model" id="toc-finding-number-of-unique-words-used-in-posts-by-males-and-females-a-generalized-linear-mixed-model" class="nav-link" data-scroll-target="#finding-number-of-unique-words-used-in-posts-by-males-and-females-a-generalized-linear-mixed-model"><span class="header-section-number">13.13.4</span> Finding number of unique words used in posts by males and females (A generalized linear mixed model)</a></li>
  <li><a href="#judging-search-effort-among-different-search-engines-another-generalized-linear-mixed-model" id="toc-judging-search-effort-among-different-search-engines-another-generalized-linear-mixed-model" class="nav-link" data-scroll-target="#judging-search-effort-among-different-search-engines-another-generalized-linear-mixed-model"><span class="header-section-number">13.13.5</span> Judging search effort among different search engines (Another generalized linear mixed model)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Human Computer Interaction Experiments</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Following are my course notes from a 2018 Coursera course called <em>Designing, Running, and Analyzing Experiments</em>, taught by Jacob Wobbrock, a prominent HCI scholar. Note that Wobbrock is in no way responsible for any errors or deviations from his presentation.</p>
<p>These course notes are an example of <em>reproducible research</em> and <em>literate programming</em>. They are reproducible research because the same file that generated this html document also ran all the experiments. This is an example of literate programming in the sense that the code, pictures, equations, and narrative are all encapsulated in one file. The source file for this project, along with the data files, are enough for you to reproduce the results and reproduce the documentation. All the source material is available in my github account, although in an obscure location therein.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">readr.show_col_types=</span><span class="cn">FALSE</span>) <span class="co"># supress column type messages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="how-many-prefer-this-over-that-tests-of-proportions" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="how-many-prefer-this-over-that-tests-of-proportions"><span class="header-section-number">13.1</span> How many prefer this over that? (Tests of proportions)</h2>
<section id="how-many-prefer-website-a-over-b-one-sample-test-of-proportions-in-two-categories" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="how-many-prefer-website-a-over-b-one-sample-test-of-proportions-in-two-categories"><span class="header-section-number">13.1.1</span> How many prefer website A over B? (One sample test of proportions in two categories)</h3>
<p>Sixty subjects were asked whether they preferred website A or B. Their answer and a subject ID were recorded. Read the data and describe it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>prefsAB <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/prefsAB.csv"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(prefsAB) <span class="co"># displays the last few rows of the data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Subject Pref 
    &lt;dbl&gt; &lt;chr&gt;
1      55 A    
2      56 B    
3      57 A    
4      58 B    
5      59 B    
6      60 A    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>prefsAB<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsAB<span class="sc">$</span>Subject) <span class="co"># convert to nominal factor</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>prefsAB<span class="sc">$</span>Pref <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsAB<span class="sc">$</span>Pref) <span class="co"># convert to nominal factor</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(prefsAB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject   Pref  
 1      : 1   A:14  
 2      : 1   B:46  
 3      : 1         
 4      : 1         
 5      : 1         
 6      : 1         
 (Other):54         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prefsAB,<span class="fu">aes</span>(Pref)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">fill=</span><span class="st">"lightskyblue1"</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Is the difference between preferences significant? A default <span class="math inline">\(\chi^2\)</span> test examines the proportions in two bins, expecting them to be equally apportioned.</p>
<p>To do the <span class="math inline">\(\chi^2\)</span> test, first crosstabulate the data with <code>xtabs()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Pearson chi-square test</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>prfs <span class="ot">&lt;-</span> <span class="fu">xtabs</span>( <span class="sc">~</span> Pref, <span class="at">data=</span>prefsAB)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>prfs <span class="co"># show counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pref
 A  B 
14 46 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  prfs
X-squared = 17.067, df = 1, p-value = 3.609e-05</code></pre>
</div>
</div>
<p>We don’t really need an exact binomial test yet because the <span class="math inline">\(\chi^2\)</span> test told us enough: that the difference is not likely due to chance. That was only because there are only two choices. If there were more than two, we’d need a binomial test for every pair if the <span class="math inline">\(\chi^2\)</span> test turned up a significant difference. This binomial test just foreshadows what we’ll need when we face three categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. binomial test</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. binom.test(prfs,split.table=Inf)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  prfs
number of successes = 14, number of trials = 60, p-value = 4.224e-05
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.1338373 0.3603828
sample estimates:
probability of success 
             0.2333333 </code></pre>
</div>
</div>
</section>
<section id="how-many-prefer-website-a-b-or-c-one-sample-test-of-proportions-in-three-categories" class="level3" data-number="13.1.2">
<h3 data-number="13.1.2" class="anchored" data-anchor-id="how-many-prefer-website-a-b-or-c-one-sample-test-of-proportions-in-three-categories"><span class="header-section-number">13.1.2</span> How many prefer website A, B, or C? (One sample test of proportions in three categories)</h3>
<p>First, read in and describe the data. Convert Subject to a factor because R reads any numerical data as, well, numeric, but we don’t want to treat it as such. R interprets any data with characters as a factor. We want Subject to be treated as a factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>prefsABC <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/prefsABC.csv"</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prefsABC) <span class="co"># displays the first few rows of the data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Subject Pref 
    &lt;dbl&gt; &lt;chr&gt;
1       1 C    
2       2 C    
3       3 B    
4       4 C    
5       5 C    
6       6 B    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>prefsABC<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABC<span class="sc">$</span>Subject)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>prefsABC<span class="sc">$</span>Pref <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABC<span class="sc">$</span>Pref)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(prefsABC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject   Pref  
 1      : 1   A: 8  
 2      : 1   B:21  
 3      : 1   C:31  
 4      : 1         
 5      : 1         
 6      : 1         
 (Other):54         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prefsABC,<span class="fu">aes</span>(Pref))<span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">fill=</span><span class="st">"lightskyblue1"</span>)<span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can think of the three websites as representing three bins and the preferences as filling up those bins. Either each bin gets one third of the preferences or there is a discrepancy. The Pearson <span class="math inline">\(\chi^2\)</span> test functions as an omnibus test to tell whether there is any discrepancy in the proportions of the three bins.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>prfs <span class="ot">&lt;-</span> <span class="fu">xtabs</span>( <span class="sc">~</span> Pref, <span class="at">data=</span>prefsABC)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>prfs <span class="co"># show counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pref
 A  B  C 
 8 21 31 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  prfs
X-squared = 13.3, df = 2, p-value = 0.001294</code></pre>
</div>
</div>
<p>A multinomial test can test for other than an even distribution across bins. Here’s an example with a one third distribution in each bin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(XNomial)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xmulti</span>(prfs, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>), <span class="at">statName=</span><span class="st">"Prob"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
P value (Prob) = 0.0008024</code></pre>
</div>
</div>
<p>Now we don’t know which pair(s) differed so it makes sense to conduct post hoc binomial tests with correction for multiple comparisons. The correction, made by <code>p.adjust()</code>, is because the more hypotheses we check, the higher the probability of a Type I error, a false positive. That is, the more hypotheses we test, the higher the probability that one will appear true by chance. Wikipedia has more detail in its “Multiple Comparisons Problem” article.</p>
<p>Here, we test separately for whether each one has a third of the preferences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABC<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABC), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABC<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABC), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABC<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"C"</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABC), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(aa<span class="sc">$</span>p.value, bb<span class="sc">$</span>p.value, cc<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001659954 0.785201685 0.007446980</code></pre>
</div>
</div>
<p>The adjusted <span class="math inline">\(p\)</span>-values tell us that A and C differ significantly from a third of the preferences.</p>
</section>
<section id="how-many-males-vs-females-prefer-website-a-over-b-two-sample-tests-of-proportions-in-two-categories" class="level3" data-number="13.1.3">
<h3 data-number="13.1.3" class="anchored" data-anchor-id="how-many-males-vs-females-prefer-website-a-over-b-two-sample-tests-of-proportions-in-two-categories"><span class="header-section-number">13.1.3</span> How many males vs females prefer website A over B? (Two-sample tests of proportions in two categories)</h3>
<p>Revisit our data file with 2 response categories, but now with sex (M/F).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>prefsABsex <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/prefsABsex.csv"</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(prefsABsex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Subject Pref  Sex  
    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1      55 A     M    
2      56 B     F    
3      57 A     M    
4      58 B     M    
5      59 B     M    
6      60 A     M    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>prefsABsex<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABsex<span class="sc">$</span>Subject)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>prefsABsex<span class="sc">$</span>Pref <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABsex<span class="sc">$</span>Pref)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>prefsABsex<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABsex<span class="sc">$</span>Sex)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(prefsABsex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject   Pref   Sex   
 1      : 1   A:14   F:31  
 2      : 1   B:46   M:29  
 3      : 1                
 4      : 1                
 5      : 1                
 6      : 1                
 (Other):54                </code></pre>
</div>
</div>
<p>Plotting is slightly more complicated by the fact that we want to represent two groups. There are many ways to do this, including stacked bar charts, side-by-side bars, or the method chosen here, using <code>facet_wrap(~Sex)</code> to cause two separate plots based on Sex to be created.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prefsABsex,<span class="fu">aes</span>(Pref)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">fill=</span><span class="st">"lightskyblue1"</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although we can guess by looking at the above plot that the difference for females is significant and the difference for males is not, a Pearson chi-square test provides some statistical evidence for this hunch.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>prfs <span class="ot">&lt;-</span> <span class="fu">xtabs</span>( <span class="sc">~</span> Pref <span class="sc">+</span> Sex, <span class="at">data=</span>prefsABsex) <span class="co"># the '+' sign indicates two vars</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>prfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sex
Pref  F  M
   A  2 12
   B 29 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  prfs
X-squared = 8.3588, df = 1, p-value = 0.003838</code></pre>
</div>
</div>
</section>
<section id="what-if-the-data-are-lopsided-g-test-alternative-to-chi-square" class="level3" data-number="13.1.4">
<h3 data-number="13.1.4" class="anchored" data-anchor-id="what-if-the-data-are-lopsided-g-test-alternative-to-chi-square"><span class="header-section-number">13.1.4</span> What if the data are lopsided? (G-test, alternative to chi-square)</h3>
<p>Wikipedia tells us that the <span class="math inline">\(G\)</span>-test dominates the <span class="math inline">\(\chi^2\)</span> test when <span class="math inline">\(O_i&gt;2E_i\)</span> in the formula</p>
<p><span class="math display">\[\chi^2=\sum_i \frac{(O_i-E_i)^2}{E_i}\]</span></p>
<p>where <span class="math inline">\(O_i\)</span> is the observed and <span class="math inline">\(E_i\)</span> is the expected proportion in the <span class="math inline">\(i\)</span>th bin. This situation may occur in small sample sizes. For large sample sizes, both tests give the same conclusion. In our case, we’re on the borderline for this rule in the bin where 29 females prefer B. All females would have to prefer B for the rule to dictate a switch to the <span class="math inline">\(G\)</span>-test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RVAideMemoire)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>*** Package RVAideMemoire v 0.9-83-3 ***</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">G.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    G-test

data:  prfs
G = 11.025, df = 1, p-value = 0.0008989</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Fisher's exact test</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  prfs
p-value = 0.001877
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.009898352 0.537050159
sample estimates:
odds ratio 
 0.1015763 </code></pre>
</div>
</div>
</section>
<section id="how-many-males-vs-females-prefer-website-a-b-or-c-two-sample-tests-of-proportions-in-three-categories" class="level3" data-number="13.1.5">
<h3 data-number="13.1.5" class="anchored" data-anchor-id="how-many-males-vs-females-prefer-website-a-b-or-c-two-sample-tests-of-proportions-in-three-categories"><span class="header-section-number">13.1.5</span> How many males vs females prefer website A, B, or C? (Two-sample tests of proportions in three categories)</h3>
<p>Revisit our data file with 3 response categories, but now with sex (M/F).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>prefsABCsex <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/prefsABCsex.csv"</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prefsABCsex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Subject Pref  Sex  
    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1       1 C     F    
2       2 C     M    
3       3 B     M    
4       4 C     M    
5       5 C     M    
6       6 B     F    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>prefsABCsex<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABCsex<span class="sc">$</span>Subject)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>prefsABCsex<span class="sc">$</span>Pref <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABCsex<span class="sc">$</span>Pref)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>prefsABCsex<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(prefsABCsex<span class="sc">$</span>Sex)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(prefsABCsex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject   Pref   Sex   
 1      : 1   A: 8   F:29  
 2      : 1   B:21   M:31  
 3      : 1   C:31         
 4      : 1                
 5      : 1                
 6      : 1                
 (Other):54                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prefsABCsex,<span class="fu">aes</span>(Pref)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.4</span>,<span class="at">fill=</span><span class="st">"lightskyblue1"</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Sex) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Pearson chi-square test</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>prfs <span class="ot">&lt;-</span> <span class="fu">xtabs</span>( <span class="sc">~</span> Pref <span class="sc">+</span> Sex, <span class="at">data=</span>prefsABCsex)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>prfs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sex
Pref  F  M
   A  3  5
   B 15  6
   C 11 20</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(prfs): Chi-squared approximation may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  prfs
X-squared = 6.9111, df = 2, p-value = 0.03157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. G-test</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">G.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    G-test

data:  prfs
G = 7.0744, df = 2, p-value = 0.02909</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Fisher's exact test</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(prfs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  prfs
p-value = 0.03261
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Now conduct manual post hoc binomial tests for (m)ales—do any prefs for A–C significantly differ from chance for males?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>mb <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"C"</span>),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co">#. correct for multiple comparisons</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(ma<span class="sc">$</span>p.value, mb<span class="sc">$</span>p.value, mc<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.109473564 0.126622172 0.001296754</code></pre>
</div>
</div>
<p>Next, conduct manual post hoc binomial tests for (f)emales—do any prefs for A–C significantly differ from chance for females?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fa <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>fb <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"C"</span>),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">#. correct for multiple comparisons</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(fa<span class="sc">$</span>p.value, fb<span class="sc">$</span>p.value, fc<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02703274 0.09447821 0.69396951</code></pre>
</div>
</div>
</section>
</section>
<section id="how-do-groups-compare-in-reading-performance-independent-samples-t-test" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="how-do-groups-compare-in-reading-performance-independent-samples-t-test"><span class="header-section-number">13.2</span> How do groups compare in reading performance? (Independent samples <span class="math inline">\(t\)</span>-test)</h2>
<p>Here we are asking which group read more pages on a particular website.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>pgviews <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/pgviews.csv"</span>))</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>pgviews<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(pgviews<span class="sc">$</span>Subject)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>pgviews<span class="sc">$</span>Site <span class="ot">&lt;-</span> <span class="fu">factor</span>(pgviews<span class="sc">$</span>Site)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pgviews)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject    Site        Pages       
 1      :  1   A:245   Min.   : 1.000  
 2      :  1   B:255   1st Qu.: 3.000  
 3      :  1           Median : 4.000  
 4      :  1           Mean   : 3.958  
 5      :  1           3rd Qu.: 5.000  
 6      :  1           Max.   :11.000  
 (Other):494                           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(pgviews)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Subject Site  Pages
  &lt;fct&gt;   &lt;fct&gt; &lt;dbl&gt;
1 495     A         3
2 496     B         6
3 497     B         6
4 498     A         3
5 499     A         4
6 500     B         6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. descriptive statistics by Site</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(pgviews, <span class="sc">~</span> Site, <span class="cf">function</span>(data) <span class="fu">summary</span>(data<span class="sc">$</span>Pages))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Site Min. 1st Qu. Median     Mean 3rd Qu. Max.
1    A    1       3      3 3.404082       4    6
2    B    1       3      4 4.490196       6   11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(pgviews, <span class="sc">~</span> Site, summarise, <span class="at">Pages.mean=</span><span class="fu">mean</span>(Pages), <span class="at">Pages.sd=</span><span class="fu">sd</span>(Pages))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Site Pages.mean Pages.sd
1    A   3.404082 1.038197
2    B   4.490196 2.127552</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. graph histograms and a boxplot</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pgviews,<span class="fu">aes</span>(Pages,<span class="at">fill=</span>Site,<span class="at">color=</span>Site)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">position=</span><span class="st">"identity"</span>,<span class="at">color=</span><span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>() <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>() <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pgviews,<span class="fu">aes</span>(Site,Pages,<span class="at">fill=</span>Site)) <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. independent-samples t-test</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Pages <span class="sc">~</span> Site, <span class="at">data=</span>pgviews, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  Pages by Site
t = -7.2083, df = 498, p-value = 2.115e-12
alternative hypothesis: true difference in means between group A and group B is not equal to 0
95 percent confidence interval:
 -1.3821544 -0.7900745
sample estimates:
mean in group A mean in group B 
       3.404082        4.490196 </code></pre>
</div>
</div>
</section>
<section id="anova" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="anova"><span class="header-section-number">13.3</span> ANOVA</h2>
<p>ANOVA stands for analysis of variance and is a way to generalize the <span class="math inline">\(t\)</span>-test to more groups.</p>
<section id="how-long-does-it-take-to-perform-tasks-on-two-ides" class="level3" data-number="13.3.1">
<h3 data-number="13.3.1" class="anchored" data-anchor-id="how-long-does-it-take-to-perform-tasks-on-two-ides"><span class="header-section-number">13.3.1</span> How long does it take to perform tasks on two IDEs?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>ide2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/ide2.csv"</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>ide2<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(ide2<span class="sc">$</span>Subject) <span class="co"># convert to nominal factor</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>ide2<span class="sc">$</span>IDE <span class="ot">&lt;-</span> <span class="fu">factor</span>(ide2<span class="sc">$</span>IDE) <span class="co"># convert to nominal factor</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ide2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject        IDE          Time      
 1      : 1   Eclipse:20   Min.   :155.0  
 2      : 1   VStudio:20   1st Qu.:271.8  
 3      : 1                Median :313.5  
 4      : 1                Mean   :385.1  
 5      : 1                3rd Qu.:422.0  
 6      : 1                Max.   :952.0  
 (Other):34                               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. view descriptive statistics by IDE</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(ide2, <span class="sc">~</span> IDE, <span class="cf">function</span>(data) <span class="fu">summary</span>(data<span class="sc">$</span>Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      IDE Min. 1st Qu. Median   Mean 3rd Qu. Max.
1 Eclipse  232  294.75  393.5 468.15  585.50  952
2 VStudio  155  246.50  287.0 302.10  335.25  632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(ide2, <span class="sc">~</span> IDE, summarise, <span class="at">Time.mean=</span><span class="fu">mean</span>(Time), <span class="at">Time.sd=</span><span class="fu">sd</span>(Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      IDE Time.mean  Time.sd
1 Eclipse    468.15 218.1241
2 VStudio    302.10 101.0778</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. graph histograms and a boxplot</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ide2,<span class="fu">aes</span>(Time,<span class="at">fill=</span>IDE)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">50</span>,<span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ide2,<span class="fu">aes</span>(IDE,Time,<span class="at">fill=</span>IDE)) <span class="sc">+</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. independent-samples t-test (suitable? maybe not, because...)</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  Time by IDE
t = 3.0889, df = 38, p-value = 0.003745
alternative hypothesis: true difference in means between group Eclipse and group VStudio is not equal to 0
95 percent confidence interval:
  57.226 274.874
sample estimates:
mean in group Eclipse mean in group VStudio 
               468.15                302.10 </code></pre>
</div>
</div>
</section>
<section id="testing-anova-assumptions" class="level3" data-number="13.3.2">
<h3 data-number="13.3.2" class="anchored" data-anchor-id="testing-anova-assumptions"><span class="header-section-number">13.3.2</span> Testing ANOVA assumptions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Shapiro-Wilk normality test on response</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"VStudio"</span>,]<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ide2[ide2$IDE == "VStudio", ]$Time
W = 0.84372, p-value = 0.004191</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"Eclipse"</span>,]<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ide2[ide2$IDE == "Eclipse", ]$Time
W = 0.87213, p-value = 0.01281</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. but really what matters most is the residuals</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">aov</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide2) <span class="co"># fit model</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m)) <span class="co"># test residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m)
W = 0.894, p-value = 0.001285</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m)); <span class="fu">qqline</span>(<span class="fu">residuals</span>(m)) <span class="co"># plot residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="kolmogorov-smirnov-test-for-log-normality" class="level3" data-number="13.3.3">
<h3 data-number="13.3.3" class="anchored" data-anchor-id="kolmogorov-smirnov-test-for-log-normality"><span class="header-section-number">13.3.3</span> Kolmogorov-Smirnov test for log-normality</h3>
<p>Fit the distribution to a lognormal to estimate fit parameters then supply those to a K-S test with the lognormal distribution fn (see ?plnorm). See ?distributions for many other named probability distributions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"VStudio"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"lognormal"</span>)<span class="sc">$</span>estimate</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"VStudio"</span>,]<span class="sc">$</span>Time, <span class="st">"plnorm"</span>,</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanlog=</span>fit[<span class="dv">1</span>], <span class="at">sdlog=</span>fit[<span class="dv">2</span>], <span class="at">exact=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  ide2[ide2$IDE == "VStudio", ]$Time
D = 0.13421, p-value = 0.8181
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"Eclipse"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"lognormal"</span>)<span class="sc">$</span>estimate</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"Eclipse"</span>,]<span class="sc">$</span>Time, <span class="st">"plnorm"</span>,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanlog=</span>fit[<span class="dv">1</span>], <span class="at">sdlog=</span>fit[<span class="dv">2</span>], <span class="at">exact=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  ide2[ide2$IDE == "Eclipse", ]$Time
D = 0.12583, p-value = 0.871
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. tests for homoscedasticity (homogeneity of variance)</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">center=</span>mean) <span class="co"># Levene's test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = mean)
      Df F value   Pr(&gt;F)   
group  1  11.959 0.001356 **
      38                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">center=</span>median) <span class="co"># Brown-Forsythe test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)  
group  1  5.9144 0.01984 *
      38                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Welch t-test for unequal variances handles</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. the violation of homoscedasticity. but not</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#. the violation of normality.</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">var.equal=</span><span class="cn">FALSE</span>) <span class="co"># Welch t-test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Time by IDE
t = 3.0889, df = 26.8, p-value = 0.004639
alternative hypothesis: true difference in means between group Eclipse and group VStudio is not equal to 0
95 percent confidence interval:
  55.71265 276.38735
sample estimates:
mean in group Eclipse mean in group VStudio 
               468.15                302.10 </code></pre>
</div>
</div>
</section>
<section id="data-transformation" class="level3" data-number="13.3.4">
<h3 data-number="13.3.4" class="anchored" data-anchor-id="data-transformation"><span class="header-section-number">13.3.4</span> Data transformation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. create a new column in ide2 defined as log(Time)</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>ide2<span class="sc">$</span>logTime <span class="ot">&lt;-</span> <span class="fu">log</span>(ide2<span class="sc">$</span>Time) <span class="co"># log transform</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ide2) <span class="co"># verify</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Subject IDE      Time logTime
  &lt;fct&gt;   &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 1       VStudio   341    5.83
2 2       VStudio   291    5.67
3 3       VStudio   283    5.65
4 4       VStudio   155    5.04
5 5       VStudio   271    5.60
6 6       VStudio   270    5.60</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. explore for intuition-building</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ide2,<span class="fu">aes</span>(logTime,<span class="at">fill=</span>IDE)) <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="fl">0.2</span>,<span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Paired"</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ide2,<span class="fu">aes</span>(IDE,logTime,<span class="at">fill=</span>IDE)) <span class="sc">+</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. re-test for normality</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"VStudio"</span>,]<span class="sc">$</span>logTime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ide2[ide2$IDE == "VStudio", ]$logTime
W = 0.95825, p-value = 0.5094</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ide2[ide2<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"Eclipse"</span>,]<span class="sc">$</span>logTime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ide2[ide2$IDE == "Eclipse", ]$logTime
W = 0.93905, p-value = 0.23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide2) <span class="co"># fit model</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m)) <span class="co"># test residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m)
W = 0.96218, p-value = 0.1987</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m)); <span class="fu">qqline</span>(<span class="fu">residuals</span>(m)) <span class="co"># plot residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. re-test for homoscedasticity</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">center=</span>median) <span class="co"># Brown-Forsythe test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value  Pr(&gt;F)  
group  1  3.2638 0.07875 .
      38                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. independent-samples t-test (now suitable for logTime)</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  logTime by IDE
t = 3.3121, df = 38, p-value = 0.002039
alternative hypothesis: true difference in means between group Eclipse and group VStudio is not equal to 0
95 percent confidence interval:
 0.1514416 0.6276133
sample estimates:
mean in group Eclipse mean in group VStudio 
             6.055645              5.666118 </code></pre>
</div>
</div>
</section>
<section id="what-if-anova-assumptions-dont-hold-nonparametric-equivalent-of-independent-samples-t-test" class="level3" data-number="13.3.5">
<h3 data-number="13.3.5" class="anchored" data-anchor-id="what-if-anova-assumptions-dont-hold-nonparametric-equivalent-of-independent-samples-t-test"><span class="header-section-number">13.3.5</span> What if ANOVA assumptions don’t hold? (Nonparametric equivalent of independent-samples t-test)</h3>
</section>
<section id="mann-whitney-u-test" class="level3" data-number="13.3.6">
<h3 data-number="13.3.6" class="anchored" data-anchor-id="mann-whitney-u-test"><span class="header-section-number">13.3.6</span> Mann-Whitney U test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox_test</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">distribution=</span><span class="st">"exact"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon-Mann-Whitney Test

data:  Time by IDE (Eclipse, VStudio)
Z = 2.9487, p-value = 0.002577
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox_test</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide2, <span class="at">distribution=</span><span class="st">"exact"</span>) <span class="co"># note: same result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon-Mann-Whitney Test

data:  logTime by IDE (Eclipse, VStudio)
Z = 2.9487, p-value = 0.002577
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="how-long-does-it-take-to-do-tasks-on-one-of-three-tools-one-way-anova-preparation" class="level3" data-number="13.3.7">
<h3 data-number="13.3.7" class="anchored" data-anchor-id="how-long-does-it-take-to-do-tasks-on-one-of-three-tools-one-way-anova-preparation"><span class="header-section-number">13.3.7</span> How long does it take to do tasks on one of three tools? (One-way ANOVA preparation)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. read in a data file with task completion times (min) now from 3 tools</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>ide3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/ide3.csv"</span>))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>ide3<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(ide3<span class="sc">$</span>Subject) <span class="co"># convert to nominal factor</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>ide3<span class="sc">$</span>IDE <span class="ot">&lt;-</span> <span class="fu">factor</span>(ide3<span class="sc">$</span>IDE) <span class="co"># convert to nominal factor</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ide3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject        IDE          Time      
 1      : 1   Eclipse:20   Min.   :143.0  
 2      : 1   PyCharm:20   1st Qu.:248.8  
 3      : 1   VStudio:20   Median :295.0  
 4      : 1                Mean   :353.9  
 5      : 1                3rd Qu.:391.2  
 6      : 1                Max.   :952.0  
 (Other):54                               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. view descriptive statistics by IDE</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(ide3, <span class="sc">~</span> IDE, <span class="cf">function</span>(data) <span class="fu">summary</span>(data<span class="sc">$</span>Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      IDE Min. 1st Qu. Median   Mean 3rd Qu. Max.
1 Eclipse  232  294.75  393.5 468.15  585.50  952
2 PyCharm  143  232.25  279.5 291.45  300.00  572
3 VStudio  155  246.50  287.0 302.10  335.25  632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(ide3, <span class="sc">~</span> IDE, summarise, <span class="at">Time.mean=</span><span class="fu">mean</span>(Time), <span class="at">Time.sd=</span><span class="fu">sd</span>(Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      IDE Time.mean  Time.sd
1 Eclipse    468.15 218.1241
2 PyCharm    291.45 106.8922
3 VStudio    302.10 101.0778</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>ide3 <span class="sc">|&gt;</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(IDE) <span class="sc">|&gt;</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median=</span><span class="fu">median</span>(Time),<span class="at">mean=</span><span class="fu">mean</span>(Time),<span class="at">sd=</span><span class="fu">sd</span>(Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  IDE     median  mean    sd
  &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Eclipse   394.  468.  218.
2 PyCharm   280.  291.  107.
3 VStudio   287   302.  101.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. explore new response distribution</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ide3,<span class="fu">aes</span>(Time,<span class="at">fill=</span>IDE)) <span class="sc">+</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">50</span>,<span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ide3,<span class="fu">aes</span>(IDE,Time,<span class="at">fill=</span>IDE)) <span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. test normality for new IDE</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"PyCharm"</span>,]<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ide3[ide3$IDE == "PyCharm", ]$Time
W = 0.88623, p-value = 0.02294</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide3) <span class="co"># fit model</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m)) <span class="co"># test residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m)
W = 0.89706, p-value = 0.000103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m)); <span class="fu">qqline</span>(<span class="fu">residuals</span>(m)) <span class="co"># plot residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. test log-normality of new IDE</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitdistr</span>(ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"PyCharm"</span>,]<span class="sc">$</span>Time, <span class="st">"lognormal"</span>)<span class="sc">$</span>estimate</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"PyCharm"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"plnorm"</span>, <span class="at">meanlog=</span>fit[<span class="dv">1</span>], <span class="at">sdlog=</span>fit[<span class="dv">2</span>], <span class="at">exact=</span><span class="cn">TRUE</span>) <span class="co"># lognormality</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  ide3[ide3$IDE == "PyCharm", ]$Time
D = 0.1864, p-value = 0.4377
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. compute new log(Time) column and re-test</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>ide3<span class="sc">$</span>logTime <span class="ot">&lt;-</span> <span class="fu">log</span>(ide3<span class="sc">$</span>Time) <span class="co"># add new column</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"PyCharm"</span>,]<span class="sc">$</span>logTime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  ide3[ide3$IDE == "PyCharm", ]$logTime
W = 0.96579, p-value = 0.6648</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide3) <span class="co"># fit model</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m)) <span class="co"># test residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m)
W = 0.96563, p-value = 0.08893</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m)); <span class="fu">qqline</span>(<span class="fu">residuals</span>(m)) <span class="co"># plot residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. test homoscedasticity</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide3, <span class="at">center=</span>median) <span class="co"># Brown-Forsythe test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2  1.7797 0.1779
      57               </code></pre>
</div>
</div>
</section>
<section id="can-we-transform-data-so-it-fits-assumptions-one-way-anova-suitable-now-to-logtime" class="level3" data-number="13.3.8">
<h3 data-number="13.3.8" class="anchored" data-anchor-id="can-we-transform-data-so-it-fits-assumptions-one-way-anova-suitable-now-to-logtime"><span class="header-section-number">13.3.8</span> Can we transform data so it fits assumptions? (One-way ANOVA, suitable now to logTime)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide3) <span class="co"># fit model</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m) <span class="co"># report anova</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: logTime
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
IDE        2 2.3064  1.1532   8.796 0.0004685 ***
Residuals 57 7.4729  0.1311                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. post hoc independent-samples t-tests</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TH.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">mcp</span>(<span class="at">IDE=</span><span class="st">"Tukey"</span>)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>)) <span class="co"># Tukey means compare all pairs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = logTime ~ IDE, data = ide3)

Linear Hypotheses:
                       Estimate Std. Error t value Pr(&gt;|t|)    
PyCharm - Eclipse == 0  -0.4380     0.1145  -3.826 0.000978 ***
VStudio - Eclipse == 0  -0.3895     0.1145  -3.402 0.002458 ** 
VStudio - PyCharm == 0   0.0485     0.1145   0.424 0.673438    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. note: equivalent to this using lsm instead of mcp</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">lsm</span>(pairwise <span class="sc">~</span> IDE)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: aov(formula = logTime ~ IDE, data = ide3)

Linear Hypotheses:
                       Estimate Std. Error t value Pr(&gt;|t|)    
Eclipse - PyCharm == 0   0.4380     0.1145   3.826 0.000978 ***
Eclipse - VStudio == 0   0.3895     0.1145   3.402 0.002458 ** 
PyCharm - VStudio == 0  -0.0485     0.1145  -0.424 0.673438    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
</section>
<section id="what-if-we-cant-transform-data-to-fit-anova-assumptions-nonparametric-equivalent-of-one-way-anova" class="level3" data-number="13.3.9">
<h3 data-number="13.3.9" class="anchored" data-anchor-id="what-if-we-cant-transform-data-to-fit-anova-assumptions-nonparametric-equivalent-of-one-way-anova"><span class="header-section-number">13.3.9</span> What if we can’t transform data to fit ANOVA assumptions? (Nonparametric equivalent of one-way ANOVA)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Kruskal-Wallis test</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal_test</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide3, <span class="at">distribution=</span><span class="st">"asymptotic"</span>) <span class="co"># can't do exact with 3 levels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Kruskal-Wallis Test

data:  Time by IDE (Eclipse, PyCharm, VStudio)
chi-squared = 12.17, df = 2, p-value = 0.002277</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal_test</span>(logTime <span class="sc">~</span> IDE, <span class="at">data=</span>ide3, <span class="at">distribution=</span><span class="st">"asymptotic"</span>) <span class="co"># note: same result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Kruskal-Wallis Test

data:  logTime by IDE (Eclipse, PyCharm, VStudio)
chi-squared = 12.17, df = 2, p-value = 0.002277</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. for reporting Kruskal-Wallis as chi-square, we can get N with nrow(ide3)</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co">#. manual post hoc Mann-Whitney U pairwise comparisons</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co">#. note: wilcox_test we used above doesn't take two data vectors, so use wilcox.test</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>vs.ec <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"VStudio"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>            ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"Eclipse"</span>,]<span class="sc">$</span>Time, <span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>vs.py <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"VStudio"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>            ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"PyCharm"</span>,]<span class="sc">$</span>Time, <span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>ec.py <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"Eclipse"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>            ide3[ide3<span class="sc">$</span>IDE <span class="sc">==</span> <span class="st">"PyCharm"</span>,]<span class="sc">$</span>Time, <span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(vs.ec<span class="sc">$</span>p.value, vs.py<span class="sc">$</span>p.value, ec.py<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007681846 0.588488864 0.007681846</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. alternative approach is using PMCMRplus for nonparam pairwise comparisons</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PMCMRplus)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kwAllPairsConoverTest</span>(Time <span class="sc">~</span> IDE, <span class="at">data=</span>ide3, <span class="at">p.adjust.method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in kwAllPairsConoverTest.default(c(341, 291, 283, 155, 271, 270, : Ties
are present. Quantiles were corrected for ties.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
    Pairwise comparisons using Conover's all-pairs test</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>data: Time by IDE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Eclipse PyCharm
PyCharm 0.0025  -      
VStudio 0.0062  0.6620 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
P value adjustment method: holm</code></pre>
</div>
</div>
<p>The above test was reported by W. J. Conover and R. L. Iman (1979), <em>On multiple-comparisons procedures</em>, Tech. Rep.&nbsp;LA-7677-MS, Los Alamos Scientific Laboratory.</p>
</section>
<section id="another-example-of-tasks-using-two-tools-more-on-oneway-anova" class="level3" data-number="13.3.10">
<h3 data-number="13.3.10" class="anchored" data-anchor-id="another-example-of-tasks-using-two-tools-more-on-oneway-anova"><span class="header-section-number">13.3.10</span> Another example of tasks using two tools (More on oneway ANOVA)</h3>
<p>The <code>designtime</code> data records task times in minutes to complete the same project in Illustrator or InDesign.</p>
<p>Read the designtime data into R. Determine how many subjects participated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/designtime.csv"</span>))</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. convert Subject to a factor</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dt<span class="sc">$</span>Subject)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>Tool<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dt<span class="sc">$</span>Tool)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject            Tool         Time       
 1      : 1   Illustrator:30   Min.   : 98.19  
 2      : 1   InDesign   :30   1st Qu.:149.34  
 3      : 1                    Median :205.54  
 4      : 1                    Mean   :275.41  
 5      : 1                    3rd Qu.:361.99  
 6      : 1                    Max.   :926.15  
 (Other):54                                    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(dt<span class="sc">$</span>Subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Subject Tool         Time
  &lt;fct&gt;   &lt;fct&gt;       &lt;dbl&gt;
1 55      Illustrator  218.
2 56      InDesign     180.
3 57      Illustrator  170.
4 58      InDesign     186.
5 59      Illustrator  241.
6 60      InDesign     159.</code></pre>
</div>
</div>
<p>We see from the summary that there are sixty observations. We can see the same by checking the <code>length()</code> of the Subject (or any other) variable in the data.</p>
<p>Create a boxplot of the task time for each tool and comment on the medians and variances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dt,<span class="fu">aes</span>(Tool,Time,<span class="at">fill=</span>Tool)) <span class="sc">+</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Both the median and the variance is much larger for Illustrator than for InDesign.</p>
<p>Conduct a Shapiro-Wilk test for normality for each tool and comment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(dt[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"Illustrator"</span>,]<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  dt[dt$Tool == "Illustrator", ]$Time
W = 0.90521, p-value = 0.01129</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(dt[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"InDesign"</span>,]<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  dt[dt$Tool == "InDesign", ]$Time
W = 0.95675, p-value = 0.2553</code></pre>
</div>
</div>
<p>In the case of InDesign, we fail to reject the null hypothesis that the data are drawn from a normal distribution. In the case of Illustrator, we reject the null hypothesis at the five percent level but not at the one percent level (just barely).</p>
<p>Conduct a Shapiro-Wilk test for normality on the residuals and comment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">aov</span>(Time<span class="sc">~</span>Tool,<span class="at">data=</span>dt)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m)
W = 0.85077, p-value = 3.211e-06</code></pre>
</div>
</div>
<p>We reject the null hypothesis that the residuals are normally distributed.</p>
<p>Conduct a Brown-Forsythe test of homoscedasticity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Time<span class="sc">~</span>Tool,<span class="at">data=</span>dt,<span class="at">center=</span>median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value    Pr(&gt;F)    
group  1  20.082 3.545e-05 ***
      58                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We reject the null hypothesis that the two samples are drawn from populations with equal variance.</p>
<p>Fit a lognormal distribution to the Time response for each Tool. Conduct a Kolmogorov-Smirnov goodness-of-fit test and comment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdistr</span>(dt[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"Illustrator"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lognormal"</span>)<span class="sc">$</span>estimate</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>tst<span class="ot">&lt;-</span><span class="fu">ks.test</span>(dt[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"Illustrator"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"plnorm"</span>,<span class="at">meanlog=</span>fit[<span class="dv">1</span>],<span class="at">sdlog=</span>fit[<span class="dv">2</span>],<span class="at">exact=</span><span class="cn">TRUE</span>)</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>tst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  dt[dt$Tool == "Illustrator", ]$Time
D = 0.093358, p-value = 0.9344
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdistr</span>(dt[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"InDesign"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lognormal"</span>)<span class="sc">$</span>estimate</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>tst<span class="ot">&lt;-</span><span class="fu">ks.test</span>(dt[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"InDesign"</span>,]<span class="sc">$</span>Time,</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"plnorm"</span>,<span class="at">meanlog=</span>fit[<span class="dv">1</span>],<span class="at">sdlog=</span>fit[<span class="dv">2</span>],<span class="at">exact=</span><span class="cn">TRUE</span>)</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>tst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  dt[dt$Tool == "InDesign", ]$Time
D = 0.10005, p-value = 0.8958
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>We fail to reject the null hypothesis that the Illustrator sample is drawn from a lognormal distribution. We fail to reject the null hypothesis that the InDesign sample is drawn from a lognormal distribution.</p>
<p>Create a log-transformed Time response column. Compute the mean for each tool and comment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>logTime<span class="ot">&lt;-</span><span class="fu">log</span>(dt<span class="sc">$</span>Time)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dt<span class="sc">$</span>logTime[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"Illustrator"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.894288</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dt<span class="sc">$</span>logTime[dt<span class="sc">$</span>Tool<span class="sc">==</span><span class="st">"InDesign"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.03047</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>dt <span class="sc">|&gt;</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Tool) <span class="sc">|&gt;</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(logTime),<span class="at">sd=</span><span class="fu">sd</span>(logTime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  Tool         mean    sd
  &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;
1 Illustrator  5.89 0.411
2 InDesign     5.03 0.211</code></pre>
</div>
</div>
<p>The mean for Illustrator appears to be larger than the mean for InDesign.</p>
<p>Conduct an independent-samples <span class="math inline">\(t\)</span>-test on the log-transformed Time response, using the Welch version for unequal variances and comment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(logTime<span class="sc">~</span>Tool,<span class="at">data=</span>dt,<span class="at">var.equal=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  logTime by Tool
t = 10.23, df = 43.293, p-value = 3.98e-13
alternative hypothesis: true difference in means between group Illustrator and group InDesign is not equal to 0
95 percent confidence interval:
 0.6935646 1.0340718
sample estimates:
mean in group Illustrator    mean in group InDesign 
                 5.894288                  5.030470 </code></pre>
</div>
</div>
<p>We reject the null hypothesis that the true difference in means is equal to 0.</p>
<p>Conduct an exact nonparametric Mann-Whitney <span class="math inline">\(U\)</span> test on the Time response and comment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox_test</span>(Time<span class="sc">~</span>Tool,<span class="at">data=</span>dt,<span class="at">distribution=</span><span class="st">"exact"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon-Mann-Whitney Test

data:  Time by Tool (Illustrator, InDesign)
Z = 6.3425, p-value = 5.929e-14
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
<p>We reject the null hypothesis that the samples were drawn from populations with the same distribution.</p>
</section>
<section id="differences-in-writing-speed-among-three-tools-three-levels-of-a-factor-in-anova" class="level3" data-number="13.3.11">
<h3 data-number="13.3.11" class="anchored" data-anchor-id="differences-in-writing-speed-among-three-tools-three-levels-of-a-factor-in-anova"><span class="header-section-number">13.3.11</span> Differences in writing speed among three tools (Three levels of a factor in ANOVA)</h3>
<p>We’ll examine three levels of a factor, which is an alphabet system used for writing. The three levels are named for the text entry systems, EdgeWrite, Graffiti, and Unistrokes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/alphabets.csv"</span>))</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">as.factor</span>(alpha<span class="sc">$</span>Subject)</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="sc">$</span>Alphabet<span class="ot">&lt;-</span><span class="fu">as.factor</span>(alpha<span class="sc">$</span>Alphabet)</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject         Alphabet       WPM        
 1      : 1   EdgeWrite :20   Min.   : 3.960  
 2      : 1   Graffiti  :20   1st Qu.: 9.738  
 3      : 1   Unistrokes:20   Median :13.795  
 4      : 1                   Mean   :14.517  
 5      : 1                   3rd Qu.:18.348  
 6      : 1                   Max.   :28.350  
 (Other):54                                   </code></pre>
</div>
</div>
<p>Plot the three text entry systems. ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alpha,<span class="fu">aes</span>(Alphabet,WPM,<span class="at">fill=</span>Alphabet)) <span class="sc">+</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<p>:::</p>
<p>Identify the average words per minute written with EdgeWrite.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(alpha[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"EdgeWrite"</span>,]<span class="sc">$</span>WPM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.14</code></pre>
</div>
</div>
<p>Conduct a Shapiro-Wilk test for normality on each method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"EdgeWrite"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  alpha$WPM[alpha$Alphabet == "EdgeWrite"]
W = 0.95958, p-value = 0.5355</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"Graffiti"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  alpha$WPM[alpha$Alphabet == "Graffiti"]
W = 0.94311, p-value = 0.2743</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"Unistrokes"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  alpha$WPM[alpha$Alphabet == "Unistrokes"]
W = 0.94042, p-value = 0.2442</code></pre>
</div>
</div>
<p>Conduct a Shapiro-Wilk test for normality on the residuals of an ANOVA model stipulating that Alphabet affects WPM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">aov</span>(WPM<span class="sc">~</span>Alphabet,<span class="at">data=</span>alpha)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m)
W = 0.97762, p-value = 0.3363</code></pre>
</div>
</div>
<p>Test for homoscedasticity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(alpha<span class="sc">$</span>WPM<span class="sc">~</span>alpha<span class="sc">$</span>Alphabet,<span class="at">center=</span><span class="st">"median"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "median")
      Df F value Pr(&gt;F)
group  2  1.6219 0.2065
      57               </code></pre>
</div>
</div>
<p>Now test all three. The <code>mcp</code> function tests multiple means. The keyword <code>Tukey</code> means to do all the possible pairwise comparisons of Alphabet, i.e., Graffiti and EdgeWrite, Graffiti and Unistrokes, and EdgeWrite and Unistrokes. <code>m</code> is the oneway ANOVA model we created above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multcomp<span class="sc">::</span><span class="fu">glht</span>(m,multcomp<span class="sc">::</span><span class="fu">mcp</span>(<span class="at">Alphabet=</span><span class="st">"Tukey"</span>)),<span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = WPM ~ Alphabet, data = alpha)

Linear Hypotheses:
                            Estimate Std. Error t value Pr(&gt;|t|)   
Graffiti - EdgeWrite == 0     -2.101      1.693  -1.241  0.21982   
Unistrokes - EdgeWrite == 0   -5.769      1.693  -3.407  0.00363 **
Unistrokes - Graffiti == 0    -3.668      1.693  -2.166  0.06894 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<p>Conduct a nonparametric oneway ANOVA using the Kruskal-Wallis test to see if the samples have the same distribution. The null hypothesis is that the samples come from the same distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal_test</span>(alpha<span class="sc">$</span>WPM<span class="sc">~</span>alpha<span class="sc">$</span>Alphabet,<span class="at">distribution=</span><span class="st">"asymptotic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Kruskal-Wallis Test

data:  alpha$WPM by
     alpha$Alphabet (EdgeWrite, Graffiti, Unistrokes)
chi-squared = 9.7019, df = 2, p-value = 0.007821</code></pre>
</div>
</div>
<p>Conduct manual post hoc Mann-Whitney pairwise comparisons and adjust the <span class="math inline">\(p\)</span>-values to take into account the possibility of false discovery.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>ewgf<span class="ot">&lt;-</span><span class="fu">wilcox.test</span>(alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"EdgeWrite"</span>],alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"Graffiti"</span>],<span class="at">paired=</span><span class="cn">FALSE</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>ewun<span class="ot">&lt;-</span><span class="fu">wilcox.test</span>(alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"EdgeWrite"</span>],alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"Unistrokes"</span>],<span class="at">paired=</span><span class="cn">FALSE</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>gfun<span class="ot">&lt;-</span><span class="fu">wilcox.test</span>(alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"Graffiti"</span>],alpha<span class="sc">$</span>WPM[alpha<span class="sc">$</span>Alphabet<span class="sc">==</span><span class="st">"Unistrokes"</span>],<span class="at">paired=</span><span class="cn">FALSE</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(ewgf<span class="sc">$</span>p.value,ewun<span class="sc">$</span>p.value,gfun<span class="sc">$</span>p.value),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.20358147 0.01810677 0.04146919</code></pre>
</div>
</div>
</section>
</section>
<section id="same-person-using-two-different-tools-paired-samples-t-test" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="same-person-using-two-different-tools-paired-samples-t-test"><span class="header-section-number">13.4</span> Same person using two different tools (Paired samples <span class="math inline">\(t\)</span>-test)</h2>
<p>Is it better to search or scroll for contacts in a smartphone contacts manager? Which takes more time? Which takes more effort? Which is more error-prone? Start by reading in data, converting to factors, and summarizing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>srchscrl <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/srchscrl.csv"</span>))</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>srchscrl<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(srchscrl<span class="sc">$</span>Subject)</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>srchscrl<span class="sc">$</span>Order   <span class="ot">&lt;-</span> <span class="fu">factor</span>(srchscrl<span class="sc">$</span>Order)</span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>srchscrl<span class="sc">$</span>Technique   <span class="ot">&lt;-</span> <span class="fu">factor</span>(srchscrl<span class="sc">$</span>Technique)</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co">#. srchscrl$Errors   &lt;- factor(srchscrl$Errors,ordered=TRUE,levels=c(0,1,2,3,4))</span></span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(srchscrl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject    Technique  Order       Time           Errors         Effort 
 1      : 2   Scroll:20   1:20   Min.   : 49.0   Min.   :0.00   Min.   :1  
 2      : 2   Search:20   2:20   1st Qu.: 94.5   1st Qu.:0.75   1st Qu.:3  
 3      : 2                      Median :112.5   Median :1.50   Median :4  
 4      : 2                      Mean   :117.0   Mean   :1.60   Mean   :4  
 5      : 2                      3rd Qu.:148.2   3rd Qu.:2.25   3rd Qu.:5  
 6      : 2                      Max.   :192.0   Max.   :4.00   Max.   :7  
 (Other):28                                                                </code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">xtable.comment=</span><span class="cn">FALSE</span>)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">xtable.booktabs=</span><span class="cn">TRUE</span>)</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="fu">xtable</span>(<span class="fu">head</span>(srchscrl),<span class="at">caption=</span><span class="st">"First rows of data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>View descriptive statistics by Technique. There are several ways to do this. The following uses the <code>plyr</code> package. ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrl, <span class="sc">~</span> Technique,</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(data) <span class="fu">summary</span>(data<span class="sc">$</span>Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Min. 1st Qu. Median  Mean 3rd Qu. Max.
1    Scroll   49  123.50  148.5 137.2     161  192
2    Search   50   86.75   99.5  96.8     106  147</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrl, <span class="sc">~</span> Technique,</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>      summarise, <span class="at">Time.mean=</span><span class="fu">mean</span>(Time), <span class="at">Time.sd=</span><span class="fu">sd</span>(Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Time.mean  Time.sd
1    Scroll     137.2 35.80885
2    Search      96.8 23.23020</code></pre>
</div>
<p>:::</p>
<p>Another approach is to use the <code>dplyr</code> package. Be aware that it conflicts with <code>plyr</code> so you should try to avoid using both. If you must use both, as I did above, it may make the most sense to call particular functions from the <code>plyr</code> package rather than load the package. This is what I did with <code>plyr::ddply()</code> above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>srchscrl <span class="sc">|&gt;</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Technique) <span class="sc">|&gt;</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(Time),<span class="at">sd=</span><span class="fu">sd</span>(Time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  Technique  mean    sd
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 Scroll    137.   35.8
2 Search     96.8  23.2</code></pre>
</div>
</div>
<p>You can explore the Time response by making histograms or boxplots. One approach is to use the <code>ggplot2</code> package and put the histograms together in one frame. The <code>ggplot2</code> package allows for a remarkable variety of options.</p>
<div class="cell" data-fig.margin="false">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrl,<span class="fu">aes</span>(Time,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>,<span class="at">alpha=</span><span class="fl">0.9</span>,<span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can use the same package for boxplots. Boxplots show the median as a bold line in the middle of the box. The box itself ranges from the first quartile (starting at the 25th percentile) to the third quartile (terminating at the 75th percentile). The whiskers run from the minimum to the maximum, where these are defined as the 25th percentile minus 1.5 times the interquartile range and the 75th percentile plus 1.5 times the interquartile range. The interquartile range is the width of the box. Dots outside the whiskers show outliers.</p>
<div class="cell" data-fig.margin="false">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrl,<span class="fu">aes</span>(Technique,Time,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We would rather use parametric statistics if ANOVA assumptions are met. Recall that we can test for normality, normality of residuals, and homoscedasticity. In the case of a within-subjects experiment, we can also test for order effects which is one way to test the independence assumption. First test whether these times seem to be drawn from a normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(srchscrl[srchscrl<span class="sc">$</span>Technique <span class="sc">==</span> <span class="st">"Search"</span>,]<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  srchscrl[srchscrl$Technique == "Search", ]$Time
W = 0.96858, p-value = 0.7247</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(srchscrl[srchscrl<span class="sc">$</span>Technique <span class="sc">==</span> <span class="st">"Scroll"</span>,]<span class="sc">$</span>Time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  srchscrl[srchscrl$Technique == "Scroll", ]$Time
W = 0.91836, p-value = 0.09213</code></pre>
</div>
</div>
<p>In both cases we fail to reject the null hypothesis, which is that the Time data are drawn from a normal distribution. Note that we fail to reject at <span class="math inline">\(\alpha=0.05\)</span> but that in the case of the Scroll technique we would reject at <span class="math inline">\(\alpha=0.1\)</span>.</p>
<p>Fit a model for testing residuals—the Error function is used to indicate within-subject effects, i.e., each Subject was exposed to all levels of Technique. generally, Error(S/(A<em>B</em>C)) means each S was exposed to every level of A, B, C and S is a column encoding subject ids.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(Time <span class="sc">~</span> Technique <span class="sc">+</span> <span class="fu">Error</span>(Subject<span class="sc">/</span>Technique),</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>srchscrl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above-specified model has residuals—departures of the observed data from the data that would be expected if the model were accurate.</p>
<p>Now we can test the residuals of this model for normality and also examine a QQ plot for normality. The QQ plot shows the theoretical line to which the residuals should adhere if they are normally distributed. Deviations from that line are indications of non-normality. First test by Subject.</p>
<div class="cell" data-fig.margin="true">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m<span class="sc">$</span>Subject))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m$Subject)
W = 0.9603, p-value = 0.5783</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m<span class="sc">$</span>Subject)) </span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m<span class="sc">$</span>Subject))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We fail to reject the null hypothesis of normality and the QQ plot looks normal. So far, so good.</p>
<p>Next test by Subject:Technique.</p>
<div class="cell" data-fig.margin="true">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m<span class="sc">$</span><span class="st">'Subject:Technique'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m$"Subject:Technique")
W = 0.97303, p-value = 0.8172</code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m<span class="sc">$</span><span class="st">'Subject:Technique'</span>))</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m<span class="sc">$</span><span class="st">'Subject:Technique'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We fail to reject the null hypothesis of normality and the QQ plot looks normal. We’re getting there.</p>
<p>We’re still checking the ANOVA assumptions. Next thing to test is homoscedasticity, the assumption of equal variance. For this we use the Brown-Forsythe test, a variant of Levene’s test that uses the median instead of the mean, providing greater robustness against non-normal data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(Time <span class="sc">~</span> Technique, <span class="at">data=</span>srchscrl, <span class="at">center=</span>median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  2.0088 0.1645
      38               </code></pre>
</div>
</div>
<p>This experiment used counterbalancing to ward off the possibility of an order effect. An order effect results from learning or fatigue or some other factor based on the order in which the tests were run. We would like to not have that happen and one solution is to have half the subjects do task A first and half the subjects do task B first. This is the simplest form of counterbalancing. It becomes more problematic if there are more than two tasks.</p>
<p>For a paired-samples <span class="math inline">\(t\)</span>-test we must use a wide-format table; most R functions do not require a wide-format table, but the <code>dcast()</code> function offers a quick way to translate long-format into wide-format when we need it.</p>
<p>A wide-format table has one subject in every row. A long-format table has one observation in every row. Most R functions use long-format tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    smiths</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>srchscrl.wide.order <span class="ot">&lt;-</span> <span class="fu">dcast</span>(srchscrl, Subject <span class="sc">~</span> Order,</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">value.var=</span><span class="st">"Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtable</span>(<span class="fu">head</span>(srchscrl.wide.order),</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"First rows of wide order"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now conduct a <span class="math inline">\(t\)</span>-test to see if order has an effect. ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(srchscrl.wide.order<span class="sc">$</span><span class="st">"1"</span>, srchscrl.wide.order<span class="sc">$</span><span class="st">"2"</span>,</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  srchscrl.wide.order$"1" and srchscrl.wide.order$"2"
t = -1.3304, df = 19, p-value = 0.1991
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -47.34704  10.54704
sample estimates:
mean difference 
          -18.4 </code></pre>
</div>
<p>:::</p>
<p>We fail to reject the null hypothesis that the responses do not differ according to order. To phrase this in a more readable (!) way, we have evidence that the order does not matter.</p>
<section id="running-the-paired-t-test" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="running-the-paired-t-test"><span class="header-section-number">13.4.1</span> Running the paired <span class="math inline">\(t\)</span>-test</h3>
<p>It now makes sense to use a paired <span class="math inline">\(t\)</span>-test since the ANOVA assumptions have been satisfied. This is a parametric test of Time where we pair subjects by technique. Again, we need the wide-format table to conduct a paired test. The wide-format table has one row for each subject rather than one row for each observation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>srchscrl.wide.tech <span class="ot">=</span> <span class="fu">dcast</span>(srchscrl, Subject <span class="sc">~</span> Technique,</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">value.var=</span><span class="st">"Time"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtable</span>(<span class="fu">head</span>(srchscrl.wide.tech),</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"First rows of wide technique"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(srchscrl.wide.tech<span class="sc">$</span>Search, srchscrl.wide.tech<span class="sc">$</span>Scroll,</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired=</span><span class="cn">TRUE</span>, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  srchscrl.wide.tech$Search and srchscrl.wide.tech$Scroll
t = -3.6399, df = 19, p-value = 0.001743
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -63.63083 -17.16917
sample estimates:
mean difference 
          -40.4 </code></pre>
</div>
</div>
<p>This supports the intuition we developed doing the histogram and boxplots only now we have a valid statistical test to support this intuition.</p>
<p>Suppose we did not satisfy the ANOVA assumptions. Then we would conduct the nonparametric equivalent of paired-samples t-test.</p>
</section>
<section id="exploring-a-poisson-distributed-factor" class="level3" data-number="13.4.2">
<h3 data-number="13.4.2" class="anchored" data-anchor-id="exploring-a-poisson-distributed-factor"><span class="header-section-number">13.4.2</span> Exploring a Poisson-distributed factor</h3>
<p>Explore the Errors response; error counts are often Poisson-distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrl, <span class="sc">~</span> Technique, <span class="cf">function</span>(data)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summary</span>(data<span class="sc">$</span>Errors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Min. 1st Qu. Median Mean 3rd Qu. Max.
1    Scroll    0       0    0.5  0.7       1    2
2    Search    1       2    2.5  2.5       3    4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrl, <span class="sc">~</span> Technique, summarise,</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">Errors.mean=</span><span class="fu">mean</span>(Errors), <span class="at">Errors.sd=</span><span class="fu">sd</span>(Errors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Errors.mean Errors.sd
1    Scroll         0.7 0.8013147
2    Search         2.5 1.0513150</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrl,<span class="fu">aes</span>(Errors,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.9</span>,<span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrl,<span class="fu">aes</span>(Technique,Errors,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-61-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Try to fit a Poisson distribution for count data. Note that <code>ks.test()</code> only works for continuous distributions, but Poisson distributions are discrete, so use fitdist, not fitdistr, and test with gofstat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">fitdist</span>(srchscrl[srchscrl<span class="sc">$</span>Technique <span class="sc">==</span> <span class="st">"Search"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit) <span class="co"># goodness-of-fit test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  1.522231 
Degree of freedom of the Chi-squared distribution:  2 
Chi-squared p-value:  0.4671449 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 1  4.000000   5.745950
&lt;= 2  6.000000   5.130312
&lt;= 3  6.000000   4.275260
&gt; 3   4.000000   4.848477

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   65.61424
Bayesian Information Criterion   66.60997</code></pre>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">fitdist</span>(srchscrl[srchscrl<span class="sc">$</span>Technique <span class="sc">==</span> <span class="st">"Scroll"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit) <span class="co"># goodness-of-fit test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  0.3816087 
Degree of freedom of the Chi-squared distribution:  1 
Chi-squared p-value:  0.5367435 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 0 10.000000   9.931706
&lt;= 1  6.000000   6.952194
&gt; 1   4.000000   3.116100

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   45.53208
Bayesian Information Criterion   46.52781</code></pre>
</div>
</div>
<p>Conduct a Wilcoxon signed-rank test on Errors. ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcoxsign_test</span>(Errors <span class="sc">~</span> Technique <span class="sc">|</span> Subject,</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>srchscrl, <span class="at">distribution=</span><span class="st">"exact"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon-Pratt Signed-Rank Test

data:  y by x (pos, neg) 
     stratified by block
Z = -3.6701, p-value = 6.104e-05
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
<p>:::</p>
<p>Note: the term afer the “|” indicates the within-subjects blocking term for matched pairs.</p>
</section>
<section id="examining-a-likert-scale-response-item" class="level3" data-number="13.4.3">
<h3 data-number="13.4.3" class="anchored" data-anchor-id="examining-a-likert-scale-response-item"><span class="header-section-number">13.4.3</span> Examining a Likert scale response item</h3>
<p>Now also examine Effort, the ordinal Likert scale response (1-7).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrl, <span class="sc">~</span> Technique, <span class="cf">function</span>(data)</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summary</span>(data<span class="sc">$</span>Effort))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Min. 1st Qu. Median Mean 3rd Qu. Max.
1    Scroll    1       3      4  4.4    6.00    7
2    Search    1       3      4  3.6    4.25    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrl, <span class="sc">~</span> Technique, summarise,</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">Effort.mean=</span><span class="fu">mean</span>(Effort), <span class="at">Effort.sd=</span><span class="fu">sd</span>(Effort))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Effort.mean Effort.sd
1    Scroll         4.4  1.698296
2    Search         3.6  1.187656</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrl,<span class="fu">aes</span>(Effort,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.9</span>,<span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrl,<span class="fu">aes</span>(Technique,Effort,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Set3"</span>) <span class="sc">+</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>,<span class="at">binaxis=</span><span class="st">'y'</span>,<span class="at">stackdir=</span><span class="st">'center'</span>,<span class="at">dotsize=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-65-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Our response is ordinal within-subjects, so use nonparametric Wilcoxon signed-rank.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcoxsign_test</span>(Effort <span class="sc">~</span> Technique <span class="sc">|</span> Subject,</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>srchscrl, <span class="at">distribution=</span><span class="st">"exact"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon-Pratt Signed-Rank Test

data:  y by x (pos, neg) 
     stratified by block
Z = 1.746, p-value = 0.08746
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
</section>
</section>
<section id="people-doing-tasks-on-different-phones-in-different-postures-factorial-anova" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="people-doing-tasks-on-different-phones-in-different-postures-factorial-anova"><span class="header-section-number">13.5</span> People doing tasks on different phones in different postures (Factorial ANOVA)</h2>
<p>The scenario is text entry on smartphone keyboards: iPhone and Galaxy, in different postures: sitting, walking, standing.</p>
<p>The statistics employed include Factorial ANOVA, repeated measures ANOVA, main effects, interaction effects, the Aligned Rank Transform for nonparametric ANOVAs.</p>
<p>This is a <span class="math inline">\(3 \times 2\)</span> mixed factorial design. It is mixed in the sense that there is a between-subjects factor (Keyboard) and a within-subjects factor (Posture). It is balanced in the sense that there are twelve persons using each Keyboard and they are each examined for all three levels of Posture.</p>
<section id="read-and-describe-the-data" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="read-and-describe-the-data"><span class="header-section-number">13.5.1</span> Read and describe the data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>mbltxt <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/mbltxt.csv"</span>))</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mbltxt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Subject Keyboard Posture Posture_Order   WPM Error_Rate
    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
1       1 iPhone   Sit                 1  20.2     0.022 
2       1 iPhone   Stand               2  23.7     0.03  
3       1 iPhone   Walk                3  20.8     0.0415
4       2 iPhone   Sit                 1  20.9     0.022 
5       2 iPhone   Stand               3  23.3     0.0255
6       2 iPhone   Walk                2  19.1     0.0355</code></pre>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>mbltxt <span class="ot">&lt;-</span> <span class="fu">within</span>(mbltxt, Subject <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Subject))</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>mbltxt <span class="ot">&lt;-</span> <span class="fu">within</span>(mbltxt, Keyboard <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Keyboard))</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>mbltxt <span class="ot">&lt;-</span> <span class="fu">within</span>(mbltxt, Posture <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Posture))</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>mbltxt <span class="ot">&lt;-</span> <span class="fu">within</span>(mbltxt, Posture_Order <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Posture_Order))</span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mbltxt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject     Keyboard   Posture   Posture_Order      WPM        
 1      : 3   Galaxy:36   Sit  :24   1:24          Min.   : 9.454  
 2      : 3   iPhone:36   Stand:24   2:24          1st Qu.:19.091  
 3      : 3               Walk :24   3:24          Median :21.032  
 4      : 3                                        Mean   :20.213  
 5      : 3                                        3rd Qu.:23.476  
 6      : 3                                        Max.   :25.380  
 (Other):54                                                        
   Error_Rate     
 Min.   :0.01500  
 1st Qu.:0.02200  
 Median :0.03050  
 Mean   :0.03381  
 3rd Qu.:0.04000  
 Max.   :0.06950  
                  </code></pre>
</div>
</div>
</section>
<section id="explore-the-wpm-words-per-minute-data" class="level3" data-number="13.5.2">
<h3 data-number="13.5.2" class="anchored" data-anchor-id="explore-the-wpm-words-per-minute-data"><span class="header-section-number">13.5.2</span> Explore the WPM (words per minute) data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> mbltxt <span class="sc">|&gt;</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Keyboard,Posture) <span class="sc">|&gt;</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">WPM.median=</span><span class="fu">median</span>(WPM),</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">WPM.mean=</span><span class="fu">mean</span>(WPM),</span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">WPM.sd=</span><span class="fu">sd</span>(WPM)</span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Keyboard'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   Keyboard [2]
  Keyboard Posture WPM.median WPM.mean WPM.sd
  &lt;fct&gt;    &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 Galaxy   Sit           23.8     23.9  0.465
2 Galaxy   Stand         21.2     21.2  0.810
3 Galaxy   Walk          12.2     12.1  1.26 
4 iPhone   Sit           20.9     21.0  0.701
5 iPhone   Stand         23.8     23.9  0.834
6 iPhone   Walk          19.1     19.2  1.35 </code></pre>
</div>
</div>
</section>
<section id="histograms-for-both-factors" class="level3" data-number="13.5.3">
<h3 data-number="13.5.3" class="anchored" data-anchor-id="histograms-for-both-factors"><span class="header-section-number">13.5.3</span> Histograms for both factors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mbltxt,<span class="fu">aes</span>(WPM,<span class="at">fill=</span>Keyboard)) <span class="sc">+</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.9</span>,<span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>() <span class="sc">+</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Keyboard<span class="sc">~</span>Posture) <span class="sc">+</span></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplot-of-both-factors" class="level3" data-number="13.5.4">
<h3 data-number="13.5.4" class="anchored" data-anchor-id="boxplot-of-both-factors"><span class="header-section-number">13.5.4</span> Boxplot of both factors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mbltxt,<span class="fu">aes</span>(Keyboard,WPM,<span class="at">fill=</span>Keyboard)) <span class="sc">+</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Blues"</span>) <span class="sc">+</span></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Posture) <span class="sc">+</span></span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="an-interaction-plot" class="level3" data-number="13.5.5">
<h3 data-number="13.5.5" class="anchored" data-anchor-id="an-interaction-plot"><span class="header-section-number">13.5.5</span> An interaction plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mbltxt,</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">interaction.plot</span>(Posture, Keyboard, WPM,</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(mbltxt<span class="sc">$</span>WPM))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="test-for-a-posture-order-effect" class="level3" data-number="13.5.6">
<h3 data-number="13.5.6" class="anchored" data-anchor-id="test-for-a-posture-order-effect"><span class="header-section-number">13.5.6</span> Test for a Posture order effect</h3>
<p>This is to ensure that counterbalancing worked.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ez)</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">ezANOVA</span>(<span class="at">dv=</span>WPM,</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">between=</span>Keyboard,</span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">within=</span>Posture_Order,</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">wid=</span>Subject,</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>mbltxt)</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Mauchly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Effect         W         p p&lt;.05
3          Posture_Order 0.9912922 0.9122583      
4 Keyboard:Posture_Order 0.9912922 0.9122583      </code></pre>
</div>
</div>
<p>Wikipedia tells us that “Sphericity is an important assumption of a repeated-measures ANOVA. It refers to the condition where the variances of the differences between all possible pairs of within-subject conditions (i.e., levels of the independent variable) are equal. The violation of sphericity occurs when it is not the case that the variances of the differences between all combinations of the conditions are equal. If sphericity is violated, then the variance calculations may be distorted, which would result in an <span class="math inline">\(F\)</span>-ratio that would be inflated.” (from the Wikipedia article on Mauchly’s sphericity test)</p>
<p>Mauchly’s test of sphericity above tells us that there is <em>not</em> a significant departure from sphericity, so we can better rely on the <span class="math inline">\(F\)</span>-statistic in the following ANOVA, the purpose of which is to detect any order effect that would interfere with our later results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Effect DFn DFd            F            p p&lt;.05          ges
2               Keyboard   1  22 1.244151e+02 1.596641e-10     * 0.0794723123
3          Posture_Order   2  44 5.166254e-02 9.497068e-01       0.0023071128
4 Keyboard:Posture_Order   2  44 2.830819e-03 9.971734e-01       0.0001266932</code></pre>
</div>
</div>
<p>The <span class="math inline">\(F\)</span>-statistic for Posture_Order is very small, indicating that there is not an order effect. That gives us the confidence to run the ANOVA test we wanted to run all along.</p>
</section>
</section>
<section id="differences-between-peoples-performance-and-within-a-persons-performance-two-way-mixed-factorial-anova" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="differences-between-peoples-performance-and-within-a-persons-performance-two-way-mixed-factorial-anova"><span class="header-section-number">13.6</span> Differences between people’s performance and within a person’s performance (Two-way mixed factorial ANOVA)</h2>
<p>Since a mixed factorial design by definition has both a between-subjects and a within-subjects factor, we don’t need to also mention that this is a repeated measures test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">ezANOVA</span>(<span class="at">dv=</span>WPM,</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">between=</span>Keyboard,</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">within=</span>Posture,</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">wid=</span>Subject,</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>mbltxt)</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Mauchly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Effect         W           p p&lt;.05
3          Posture 0.6370236 0.008782794     *
4 Keyboard:Posture 0.6370236 0.008782794     *</code></pre>
</div>
</div>
<p>In this case, sphericity <em>is</em> violated, so we need to additionally apply the Greenhouse-Geisser correction or the less conservative Huyn-Feldt correction. Nevertheless, let’s look at the uncorrected ANOVA table. Later, we’ll compare it with the uncorrected version provided by the <code>aov()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Effect DFn DFd        F            p p&lt;.05       ges
2         Keyboard   1  22 124.4151 1.596641e-10     * 0.6151917
3          Posture   2  44 381.4980 1.602465e-28     * 0.9255880
4 Keyboard:Posture   2  44 157.1600 9.162076e-21     * 0.8367128</code></pre>
</div>
</div>
<p>Note that “ges” in the ANOVA table is the generalized eta-squared measure of effect size, <span class="math inline">\(\eta^2_G\)</span>, preferred to eta-squared or partial eta-squared. See Roger Bakeman (2005) “Recommended effect size statistics for repeated measures designs”, <em>Behavior Research Methods</em>, 37 (3) pages 379–384. There, he points out that the usual <span class="math inline">\(\eta^2\)</span> is the ratio of effect to total variance:</p>
<p><span class="math display">\[\eta^2=\frac{SS_{\text{effect}}}{SS_{\text{total}}}\]</span></p>
<p>where <span class="math inline">\(SS\)</span> is sum of squares. This is similar to the <span class="math inline">\(R^2\)</span> measure typically reported for regression results. The generalized version is alleged to compensate for the deficiencies that <span class="math inline">\(\eta^2\)</span> shares with <span class="math inline">\(R^2\)</span>, mainly that it can be improved by simply adding more predictors. The generalized version looks like this:</p>
<p><span class="math display">\[\eta^2_G=\frac{SS_{\text{effect}}}{\delta \times SS_{\text{effect}} + \sum SS_{\text{measured}}}\]</span></p>
<p>Here <span class="math inline">\(\delta=0\)</span> if the effect involves one or more measured factors and <span class="math inline">\(\delta=1\)</span> if the effect involves only manipulated factors. (Actually it is a little more complicated—here I’m just trying to convey a crude idea that <span class="math inline">\(\eta^2_G\)</span> ranges between 0 and 1 and that, as it approaches 1, the size of the effect is greater. Oddly enough, it is common to report effect sizes as simply small, medium, or large.)</p>
<p>Now compute the corrected degrees of freedom for each corrected effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">match</span>(m<span class="sc">$</span><span class="st">'Sphericity Corrections'</span><span class="sc">$</span>Effect,</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>            m<span class="sc">$</span>ANOVA<span class="sc">$</span>Effect) <span class="co"># positions of within-Ss efx in m$ANOVA</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Sphericity<span class="sc">$</span>GGe.DFn <span class="ot">&lt;-</span> m<span class="sc">$</span>Sphericity<span class="sc">$</span>GGe <span class="sc">*</span> m<span class="sc">$</span>ANOVA<span class="sc">$</span>DFn[pos] <span class="co"># Greenhouse-Geisser</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Sphericity<span class="sc">$</span>GGe.DFd <span class="ot">&lt;-</span> m<span class="sc">$</span>Sphericity<span class="sc">$</span>GGe <span class="sc">*</span> m<span class="sc">$</span>ANOVA<span class="sc">$</span>DFd[pos]</span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Sphericity<span class="sc">$</span>HFe.DFn <span class="ot">&lt;-</span> m<span class="sc">$</span>Sphericity<span class="sc">$</span>HFe <span class="sc">*</span> m<span class="sc">$</span>ANOVA<span class="sc">$</span>DFn[pos] <span class="co"># Huynh-Feldt</span></span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Sphericity<span class="sc">$</span>HFe.DFd <span class="ot">&lt;-</span> m<span class="sc">$</span>Sphericity<span class="sc">$</span>HFe <span class="sc">*</span> m<span class="sc">$</span>ANOVA<span class="sc">$</span>DFd[pos]</span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Sphericity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Effect       GGe        p[GG] p[GG]&lt;.05       HFe        p[HF]
3          Posture 0.7336884 1.558280e-21         * 0.7731517 1.432947e-22
4 Keyboard:Posture 0.7336884 7.800756e-16         * 0.7731517 1.447657e-16
  p[HF]&lt;.05  GGe.DFn  GGe.DFd  HFe.DFn  HFe.DFd
3         * 1.467377 32.28229 1.546303 34.01868
4         * 1.467377 32.28229 1.546303 34.01868</code></pre>
</div>
</div>
<p>The above table shows the Greenhouse Geisser correction to the numerator (GGe.DFn) and denominator (GGe.DFd) degrees of freedom and the resulting <span class="math inline">\(p\)</span>-values (p[GG]). The Greenhouse Geiser epsilon statistic (<span class="math inline">\(\epsilon\)</span>) is shown as GGe. There is an analogous set of measures for the less conservative Huynh-Feldt correction. Note that you could calculate a more conservative <span class="math inline">\(F\)</span>-statistic using the degrees of freedom given even though a corrected <span class="math inline">\(F\)</span>-statistic is not shown for some reason.</p>
</section>
<section id="anova-results-from-aov" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="anova-results-from-aov"><span class="header-section-number">13.7</span> ANOVA results from <code>aov()</code></h2>
<p>The uncorrected results from the <code>ez</code> package are the same as the <code>aov()</code> function in base R, shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">aov</span>(WPM <span class="sc">~</span> Keyboard <span class="sc">*</span> Posture <span class="sc">+</span> <span class="fu">Error</span>(Subject<span class="sc">/</span>Posture),</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>mbltxt) <span class="co"># fit model</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Error: Subject
          Df Sum Sq Mean Sq F value  Pr(&gt;F)    
Keyboard   1  96.35   96.35   124.4 1.6e-10 ***
Residuals 22  17.04    0.77                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Error: Subject:Posture
                 Df Sum Sq Mean Sq F value Pr(&gt;F)    
Posture           2  749.6   374.8   381.5 &lt;2e-16 ***
Keyboard:Posture  2  308.8   154.4   157.2 &lt;2e-16 ***
Residuals        44   43.2     1.0                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="manual-post-hoc-pairwise-comparisons" class="level3" data-number="13.7.1">
<h3 data-number="13.7.1" class="anchored" data-anchor-id="manual-post-hoc-pairwise-comparisons"><span class="header-section-number">13.7.1</span> Manual post hoc pairwise comparisons</h3>
<p>Because the ANOVA table showed a significant interaction effect and the significance of that interaction effect was borne out by the small p[GG] value, it makes sense to conduct post hoc pairwise comparisons. These require reshaping the data to a wide format because the <span class="math inline">\(t\)</span> test expects data in that format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>mbltxt.wide <span class="ot">&lt;-</span> <span class="fu">dcast</span>(mbltxt, Subject <span class="sc">+</span> Keyboard <span class="sc">~</span> Posture,</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">value.var=</span><span class="st">"WPM"</span>)</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mbltxt.wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Subject Keyboard     Sit   Stand    Walk
1       1   iPhone 20.2145 23.7485 20.7960
2       2   iPhone 20.8805 23.2595 19.1305
3       3   iPhone 21.2635 23.4945 20.8545
4       4   iPhone 20.7080 23.9220 18.2575
5       5   iPhone 21.0075 23.4700 17.7105
6       6   iPhone 19.9115 24.2975 19.8550</code></pre>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>sit <span class="ot">&lt;-</span> <span class="fu">t.test</span>(mbltxt.wide<span class="sc">$</span>Sit <span class="sc">~</span> Keyboard, <span class="at">data=</span>mbltxt.wide)</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>std <span class="ot">&lt;-</span> <span class="fu">t.test</span>(mbltxt.wide<span class="sc">$</span>Stand <span class="sc">~</span> Keyboard, <span class="at">data=</span>mbltxt.wide)</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>wlk <span class="ot">&lt;-</span> <span class="fu">t.test</span>(mbltxt.wide<span class="sc">$</span>Walk <span class="sc">~</span> Keyboard, <span class="at">data=</span>mbltxt.wide)</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(sit<span class="sc">$</span>p.value, std<span class="sc">$</span>p.value, wlk<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.842490e-10 4.622384e-08 1.450214e-11</code></pre>
</div>
</div>
<p>The above <span class="math inline">\(p\)</span>-values indicate significant differences for all three.</p>
</section>
<section id="compare-iphone-sit-and-walk" class="level3" data-number="13.7.2">
<h3 data-number="13.7.2" class="anchored" data-anchor-id="compare-iphone-sit-and-walk"><span class="header-section-number">13.7.2</span> Compare iPhone ‘sit’ and ‘walk’</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>tst<span class="ot">&lt;-</span><span class="fu">t.test</span>(mbltxt.wide[mbltxt.wide<span class="sc">$</span>Keyboard <span class="sc">==</span> <span class="st">"iPhone"</span>,]<span class="sc">$</span>Sit,</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>       mbltxt.wide[mbltxt.wide<span class="sc">$</span>Keyboard <span class="sc">==</span> <span class="st">"iPhone"</span>,]<span class="sc">$</span>Walk,</span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired=</span><span class="cn">TRUE</span>)</span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>tst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  mbltxt.wide[mbltxt.wide$Keyboard == "iPhone", ]$Sit and mbltxt.wide[mbltxt.wide$Keyboard == "iPhone", ]$Walk
t = 3.6259, df = 11, p-value = 0.003985
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 0.6772808 2.7695525
sample estimates:
mean difference 
       1.723417 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(mbltxt.wide[mbltxt.wide<span class="sc">$</span>Keyboard <span class="sc">==</span> <span class="st">"iPhone"</span>,]<span class="sc">$</span>Sit,</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>        mbltxt.wide[mbltxt.wide<span class="sc">$</span>Keyboard <span class="sc">==</span> <span class="st">"iPhone"</span>,]<span class="sc">$</span>Walk,</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"iPhone.Sit vs. iPhone.Walk"</span>, <span class="at">ylab=</span><span class="st">"WPM"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="what-if-anova-assumptions-arent-met-nonparametric-approach-to-factorial-anova" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="what-if-anova-assumptions-arent-met-nonparametric-approach-to-factorial-anova"><span class="header-section-number">13.8</span> What if ANOVA assumptions aren’t met? (Nonparametric approach to factorial ANOVA)</h2>
<p>The rest of this section concerns a nonparametric approach developed at the University of Washington.</p>
<section id="the-aligned-rank-transform-art-procedure" class="level3" data-number="13.8.1">
<h3 data-number="13.8.1" class="anchored" data-anchor-id="the-aligned-rank-transform-art-procedure"><span class="header-section-number">13.8.1</span> The Aligned Rank Transform (ART) procedure</h3>
<p><a href="http://depts.washington.edu/aimgroup/proj/art/">http://depts.washington.edu/aimgroup/proj/art/</a></p>
</section>
<section id="explore-the-error_rate-data" class="level3" data-number="13.8.2">
<h3 data-number="13.8.2" class="anchored" data-anchor-id="explore-the-error_rate-data"><span class="header-section-number">13.8.2</span> Explore the Error_Rate data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> mbltxt <span class="sc">|&gt;</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Keyboard,Posture) <span class="sc">|&gt;</span></span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">WPM.median=</span><span class="fu">median</span>(Error_Rate),</span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">WPM.mean=</span><span class="fu">mean</span>(Error_Rate),</span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">WPM.sd=</span><span class="fu">sd</span>(Error_Rate)</span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Keyboard'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   Keyboard [2]
  Keyboard Posture WPM.median WPM.mean  WPM.sd
  &lt;fct&gt;    &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Galaxy   Sit         0.019    0.0194 0.00243
2 Galaxy   Stand       0.0305   0.0307 0.00406
3 Galaxy   Walk        0.0658   0.0632 0.00575
4 iPhone   Sit         0.0205   0.0199 0.00248
5 iPhone   Stand       0.0302   0.0298 0.00258
6 iPhone   Walk        0.04     0.0399 0.00405</code></pre>
</div>
</div>
</section>
<section id="histograms-of-error_rate" class="level3" data-number="13.8.3">
<h3 data-number="13.8.3" class="anchored" data-anchor-id="histograms-of-error_rate"><span class="header-section-number">13.8.3</span> Histograms of Error_Rate</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mbltxt,<span class="fu">aes</span>(Error_Rate,<span class="at">fill=</span>Keyboard)) <span class="sc">+</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.9</span>,<span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>() <span class="sc">+</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>() <span class="sc">+</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Keyboard<span class="sc">~</span>Posture) <span class="sc">+</span></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="box-plots-of-error_rate" class="level3" data-number="13.8.4">
<h3 data-number="13.8.4" class="anchored" data-anchor-id="box-plots-of-error_rate"><span class="header-section-number">13.8.4</span> Box plots of Error_Rate</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mbltxt,<span class="fu">aes</span>(Keyboard,Error_Rate,<span class="at">fill=</span>Keyboard)) <span class="sc">+</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Greens"</span>) <span class="sc">+</span></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Posture) <span class="sc">+</span></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_size=</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interaction-plot-of-error_rate" class="level3" data-number="13.8.5">
<h3 data-number="13.8.5" class="anchored" data-anchor-id="interaction-plot-of-error_rate"><span class="header-section-number">13.8.5</span> Interaction plot of Error_Rate</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mbltxt,</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">interaction.plot</span>(Posture, Keyboard, Error_Rate,</span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(mbltxt<span class="sc">$</span>Error_Rate))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="aligned-rank-transform-on-error_rate" class="level3" data-number="13.8.6">
<h3 data-number="13.8.6" class="anchored" data-anchor-id="aligned-rank-transform-on-error_rate"><span class="header-section-number">13.8.6</span> Aligned Rank Transform on Error_Rate</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ARTool) <span class="co"># for art, artlm</span></span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">art</span>(Error_Rate <span class="sc">~</span> Keyboard <span class="sc">*</span> Posture <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>mbltxt) <span class="co"># uses LMM</span></span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m) <span class="co"># report anova</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance of Aligned Rank Transformed Data

Table Type: Analysis of Deviance Table (Type III Wald F tests with Kenward-Roger df) 
Model: Mixed Effects (lmer)
Response: art(Error_Rate)

                         F Df Df.res     Pr(&gt;F)    
1 Keyboard          89.450  1     22 3.2959e-09 ***
2 Posture          274.704  2     44 &lt; 2.22e-16 ***
3 Keyboard:Posture  78.545  2     44 3.0298e-15 ***
---
Signif. codes:   0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </code></pre>
</div>
</div>
</section>
<section id="examine-the-normality-assumption" class="level3" data-number="13.8.7">
<h3 data-number="13.8.7" class="anchored" data-anchor-id="examine-the-normality-assumption"><span class="header-section-number">13.8.7</span> Examine the normality assumption</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(m)) <span class="co"># normality?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(m)
W = 0.98453, p-value = 0.5227</code></pre>
</div>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m)); <span class="fu">qqline</span>(<span class="fu">residuals</span>(m)) <span class="co"># seems to conform</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interaction-plot" class="level3" data-number="13.8.8">
<h3 data-number="13.8.8" class="anchored" data-anchor-id="interaction-plot"><span class="header-section-number">13.8.8</span> Interaction plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mbltxt,</span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">interaction.plot</span>(Posture, Keyboard, Error_Rate,</span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(mbltxt<span class="sc">$</span>Error_Rate)))) <span class="co"># for convenience</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conduct-post-hoc-pairwise-comparisons-within-each-factor" class="level3" data-number="13.8.9">
<h3 data-number="13.8.9" class="anchored" data-anchor-id="conduct-post-hoc-pairwise-comparisons-within-each-factor"><span class="header-section-number">13.8.9</span> Conduct post hoc pairwise comparisons within each factor</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(emmeans) # instead of lsmeans</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. for backward compatibility, emmeans provides an lsmeans() function</span></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(<span class="fu">artlm</span>(m, <span class="st">"Keyboard"</span>), pairwise <span class="sc">~</span> Keyboard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$lsmeans
 Keyboard lsmean   SE df lower.CL upper.CL
 Galaxy     52.3 2.36 22     47.4     57.2
 iPhone     20.7 2.36 22     15.8     25.6

Results are averaged over the levels of: Posture 
Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 

$contrasts
 contrast        estimate   SE df t.ratio p.value
 Galaxy - iPhone     31.6 3.34 22   9.458  &lt;.0001

Results are averaged over the levels of: Posture 
Degrees-of-freedom method: kenward-roger </code></pre>
</div>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(<span class="fu">artlm</span>(m, <span class="st">"Posture"</span>), pairwise <span class="sc">~</span> Posture)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$lsmeans
 Posture lsmean   SE   df lower.CL upper.CL
 Sit       12.5 1.47 65.9     9.57     15.4
 Stand     36.5 1.47 65.9    33.57     39.4
 Walk      60.5 1.47 65.9    57.57     63.4

Results are averaged over the levels of: Keyboard 
Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 

$contrasts
 contrast     estimate   SE df t.ratio p.value
 Sit - Stand       -24 2.05 44 -11.720  &lt;.0001
 Sit - Walk        -48 2.05 44 -23.439  &lt;.0001
 Stand - Walk      -24 2.05 44 -11.720  &lt;.0001

Results are averaged over the levels of: Keyboard 
Degrees-of-freedom method: kenward-roger 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. Warning: don't do the following in ART!</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="co">#lsmeans(artlm(m, "Keyboard : Posture"), pairwise ~ Keyboard : Posture)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above contrast-testing method is invalid for cross-factor pairwise comparisons in ART. and you can’t just grab aligned-ranks for manual <span class="math inline">\(t\)</span>-tests. instead, use <code>testInteractions()</code> from the <code>phia</code> package to perform “interaction contrasts.” See <code>vignette("art-contrasts")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phia)</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="fu">testInteractions</span>(<span class="fu">artlm</span>(m, <span class="st">"Keyboard:Posture"</span>),</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pairwise=</span><span class="fu">c</span>(<span class="st">"Keyboard"</span>, <span class="st">"Posture"</span>), <span class="at">adjustment=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chisq Test: 
P-value adjustment method: holm
                             Value Df    Chisq Pr(&gt;Chisq)    
Galaxy-iPhone :  Sit-Stand  -5.083  1   0.5584     0.4549    
Galaxy-iPhone :   Sit-Walk -76.250  1 125.6340     &lt;2e-16 ***
Galaxy-iPhone : Stand-Walk -71.167  1 109.4412     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In the output, A-B : C-D is interpreted as a difference-of-differences, i.e., the difference between (A-B | C) and (A-B | D). In words, is the difference between A and B significantly different in condition C from condition D?</p>
</section>
</section>
<section id="experiments-with-interaction-effects" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="experiments-with-interaction-effects"><span class="header-section-number">13.9</span> Experiments with interaction effects</h2>
<p>This section reports on three experiments with possible interaction effects: Avatars, Notes, and Social media value. To work through the questions, you need the three <code>csv</code> files containing the data: <code>avatars.csv</code>, <code>notes.csv</code>, and <code>socialvalue.csv</code>.</p>
<p>These experiments may be between-subjects, within-subjects, or mixed. To be a mixed factorial design, there would have to be at least two independent variables and at least one within-subjects factor and at least one between-subjects factor.</p>
<section id="sentiments-about-avatars-among-males-and-females-interaction-effects" class="level3" data-number="13.9.1">
<h3 data-number="13.9.1" class="anchored" data-anchor-id="sentiments-about-avatars-among-males-and-females-interaction-effects"><span class="header-section-number">13.9.1</span> Sentiments about Avatars among males and females (Interaction effects)</h3>
<p>Thirty males and thirty females were shown an avatar that was either male or female and asked to write a story about that avatar. The number of positive sentiments in the story were summed. What kind of experimental design is this? [Answer: It is a <span class="math inline">\(2\times 2\)</span> between-subjects design with factors for Sex (M, F) and Avatar (M, F).]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>avatars <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/avatars.csv"</span>))</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>avatars<span class="sc">$</span>Subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(avatars<span class="sc">$</span>Subject)</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(avatars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject       Sex               Avatar            Positives    
 1      : 1   Length:60          Length:60          Min.   : 32.0  
 2      : 1   Class :character   Class :character   1st Qu.: 65.0  
 3      : 1   Mode  :character   Mode  :character   Median : 84.0  
 4      : 1                                         Mean   : 85.1  
 5      : 1                                         3rd Qu.:104.2  
 6      : 1                                         Max.   :149.0  
 (Other):54                                                        </code></pre>
</div>
</div>
<p>What’s the average number of positive sentiments for the most positive combination of Sex and Avatar?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(avatars,<span class="sc">~</span>Sex<span class="sc">*</span>Avatar,summarize,</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">Pos.mean=</span><span class="fu">mean</span>(Positives),</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">Pos.sd=</span><span class="fu">sd</span>(Positives))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sex Avatar  Pos.mean   Pos.sd
1 Female Female  63.13333 17.48414
2 Female   Male  85.20000 25.31008
3   Male Female 100.73333 18.72152
4   Male   Male  91.33333 19.66384</code></pre>
</div>
</div>
<p>Create an interaction plot with Sex on the X-Axis and Avatar as the traces. Do the lines cross? Do the same for reversed axes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(avatars,<span class="fu">interaction.plot</span>(Sex,Avatar,Positives,</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(avatars<span class="sc">$</span>Positives))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(avatars,<span class="fu">interaction.plot</span>(Avatar,Sex,Positives,</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(avatars<span class="sc">$</span>Positives))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-91-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Conduct a factorial ANOVA on Positives by Sex and Avatar and report the largest <span class="math inline">\(F\)</span>-statistic. Report which effects are significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">ezANOVA</span>(<span class="at">dv=</span>Positives,<span class="at">between=</span><span class="fu">c</span>(Sex,Avatar),</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">wid=</span>Subject,<span class="at">data=</span>avatars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Converting "Sex" to factor for ANOVA.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Converting "Avatar" to factor for ANOVA.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Coefficient covariances computed by hccm()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Effect DFn DFd         F            p p&lt;.05        ges
1        Sex   1  56 17.041756 0.0001228287     * 0.23331526
2     Avatar   1  56  1.429598 0.2368686270       0.02489305
3 Sex:Avatar   1  56  8.822480 0.0043757511     * 0.13610216</code></pre>
</div>
</div>
<p>Conduct planned pairwise comparisons using independent-samples <span class="math inline">\(t\)</span>-tests. Ask whether females produced different numbers of positive sentiments for male vs female avatars. Then ask whether males did the same. Assume equal variances and use Holm’s sequential Bonferroni procedure to correct for multiple comparisons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">t.test</span>(avatars[avatars<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">"Female"</span> <span class="sc">&amp;</span> avatars<span class="sc">$</span>Avatar<span class="sc">==</span><span class="st">"Male"</span>,]<span class="sc">$</span>Positives,</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>      avatars[avatars<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">"Female"</span> <span class="sc">&amp;</span> avatars<span class="sc">$</span>Avatar<span class="sc">==</span><span class="st">"Female"</span>,]<span class="sc">$</span>Positives,</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  avatars[avatars$Sex == "Female" &amp; avatars$Avatar == "Male", ]$Positives and avatars[avatars$Sex == "Female" &amp; avatars$Avatar == "Female", ]$Positives
t = 2.7782, df = 28, p-value = 0.009647
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
  5.796801 38.336533
sample estimates:
mean of x mean of y 
 85.20000  63.13333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">t.test</span>(avatars[avatars<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> avatars<span class="sc">$</span>Avatar<span class="sc">==</span><span class="st">"Male"</span>,]<span class="sc">$</span>Positives,</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>      avatars[avatars<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> avatars<span class="sc">$</span>Avatar<span class="sc">==</span><span class="st">"Female"</span>,]<span class="sc">$</span>Positives,</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  avatars[avatars$Sex == "Male" &amp; avatars$Avatar == "Male", ]$Positives and avatars[avatars$Sex == "Male" &amp; avatars$Avatar == "Female", ]$Positives
t = -1.3409, df = 28, p-value = 0.1907
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -23.759922   4.959922
sample estimates:
mean of x mean of y 
 91.33333 100.73333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(f<span class="sc">$</span>p.value,m<span class="sc">$</span>p.value),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01929438 0.19073468</code></pre>
</div>
</div>
</section>
<section id="writing-notes-with-builtin-or-addon-apps-on-two-phones-mixed-factorial-design" class="level3" data-number="13.9.2">
<h3 data-number="13.9.2" class="anchored" data-anchor-id="writing-notes-with-builtin-or-addon-apps-on-two-phones-mixed-factorial-design"><span class="header-section-number">13.9.2</span> Writing notes with builtin or addon apps on two phones (mixed factorial design)</h3>
<p>The <code>notes.csv</code> file describes a study in which iPhone and Android owners used a built-in note-taking app then a third-party note-taking app or vice versa. What kind of experimental design is this? (Answer: A <span class="math inline">\(2 \times 2\)</span> mixed factorial design with a between-subjects factor for Phone (iPhone, Android) and a within-subjects factor for Notes (Built-in, Add-on).)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>notes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/notes.csv"</span>))</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>notes<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(notes<span class="sc">$</span>Subject)</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>notes<span class="sc">$</span>Order<span class="ot">&lt;-</span><span class="fu">factor</span>(notes<span class="sc">$</span>Order)</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(notes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject      Phone              Notes           Order      Words      
 1      : 2   Length:40          Length:40          1:20   Min.   :259.0  
 2      : 2   Class :character   Class :character   2:20   1st Qu.:421.8  
 3      : 2   Mode  :character   Mode  :character          Median :457.0  
 4      : 2                                                Mean   :459.2  
 5      : 2                                                3rd Qu.:518.5  
 6      : 2                                                Max.   :598.0  
 (Other):28                                                               </code></pre>
</div>
</div>
<p>What’s the average number of words recorded for the most heavily used combination of Phone and Notes?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(notes, <span class="sc">~</span>Phone<span class="sc">*</span>Notes,summarize,</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">Words.mean=</span><span class="fu">mean</span>(Words),<span class="at">Words.sd=</span><span class="fu">sd</span>(Words))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Phone    Notes Words.mean Words.sd
1 Android   Add-on      388.1 42.38828
2 Android Built-in      410.9 77.49043
3  iPhone   Add-on      504.2 47.29529
4  iPhone Built-in      533.7 48.04176</code></pre>
</div>
</div>
<p>Create an interaction plot with Phone on the X-Axis and Notes as the traces. Do the lines cross? Do the same for reversed axes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(notes,<span class="fu">interaction.plot</span>(Phone,Notes,Words,</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(notes<span class="sc">$</span>Words))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(notes,<span class="fu">interaction.plot</span>(Notes,Phone,Words,</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(notes<span class="sc">$</span>Words))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-96-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Test for an order effect in the presentation of order of the Notes factor. Report the <span class="math inline">\(p\)</span>-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">ezANOVA</span>(<span class="at">dv=</span>Words,<span class="at">between=</span>Phone,<span class="at">within=</span>Order,<span class="at">wid=</span>Subject,<span class="at">data=</span>notes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Converting "Phone" to factor for ANOVA.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Effect DFn DFd          F            p p&lt;.05        ges
2       Phone   1  18 43.5625695 3.375888e-06     * 0.56875437
3       Order   1  18  0.5486763 4.684126e-01       0.01368098
4 Phone:Order   1  18  3.0643695 9.705122e-02       0.07189858</code></pre>
</div>
</div>
<p>Conduct a factorial ANOVA on Words by Phone and Notes. Report the largest <span class="math inline">\(F\)</span>-statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">ezANOVA</span>(<span class="at">dv=</span>Words,<span class="at">between=</span>Phone,<span class="at">within=</span>Notes,<span class="at">wid=</span>Subject,<span class="at">data=</span>notes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Converting "Notes" to factor for ANOVA.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Converting "Phone" to factor for ANOVA.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Effect DFn DFd           F            p p&lt;.05         ges
2       Phone   1  18 43.56256949 3.375888e-06     * 0.562185697
3       Notes   1  18  2.35976941 1.418921e-01       0.057972811
4 Phone:Notes   1  18  0.03872717 8.461951e-01       0.001008948</code></pre>
</div>
</div>
<p>Conduct paired-samples <span class="math inline">\(t\)</span>-tests to answer two questions. First, did iPhone user enter different numbers of words using the built-in notes app versus the add-on notes app? Second, same for Android. Assume equal variances and use Holm’s sequential Bonferroni procedure to correct for multiple comparisons. Report the lowest adjusted <span class="math inline">\(p\)</span>-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>notes.wide<span class="ot">&lt;-</span><span class="fu">dcast</span>(notes,Subject<span class="sc">+</span>Phone<span class="sc">~</span>Notes,<span class="at">value.var=</span><span class="st">"Words"</span>)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(notes.wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Subject   Phone Add-on Built-in
1       1  iPhone    464      561
2       2 Android    433      428
3       3  iPhone    598      586
4       4 Android    347      448
5       5  iPhone    478      543
6       6 Android    365      445</code></pre>
</div>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span><span class="fu">t.test</span>(notes.wide[notes.wide<span class="sc">$</span>Phone<span class="sc">==</span><span class="st">"iPhone"</span>,]<span class="sc">$</span><span class="st">'Add-on'</span>,</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>      notes.wide[notes.wide<span class="sc">$</span>Phone<span class="sc">==</span><span class="st">"iPhone"</span>,]<span class="sc">$</span><span class="st">'Built-in'</span>,</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  notes.wide[notes.wide$Phone == "iPhone", ]$"Add-on" and notes.wide[notes.wide$Phone == "iPhone", ]$"Built-in"
t = -1.8456, df = 9, p-value = 0.09804
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -65.658758   6.658758
sample estimates:
mean difference 
          -29.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">t.test</span>(notes.wide[notes.wide<span class="sc">$</span>Phone<span class="sc">==</span><span class="st">"Android"</span>,]<span class="sc">$</span><span class="st">'Add-on'</span>,</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>      notes.wide[notes.wide<span class="sc">$</span>Phone<span class="sc">==</span><span class="st">"Android"</span>,]<span class="sc">$</span><span class="st">'Built-in'</span>,</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  notes.wide[notes.wide$Phone == "Android", ]$"Add-on" and notes.wide[notes.wide$Phone == "Android", ]$"Built-in"
t = -0.75847, df = 9, p-value = 0.4676
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -90.80181  45.20181
sample estimates:
mean difference 
          -22.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(i<span class="sc">$</span>p.value,a<span class="sc">$</span>p.value),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1960779 0.4675674</code></pre>
</div>
</div>
</section>
<section id="social-media-value-judged-by-people-after-watching-clips-two-by-two-within-subject-design" class="level3" data-number="13.9.3">
<h3 data-number="13.9.3" class="anchored" data-anchor-id="social-media-value-judged-by-people-after-watching-clips-two-by-two-within-subject-design"><span class="header-section-number">13.9.3</span> Social media value judged by people after watching clips (two-by-two within subject design)</h3>
<p>The file socialvalue.csv describes a study of people viewing a pos or neg film clip then going onto social media and judging the value of the first 100 posts they see. The number of valued posts was recorded. What kind of experimental design is this? [Answer: A <span class="math inline">\(2\times 2\)</span> within-subject design with factors for Clip (positive, negative) and Social (Facebook, Twitter).]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>sv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/socialvalue.csv"</span>))</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>sv<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(sv<span class="sc">$</span>Subject)</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>sv<span class="sc">$</span>Clip<span class="ot">&lt;-</span><span class="fu">factor</span>(sv<span class="sc">$</span>Clip)</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>sv<span class="sc">$</span>Social<span class="ot">&lt;-</span><span class="fu">factor</span>(sv<span class="sc">$</span>Social)</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>sv<span class="sc">$</span>ClipOrder<span class="ot">&lt;-</span><span class="fu">factor</span>(sv<span class="sc">$</span>ClipOrder)</span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a>sv<span class="sc">$</span>SocialOrder<span class="ot">&lt;-</span><span class="fu">factor</span>(sv<span class="sc">$</span>SocialOrder)</span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject         Clip    ClipOrder      Social   SocialOrder     Valued    
 1      : 4   negative:32   1:32      Facebook:32   1:32        Min.   :13.0  
 2      : 4   positive:32   2:32      Twitter :32   2:32        1st Qu.:52.0  
 3      : 4                                                     Median :56.0  
 4      : 4                                                     Mean   :57.3  
 5      : 4                                                     3rd Qu.:67.0  
 6      : 4                                                     Max.   :95.0  
 (Other):40                                                                   </code></pre>
</div>
</div>
<p>What’s the average number of valued posts for the most valued combination of Clip and Social?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(sv, <span class="sc">~</span>Clip<span class="sc">*</span>Social,summarize, <span class="at">Valued.mean=</span><span class="fu">mean</span>(Valued),</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">Valued.sd=</span><span class="fu">sd</span>(Valued))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Clip   Social Valued.mean Valued.sd
1 negative Facebook     46.3125 22.285178
2 negative  Twitter     55.5625  5.032809
3 positive Facebook     68.7500 21.151832
4 positive  Twitter     58.5625  5.656486</code></pre>
</div>
</div>
<p>Create an interaction plot with Social on the <span class="math inline">\(X\)</span>-Axis and Clip as the traces. Do the lines cross? Do the same for reversed axes.</p>
<div class="cell" data-fig.margin="false">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(sv,<span class="fu">interaction.plot</span>(Social,Clip,Valued,</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(sv<span class="sc">$</span>Valued))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(sv,<span class="fu">interaction.plot</span>(Clip,Social,Valued,</span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(sv<span class="sc">$</span>Valued))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-102-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Test for an order effect in the presentation of order of the ClipOrder or SocialOrder factor. Report the <span class="math inline">\(p\)</span>-values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">ezANOVA</span>(<span class="at">dv=</span>Valued,<span class="at">within=</span><span class="fu">c</span>(ClipOrder,SocialOrder),<span class="at">wid=</span>Subject,<span class="at">data=</span>sv)</span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Effect DFn DFd          F         p p&lt;.05          ges
2             ClipOrder   1  15 0.93707354 0.3483818       0.0253831509
3           SocialOrder   1  15 0.81236528 0.3816660       0.0143842018
4 ClipOrder:SocialOrder   1  15 0.01466581 0.9052172       0.0001913088</code></pre>
</div>
</div>
<p>Conduct a factorial ANOVA on Valued by Clip and Social. Report the largest <span class="math inline">\(F\)</span>-statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">ezANOVA</span>(<span class="at">dv=</span>Valued,<span class="at">within=</span><span class="fu">c</span>(Clip,Social),<span class="at">wid=</span>Subject,<span class="at">data=</span>sv)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Effect DFn DFd          F          p p&lt;.05          ges
2        Clip   1  15 6.99533219 0.01837880     * 0.1469889054
3      Social   1  15 0.01466581 0.90521722       0.0002340033
4 Clip:Social   1  15 6.11355984 0.02586779     * 0.0914169000</code></pre>
</div>
</div>
<p>Conduct paired-samples <span class="math inline">\(t\)</span>-tests to answer two questions. First, on Facebook, were the number of valued posts different after watching a positive or negative clip. Second, same on Twitter. Assume equal variances and use Holm’s sequential Bonferroni procedure to correct for multiple comparisons. Report the lowest adjusted <span class="math inline">\(p\)</span>-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>sv.wide<span class="ot">&lt;-</span><span class="fu">dcast</span>(sv,Subject<span class="sc">+</span>Social<span class="sc">~</span>Clip,<span class="at">value.var=</span><span class="st">"Valued"</span>)</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sv.wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Subject   Social negative positive
1       1 Facebook       38       85
2       1  Twitter       52       53
3       2 Facebook       73       25
4       2  Twitter       52       54
5       3 Facebook       25       95
6       3  Twitter       53       70</code></pre>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">t.test</span>(sv.wide[sv.wide<span class="sc">$</span>Social<span class="sc">==</span><span class="st">"Facebook"</span>,]<span class="sc">$</span>positive,</span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>      sv.wide[sv.wide<span class="sc">$</span>Social<span class="sc">==</span><span class="st">"Facebook"</span>,]<span class="sc">$</span>negative,</span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  sv.wide[sv.wide$Social == "Facebook", ]$positive and sv.wide[sv.wide$Social == "Facebook", ]$negative
t = 2.5929, df = 15, p-value = 0.02039
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
  3.993 40.882
sample estimates:
mean difference 
        22.4375 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">t.test</span>(sv.wide[sv.wide<span class="sc">$</span>Social<span class="sc">==</span><span class="st">"Twitter"</span>,]<span class="sc">$</span>positive,</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>      sv.wide[sv.wide<span class="sc">$</span>Social<span class="sc">==</span><span class="st">"Twitter"</span>,]<span class="sc">$</span>negative,</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  sv.wide[sv.wide$Social == "Twitter", ]$positive and sv.wide[sv.wide$Social == "Twitter", ]$negative
t = 1.9926, df = 15, p-value = 0.06482
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.2089939  6.2089939
sample estimates:
mean difference 
              3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(f<span class="sc">$</span>p.value,t<span class="sc">$</span>p.value),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04077153 0.06482275</code></pre>
</div>
</div>
<p>Conduct a nonparametric Aligned Rank Transform Procedure on Valued by Clip and Social.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">art</span>(Valued<span class="sc">~</span>Clip<span class="sc">*</span>Social<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>Subject),<span class="at">data=</span>sv)</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance of Aligned Rank Transformed Data

Table Type: Analysis of Deviance Table (Type III Wald F tests with Kenward-Roger df) 
Model: Mixed Effects (lmer)
Response: art(Valued)

                     F Df Df.res     Pr(&gt;F)    
1 Clip        17.13224  1     45 0.00015089 ***
2 Social       0.49281  1     45 0.48629341    
3 Clip:Social 11.31751  1     45 0.00157736  **
---
Signif. codes:   0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </code></pre>
</div>
</div>
<p>Conduct interaction contrasts to discover whether the difference on Facebook was itself different from the difference on Twitter. Report the <span class="math inline">\(\chi^2\)</span> statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testInteractions</span>(<span class="fu">artlm</span>(m,<span class="st">"Clip:Social"</span>),</span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">pairwise=</span><span class="fu">c</span>(<span class="st">"Clip"</span>,<span class="st">"Social"</span>),<span class="at">adjustment=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Chisq Test: 
P-value adjustment method: holm
                                      Value Df  Chisq Pr(&gt;Chisq)    
negative-positive : Facebook-Twitter -29.25  1 11.318  0.0007678 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="what-if-errors-are-not-normally-distributed-generalized-linear-models" class="level2" data-number="13.10">
<h2 data-number="13.10" class="anchored" data-anchor-id="what-if-errors-are-not-normally-distributed-generalized-linear-models"><span class="header-section-number">13.10</span> What if errors are not normally distributed? (Generalized linear models)</h2>
<p>Here are three examples of generalized linear models. The first is analyzed using nominal logistic regression, the second is analyzed via ordinal logistic regression, and the third is analyzed via Poisson regression.</p>
<p>As Wikipedia tells us, a generalized linear model or GLM is a flexible generalization of ordinary linear regression that allows for response variables with error distribution models other than a normal distribution. There is also something called a <em>general</em> linear model but it is not the same thing as a <em>generalized</em> linear model. It is just the general form of the ordinary linear regression model: <span class="math inline">\(\mathbfit{Y=X\beta+\epsilon}\)</span>.</p>
<p>GLMs that we examine here are good for between-subjects studies so we’ll actually recode one of our fictitious data sets to be between subjects just to have an example to use.</p>
<section id="preferences-among-websites-by-males-and-females-glm-1-nominal-logistic-regression-for-preference-responses" class="level3" data-number="13.10.1">
<h3 data-number="13.10.1" class="anchored" data-anchor-id="preferences-among-websites-by-males-and-females-glm-1-nominal-logistic-regression-for-preference-responses"><span class="header-section-number">13.10.1</span> Preferences among websites by males and females (GLM 1: Nominal logistic regression for preference responses)</h3>
</section>
<section id="multinomial-distribution-with-logit-link-function" class="level3" data-number="13.10.2">
<h3 data-number="13.10.2" class="anchored" data-anchor-id="multinomial-distribution-with-logit-link-function"><span class="header-section-number">13.10.2</span> Multinomial distribution with logit link function</h3>
<p>The <code>prefsABCsex.csv</code> file records preferences among three websites A, B, and C expressed by males and females. The subject number, preference and sex were recorded.</p>
<p>The logit link function is the log odds function, generally <span class="math inline">\(\text{logit}(p)=\ln \frac{p}{1-p}\)</span>, where <span class="math inline">\(p\)</span> is the probability of an event such as choosing website A. The form of the link function is <span class="math inline">\(\mathbfit{X\beta}=\ln\frac{\mu}{1-\mu}\)</span>. This is just the relationship of a matrix of predictors times a vector of parameters <span class="math inline">\(\mathbfit{\beta}\)</span> to the logit of the mean of the distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>prefsABCsex <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/prefsABCsex.csv"</span>))</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prefsABCsex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Subject Pref  Sex  
    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1       1 C     F    
2       2 C     M    
3       3 B     M    
4       4 C     M    
5       5 C     M    
6       6 B     F    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>prefsABCsex<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(prefsABCsex<span class="sc">$</span>Subject)</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>prefsABCsex<span class="sc">$</span>Sex<span class="ot">&lt;-</span><span class="fu">factor</span>(prefsABCsex<span class="sc">$</span>Sex)</span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(prefsABCsex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject       Pref           Sex   
 1      : 1   Length:60          F:29  
 2      : 1   Class :character   M:31  
 3      : 1   Mode  :character         
 4      : 1                            
 5      : 1                            
 6      : 1                            
 (Other):54                            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,],<span class="fu">aes</span>(Pref)) <span class="sc">+</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.25</span>,<span class="at">fill=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">5</span>), <span class="at">col=</span><span class="st">"white"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">18</span>, <span class="at">adj=</span><span class="dv">1</span>,  <span class="at">family=</span><span class="st">"serif"</span>,</span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Males prefer</span><span class="sc">\n</span><span class="st">website C"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" style="width:75.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,],<span class="fu">aes</span>(Pref)) <span class="sc">+</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>() <span class="sc">+</span></span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.25</span>,<span class="at">fill=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">5</span>), <span class="at">col=</span><span class="st">"white"</span>, <span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">18</span>, <span class="at">adj=</span><span class="dv">1</span>,  <span class="at">family=</span><span class="st">"serif"</span>,</span>
<span id="cb406-6"><a href="#cb406-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Females dislike</span><span class="sc">\n</span><span class="st">website A"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-108-2.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>These histograms lead us to suspect that C is preferred by males and that A is disliked by females, but we should still run tests to be convinced that the variability observed is not due to chance.</p>
<p>Analyze Pref by Sex using multinomial logistic regression, aka nominal logistic regression. Here we are testing for whether there is a difference between the sexes regarding their preferences.</p>
<p>The annotation <code>type=3</code> is borrowed from SAS and refers to one of three ways of handling an unbalanced design. This experimental design is unbalanced because there are more males than females being tested. This way of handling the unbalanced design is only valid if there are significant interactions, as hinted by the gross differences between the preceding histograms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># provides multinom()</span></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(car) # provides Anova()</span></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a><span class="co">#. set sum-to-zero contrasts for the Anova call</span></span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(prefsABCsex<span class="sc">$</span>Sex) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">multinom</span>(Pref<span class="sc">~</span>Sex, <span class="at">data=</span>prefsABCsex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  9 (4 variable)
initial  value 65.916737 
iter  10 value 55.099353
iter  10 value 55.099353
final  value 55.099353 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Pref
    LR Chisq Df Pr(&gt;Chisq)  
Sex   7.0744  2    0.02909 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The Analysis of Deviance table tells us that there is a significant main effect for Sex. It does not tell us more detail but motivates pairwise tests to get more detail. If there were no significant effect, pairwise tests would not be warranted.</p>
<p>Pairwise tests tell which of the bins are over or under populated based on the assumption that each bin should contain one third of the observations (hence <code>p=1/3</code>). When making multiple comparisons we would overstate the significance of the differences so we use Holm’s sequential Bonferroni procedure to correct this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>ma<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a>mb<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb411-4"><a href="#cb411-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb411-5"><a href="#cb411-5" aria-hidden="true" tabindex="-1"></a>mc<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"C"</span>),</span>
<span id="cb411-6"><a href="#cb411-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb411-7"><a href="#cb411-7" aria-hidden="true" tabindex="-1"></a><span class="co">#. correct for multiple comparisons</span></span>
<span id="cb411-8"><a href="#cb411-8" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(ma<span class="sc">$</span>p.value, mb<span class="sc">$</span>p.value, mc<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.109473564 0.126622172 0.001296754</code></pre>
</div>
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>fa<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>fb<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>fc<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"C"</span>),</span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(prefsABCsex[prefsABCsex<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span>,]), <span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a><span class="co">#. correct for multiple comparisons</span></span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(fa<span class="sc">$</span>p.value, fb<span class="sc">$</span>p.value, fc<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02703274 0.09447821 0.69396951</code></pre>
</div>
</div>
<p>The preceding tests confirm what we suspected from looking at histograms: males prefer C and females dislike A. We see this by looking at the adjusted <span class="math inline">\(p\)</span>-values, where the first row, third value is significant and the second row, first value is significant.</p>
<p>How would we write this up in a report? We could make the following claim. We tested the main effect for sex and found a significant result, <span class="math inline">\(\chi^2_2=7.1, p&lt;0.05\)</span>. An exact binomial test found the preference among males for website C greater than chance, <span class="math inline">\(p&lt;0.01\)</span>. An exact binomial test found the preference among females against website A greater than chance, <span class="math inline">\(p&lt;0.05\)</span>. No other significant differences were found.</p>
</section>
<section id="judgments-of-perceived-effort-glm-2-ordinal-logistic-regression-for-likert-responses" class="level3" data-number="13.10.3">
<h3 data-number="13.10.3" class="anchored" data-anchor-id="judgments-of-perceived-effort-glm-2-ordinal-logistic-regression-for-likert-responses"><span class="header-section-number">13.10.3</span> Judgments of perceived effort (GLM 2: Ordinal logistic regression for Likert responses)</h3>
</section>
<section id="multinomial-distribution-with-cumulative-logit-link-function" class="level3" data-number="13.10.4">
<h3 data-number="13.10.4" class="anchored" data-anchor-id="multinomial-distribution-with-cumulative-logit-link-function"><span class="header-section-number">13.10.4</span> Multinomial distribution with cumulative logit link function</h3>
<p>In this example, users are either searching, scrolling or using voice to find contacts in a smartphone address book. The time it takes to find a certain number of contacts, the perceived effort, and the number of errors are all recorded. Of interest now is the perceived effort, recorded on a Likert scale. A Likert scale can not be normally distributed because of the restrictions on the ends and is not likely to even look vaguely normal.</p>
<p>The cumulative logit link function is like the logit link function:</p>
<p><span class="math display">\[\text{logit}(P(Y\leqslant j|x))=\ln\frac{P(Y\leqslant j|x)}{1-P(Y\leqslant j|x)} \text{ where }Y=1,2,\ldots,J\]</span></p>
<p>In this case <span class="math inline">\(J\)</span> ranges from 1 to 7.</p>
<p>Read in the data and examine it. We see that it is a within-subjects study but it is a fictitious study anyway so we will recode it as if it were a between-subjects study. Then we will be able to apply the following techniques, which we would have to modify for a within-subjects study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>srchscrlvce <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/srchscrlvce.csv"</span>))</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(srchscrlvce)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Subject Technique Order  Time Errors Effort
    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1       1 Search        1    98      4      5
2       1 Scroll        2   152      0      6
3       2 Search        2    57      2      2
4       2 Scroll        1   148      0      3
5       3 Search        1    86      3      2
6       3 Scroll        2   160      0      4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>srchscrlvce<span class="sc">$</span>Subject<span class="ot">&lt;-</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(srchscrlvce)) <span class="co"># recode as between-subjects</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>srchscrlvce<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(srchscrlvce<span class="sc">$</span>Subject)</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>srchscrlvce<span class="sc">$</span>Technique<span class="ot">&lt;-</span><span class="fu">factor</span>(srchscrlvce<span class="sc">$</span>Technique)</span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a>srchscrlvce<span class="sc">$</span>Order<span class="ot">&lt;-</span><span class="cn">NULL</span> <span class="co"># drop order, n/a for between-subjects</span></span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(srchscrlvce) <span class="co"># verify</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Subject Technique  Time Errors Effort
  &lt;fct&gt;   &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 1       Search       98      4      5
2 2       Scroll      152      0      6
3 3       Search       57      2      2
4 4       Scroll      148      0      3
5 5       Search       86      3      2
6 6       Scroll      160      0      4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(srchscrlvce)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject    Technique       Time           Errors         Effort    
 1      : 1   Scroll:20   Min.   : 49.0   Min.   :0.00   Min.   :1.00  
 2      : 1   Search:20   1st Qu.: 86.0   1st Qu.:1.00   1st Qu.:3.00  
 3      : 1   Voice :20   Median : 97.0   Median :2.00   Median :4.00  
 4      : 1               Mean   :106.2   Mean   :2.75   Mean   :4.15  
 5      : 1               3rd Qu.:128.0   3rd Qu.:4.00   3rd Qu.:5.00  
 6      : 1               Max.   :192.0   Max.   :9.00   Max.   :7.00  
 (Other):54                                                            </code></pre>
</div>
</div>
<p>A good description of Effort is the median and quantiles. Another good description is the mean and standard deviation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrlvce, <span class="sc">~</span> Technique,</span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(data) <span class="fu">summary</span>(data<span class="sc">$</span>Effort))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Min. 1st Qu. Median Mean 3rd Qu. Max.
1    Scroll    1    3.00      4 4.40    6.00    7
2    Search    1    3.00      4 3.60    4.25    5
3     Voice    1    3.75      5 4.45    5.25    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrlvce, <span class="sc">~</span> Technique,</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>       summarize, <span class="at">Effort.mean=</span><span class="fu">mean</span>(Effort), <span class="at">Effort.sd=</span><span class="fu">sd</span>(Effort))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Effort.mean Effort.sd
1    Scroll        4.40  1.698296
2    Search        3.60  1.187656
3     Voice        4.45  1.356272</code></pre>
</div>
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrlvce,<span class="fu">aes</span>(Effort,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">7</span>,<span class="at">alpha=</span><span class="fl">0.8</span>,<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>() <span class="sc">+</span></span>
<span id="cb425-5"><a href="#cb425-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>() <span class="sc">+</span></span>
<span id="cb425-6"><a href="#cb425-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid" style="width:75.0%"></p>
</div>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrlvce,<span class="fu">aes</span>(Technique,Effort,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tufteboxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation: y
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` in the `default_aes` field and elsewhere instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic with geom_segment was deprecated in ggplot2 3.4.0.
ℹ Please use the `linewidth` aesthetic instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-112-2.png" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<p>The boxplots (these are Tufte-style boxplots) are not encouraging. We may not find a significant difference among these three techniques but let us try anyway. We analyze Effort Likert ratings by Technique using ordinal logistic regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(MASS) # provides polr()</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(car) # provides Anova()</span></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>srchscrlvce<span class="sc">$</span>Effort <span class="ot">&lt;-</span> <span class="fu">ordered</span>(srchscrlvce<span class="sc">$</span>Effort)</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="co">#. set sum-to-zero contrasts for the Anova call</span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(srchscrlvce<span class="sc">$</span>Technique) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(Effort <span class="sc">~</span> Technique, <span class="at">data=</span>srchscrlvce, <span class="at">Hess=</span><span class="cn">TRUE</span>) <span class="co"># ordinal logistic</span></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Effort
          LR Chisq Df Pr(&gt;Chisq)
Technique   4.5246  2     0.1041</code></pre>
</div>
</div>
<p>Post hoc pairwise comparisons are NOT justified due to lack of significance but here’s how we would do them, just for completeness. <code>Tukey</code> means to compare all pairs and <code>holm</code> is the adjustment due to the double-counting that overstates the significance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">mcp</span>(<span class="at">Technique=</span><span class="st">"Tukey"</span>)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: polr(formula = Effort ~ Technique, data = srchscrlvce, Hess = TRUE)

Linear Hypotheses:
                      Estimate Std. Error z value Pr(&gt;|z|)
Search - Scroll == 0 -1.016610   0.584614  -1.739    0.191
Voice - Scroll == 0   0.007397   0.587700   0.013    0.990
Voice - Search == 0   1.024007   0.552298   1.854    0.191
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<p>How would we express this in a report? We would simply say that we found no significant differences between the three techniques.</p>
</section>
<section id="counting-errors-in-a-task-glm-3-poisson-regression-for-count-responses" class="level3" data-number="13.10.5">
<h3 data-number="13.10.5" class="anchored" data-anchor-id="counting-errors-in-a-task-glm-3-poisson-regression-for-count-responses"><span class="header-section-number">13.10.5</span> Counting errors in a task (GLM 3: Poisson regression for count responses)</h3>
</section>
<section id="poisson-distribution-with-log-link-function" class="level3" data-number="13.10.6">
<h3 data-number="13.10.6" class="anchored" data-anchor-id="poisson-distribution-with-log-link-function"><span class="header-section-number">13.10.6</span> Poisson distribution with log link function</h3>
<p>Using the same data but now focus on the Errors column instead of effort. Errors likely have a Poisson distribution. The log link function is just <span class="math inline">\(\mathbfit{X\beta}=\ln(\mu)\)</span> rather than the more elaborate logit link function we saw before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrlvce, <span class="sc">~</span> Technique,</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>             <span class="cf">function</span>(data) <span class="fu">summary</span>(data<span class="sc">$</span>Errors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Min. 1st Qu. Median Mean 3rd Qu. Max.
1    Scroll    0    0.00    0.5 0.70    1.00    2
2    Search    1    2.00    2.5 2.50    3.00    4
3     Voice    2    3.75    5.0 5.05    6.25    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(srchscrlvce, <span class="sc">~</span> Technique, summarize,</span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">Errors.mean=</span><span class="fu">mean</span>(Errors), <span class="at">Errors.sd=</span><span class="fu">sd</span>(Errors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Technique Errors.mean Errors.sd
1    Scroll        0.70 0.8013147
2    Search        2.50 1.0513150
3     Voice        5.05 1.9049796</code></pre>
</div>
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrlvce,<span class="fu">aes</span>(Errors,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">9</span>,<span class="at">alpha=</span><span class="fl">0.8</span>,<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_grey</span>() <span class="sc">+</span></span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>() <span class="sc">+</span></span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(srchscrlvce,<span class="fu">aes</span>(Technique,Errors,<span class="at">fill=</span>Technique)) <span class="sc">+</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Greens"</span>) <span class="sc">+</span></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-115-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These boxplots are very encouraging. There appears to be a clear difference between all three of these techniques. Notice that you could draw horizontal lines across the plot without intersecting the boxes. That represents a high degree of separation.</p>
<p>Now verify that these data are Poisson-distributed with a goodness-of-fit test for each technique. If the results are <em>not</em> significant, we expect that the data do not deviate significantly from what we would expect of a Poisson distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(fitdistrplus)</span></span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdist</span>(srchscrlvce[srchscrlvce<span class="sc">$</span>Technique <span class="sc">==</span> <span class="st">"Search"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  1.522231 
Degree of freedom of the Chi-squared distribution:  2 
Chi-squared p-value:  0.4671449 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 1  4.000000   5.745950
&lt;= 2  6.000000   5.130312
&lt;= 3  6.000000   4.275260
&gt; 3   4.000000   4.848477

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   65.61424
Bayesian Information Criterion   66.60997</code></pre>
</div>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdist</span>(srchscrlvce[srchscrlvce<span class="sc">$</span>Technique <span class="sc">==</span> <span class="st">"Scroll"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  0.3816087 
Degree of freedom of the Chi-squared distribution:  1 
Chi-squared p-value:  0.5367435 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 0 10.000000   9.931706
&lt;= 1  6.000000   6.952194
&gt; 1   4.000000   3.116100

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   45.53208
Bayesian Information Criterion   46.52781</code></pre>
</div>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdist</span>(srchscrlvce[srchscrlvce<span class="sc">$</span>Technique <span class="sc">==</span> <span class="st">"Voice"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  0.1611327 
Degree of freedom of the Chi-squared distribution:  3 
Chi-squared p-value:  0.9836055 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 3  5.000000   5.161546
&lt;= 4  4.000000   3.473739
&lt;= 5  3.000000   3.508476
&lt;= 6  3.000000   2.952967
&gt; 6   5.000000   4.903272

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   84.19266
Bayesian Information Criterion   85.18839</code></pre>
</div>
</div>
<p>All three of the above goodness of fit tests tell us that there is no evidence of deviation from a Poisson distribution. Since we are now convinced of the Poisson distribution for each of the three techniques, analyze the errors using Poisson regression.</p>
<p>We’ve been saying “set sum-to-zero contrasts for the Anova call” but what does that mean? Contrasts are linear combinations used in ANOVA. As Wikipedia defines it, a contrast is a linear combination <span class="math inline">\(\sum^t_{i=1}a_i\theta_i\)</span>, where each <span class="math inline">\(\theta_i\)</span> is a statistic and the <span class="math inline">\(a_i\)</span> values sum to zero. Typically, the <span class="math inline">\(a_i\)</span> values are <span class="math inline">\(1\)</span> and <span class="math inline">\(-1\)</span>. A simple contrast represents a difference between means and is used in ANOVA. In R, they are invisible if you use Type I ANOVA, but have to be specified as follows if using a Type III ANOVA. The default <code>anova()</code> function is Type I but we’re using Type III, available from the <code>Anova()</code> function in the <code>car</code> package.</p>
<p>A minor detail is that we don’t really need to use <code>Anova()</code> here instead of <code>anova()</code> because the study is balanced, meaning that it has the same number of observations in each condition. The only reason for using <code>Anova()</code> on this data is that it gives a better-looking output. The <code>anova()</code> function would just display the <span class="math inline">\(\chi^2\)</span> statistic without the associated <span class="math inline">\(p\)</span>-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(srchscrlvce<span class="sc">$</span>Technique) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. family parameter identifies both distribution and link fn</span></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glm</span>(Errors <span class="sc">~</span> Technique, <span class="at">data=</span>srchscrlvce, <span class="at">family=</span>poisson)</span>
<span id="cb446-4"><a href="#cb446-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Errors
          LR Chisq Df Pr(&gt;Chisq)    
Technique    74.93  2  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Because the Analysis of Deviance table shows a significant <span class="math inline">\(\chi^2\)</span> value and corresponding <span class="math inline">\(p\)</span>-value, we are justified to conduct pairwise comparisons among levels of Technique.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(multcomp)</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">mcp</span>(<span class="at">Technique=</span><span class="st">"Tukey"</span>)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: glm(formula = Errors ~ Technique, family = poisson, data = srchscrlvce)

Linear Hypotheses:
                     Estimate Std. Error z value Pr(&gt;|z|)    
Search - Scroll == 0   1.2730     0.3024   4.210 5.11e-05 ***
Voice - Scroll == 0    1.9761     0.2852   6.929 1.27e-11 ***
Voice - Search == 0    0.7031     0.1729   4.066 5.11e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<p>We see from the table that all three differences are significant. We could have guessed this result from glancing at the boxplot above, but it is valuable to have statistical evidence that this is not a chance difference.</p>
</section>
</section>
<section id="more-experiments-without-normally-distributed-errors-more-generalized-linear-models" class="level2" data-number="13.11">
<h2 data-number="13.11" class="anchored" data-anchor-id="more-experiments-without-normally-distributed-errors-more-generalized-linear-models"><span class="header-section-number">13.11</span> More experiments without normally distributed errors (More generalized linear models)</h2>
<section id="preference-between-touchpads-vs-trackballs-by-non-disabled-people-and-males-females" class="level3" data-number="13.11.1">
<h3 data-number="13.11.1" class="anchored" data-anchor-id="preference-between-touchpads-vs-trackballs-by-non-disabled-people-and-males-females"><span class="header-section-number">13.11.1</span> Preference between touchpads vs trackballs by non / disabled people and males / females</h3>
<p>This study examines whether participants of either sex with or without a disability prefer touchpads or trackballs. Start by examining the data and determining how many participants are involved.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a>dps <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/deviceprefssex.csv"</span>))</span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>dps<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dps<span class="sc">$</span>Subject)</span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>dps<span class="sc">$</span>Disability<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dps<span class="sc">$</span>Disability)</span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>dps<span class="sc">$</span>Sex<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dps<span class="sc">$</span>Sex)</span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>dps<span class="sc">$</span>Pref<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dps<span class="sc">$</span>Pref)</span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject   Disability Sex           Pref   
 1      : 1   0:18       F:15   touchpad :21  
 2      : 1   1:12       M:15   trackball: 9  
 3      : 1                                   
 4      : 1                                   
 5      : 1                                   
 6      : 1                                   
 (Other):24                                   </code></pre>
</div>
</div>
<p>Use binomial regression to examine Pref by Disability and Sex. Report the <span class="math inline">\(p\)</span>-value of the interaction of Disability<span class="math inline">\(\times\)</span>Sex.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dps<span class="sc">$</span>Disability) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dps<span class="sc">$</span>Sex) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">glm</span>(Pref <span class="sc">~</span> Disability<span class="sc">*</span>Sex, <span class="at">data=</span>dps, <span class="at">family=</span>binomial)</span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Pref
               LR Chisq Df Pr(&gt;Chisq)   
Disability      10.4437  1   0.001231 **
Sex              2.8269  1   0.092695 . 
Disability:Sex   0.6964  1   0.403997   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Now use multinomial regression for the same task and report the corresponding <span class="math inline">\(p\)</span>-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(nnet)</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dps<span class="sc">$</span>Disability) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(dps<span class="sc">$</span>Sex) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">multinom</span>(Pref<span class="sc">~</span>Disability<span class="sc">*</span>Sex, <span class="at">data=</span>dps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  5 (4 variable)
initial  value 20.794415 
iter  10 value 13.023239
iter  20 value 13.010200
final  value 13.010184 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Pref
               LR Chisq Df Pr(&gt;Chisq)   
Disability      10.4434  1   0.001231 **
Sex              2.8267  1   0.092710 . 
Disability:Sex   0.6961  1   0.404087   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Now conduct post-hoc binomial tests for each Disability<span class="math inline">\(\times\)</span>Sex combination.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>m0<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"0"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"touchpad"</span>),</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nrow</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"0"</span>,]),<span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"1"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"touchpad"</span>),</span>
<span id="cb458-4"><a href="#cb458-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nrow</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"1"</span>,]),<span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb458-5"><a href="#cb458-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-6"><a href="#cb458-6" aria-hidden="true" tabindex="-1"></a>f0<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"0"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"touchpad"</span>),</span>
<span id="cb458-7"><a href="#cb458-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nrow</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"0"</span>,]),<span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb458-8"><a href="#cb458-8" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">binom.test</span>(<span class="fu">sum</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"1"</span>,]<span class="sc">$</span>Pref <span class="sc">==</span> <span class="st">"touchpad"</span>),</span>
<span id="cb458-9"><a href="#cb458-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">nrow</span>(dps[dps<span class="sc">$</span>Sex <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">&amp;</span> dps<span class="sc">$</span>Disability <span class="sc">==</span> <span class="st">"1"</span>,]),<span class="at">p=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb458-10"><a href="#cb458-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-11"><a href="#cb458-11" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(m0<span class="sc">$</span>p.value, m1<span class="sc">$</span>p.value, f0<span class="sc">$</span>p.value,f1<span class="sc">$</span>p.value), <span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0625000 1.0000000 0.1962891 1.0000000</code></pre>
</div>
</div>
</section>
<section id="handwriting-recognition-speed-between-different-tools-and-right-handed-vs-left-handed-people" class="level3" data-number="13.11.2">
<h3 data-number="13.11.2" class="anchored" data-anchor-id="handwriting-recognition-speed-between-different-tools-and-right-handed-vs-left-handed-people"><span class="header-section-number">13.11.2</span> Handwriting recognition speed between different tools and right-handed vs left-handed people</h3>
<p>This study examined three handwriting recognizers, A, B, and C and participants who are either right-handed or left-handed. The response is the number of incorrectly recognized handwritten words out of every 100 handwritten words. Examine the data and tell how many participants were involved.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>hw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/hwreco.csv"</span>))</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>hw<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(hw<span class="sc">$</span>Subject)</span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>hw<span class="sc">$</span>Recognizer<span class="ot">&lt;-</span><span class="fu">factor</span>(hw<span class="sc">$</span>Recognizer)</span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a>hw<span class="sc">$</span>Hand<span class="ot">&lt;-</span><span class="fu">factor</span>(hw<span class="sc">$</span>Hand)</span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject   Recognizer    Hand        Errors     
 1      : 1   A:17       Left :25   Min.   : 1.00  
 2      : 1   B:17       Right:25   1st Qu.: 3.00  
 3      : 1   C:16                  Median : 4.00  
 4      : 1                         Mean   : 4.38  
 5      : 1                         3rd Qu.: 6.00  
 6      : 1                         Max.   :11.00  
 (Other):44                                        </code></pre>
</div>
</div>
<p>Create an interaction plot of Recognizer on the <span class="math inline">\(x\)</span>-axis and Hand as the traces and tell how many times the traces cross.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(hw,<span class="fu">interaction.plot</span>(Recognizer,Hand,Errors,</span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(hw<span class="sc">$</span>Errors))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Test whether the Errors of each Recognizer fit a Poisson distribution. First fit the Poisson distribution using <code>fitdist()</code>, then test the fit using <code>gofstat()</code>. The null hypothesis of this test is that the data do not deviate from a Poisson distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(fitdistrplus)</span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdist</span>(hw[hw<span class="sc">$</span>Recognizer <span class="sc">==</span> <span class="st">"A"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  1.807852 
Degree of freedom of the Chi-squared distribution:  2 
Chi-squared p-value:  0.4049767 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 2  4.000000   3.627277
&lt;= 3  5.000000   3.168895
&lt;= 5  4.000000   6.072436
&gt; 5   4.000000   4.131392

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   75.86792
Bayesian Information Criterion   76.70113</code></pre>
</div>
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdist</span>(hw[hw<span class="sc">$</span>Recognizer <span class="sc">==</span> <span class="st">"B"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb465-2"><a href="#cb465-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb465-3"><a href="#cb465-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  0.9192556 
Degree of freedom of the Chi-squared distribution:  2 
Chi-squared p-value:  0.6315187 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 3  5.000000   3.970124
&lt;= 5  4.000000   5.800601
&lt;= 6  3.000000   2.588830
&gt; 6   5.000000   4.640444

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   78.75600
Bayesian Information Criterion   79.58921</code></pre>
</div>
<div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdist</span>(hw[hw<span class="sc">$</span>Recognizer <span class="sc">==</span> <span class="st">"C"</span>,]<span class="sc">$</span>Errors,</span>
<span id="cb467-2"><a href="#cb467-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"pois"</span>, <span class="at">discrete=</span><span class="cn">TRUE</span>)</span>
<span id="cb467-3"><a href="#cb467-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gofstat</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Chi-squared statistic:  0.3521272 
Degree of freedom of the Chi-squared distribution:  2 
Chi-squared p-value:  0.8385647 
   the p-value may be wrong with some theoretical counts &lt; 5  
Chi-squared table:
     obscounts theocounts
&lt;= 2  5.000000   4.600874
&lt;= 3  4.000000   3.347372
&lt;= 4  3.000000   3.085858
&gt; 4   4.000000   4.965897

Goodness-of-fit criteria
                               1-mle-pois
Akaike's Information Criterion   70.89042
Bayesian Information Criterion   71.66301</code></pre>
</div>
</div>
<p>Now use Poisson regression to examine Errors by Recommender and Hand. Report the <span class="math inline">\(p\)</span>-value for the Recognizer<span class="math inline">\(\times\)</span>Hand interaction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(car)</span></span>
<span id="cb469-2"><a href="#cb469-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(hw<span class="sc">$</span>Recognizer) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb469-3"><a href="#cb469-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(hw<span class="sc">$</span>Hand) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb469-4"><a href="#cb469-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">glm</span>(Errors <span class="sc">~</span> Recognizer<span class="sc">*</span>Hand, <span class="at">data=</span>hw, <span class="at">family=</span>poisson)</span>
<span id="cb469-5"><a href="#cb469-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Errors
                LR Chisq Df Pr(&gt;Chisq)   
Recognizer        4.8768  2   0.087299 . 
Hand              3.1591  1   0.075504 . 
Recognizer:Hand  12.9682  2   0.001528 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Conduct planned comparisons between left and right errors for each recognizer. Using <code>glht()</code> and <code>lsm()</code> will give all comparisons and we only want three so don’t correct for multiple comparisons automatically. That would overcorrect. Instead, extract the three relevant <span class="math inline">\(p\)</span>-values manually and and use <code>p.adjust()</code> to correct for those.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(multcomp) # for glht</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(lsmeans) # for lsm</span></span>
<span id="cb471-3"><a href="#cb471-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">lsm</span>(pairwise <span class="sc">~</span> Recognizer <span class="sc">*</span> Hand)),</span>
<span id="cb471-4"><a href="#cb471-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: glm(formula = Errors ~ Recognizer * Hand, family = poisson, data = hw)

Linear Hypotheses:
                         Estimate Std. Error z value Pr(&gt;|z|)    
A Left - B Left == 0   -8.938e-01  2.611e-01  -3.423 0.000619 ***
A Left - C Left == 0   -2.231e-01  3.000e-01  -0.744 0.456990    
A Left - A Right == 0  -8.183e-01  2.638e-01  -3.102 0.001925 ** 
A Left - B Right == 0  -5.306e-01  2.818e-01  -1.883 0.059702 .  
A Left - C Right == 0  -5.306e-01  2.818e-01  -1.883 0.059702 .  
B Left - C Left == 0    6.707e-01  2.412e-01   2.780 0.005428 ** 
B Left - A Right == 0   7.551e-02  1.944e-01   0.388 0.697704    
B Left - B Right == 0   3.632e-01  2.182e-01   1.665 0.095955 .  
B Left - C Right == 0   3.632e-01  2.182e-01   1.665 0.095955 .  
C Left - A Right == 0  -5.952e-01  2.441e-01  -2.438 0.014779 *  
C Left - B Right == 0  -3.075e-01  2.635e-01  -1.167 0.243171    
C Left - C Right == 0  -3.075e-01  2.635e-01  -1.167 0.243171    
A Right - B Right == 0  2.877e-01  2.214e-01   1.299 0.193822    
A Right - C Right == 0  2.877e-01  2.214e-01   1.299 0.193822    
B Right - C Right == 0  3.331e-16  2.425e-01   0.000 1.000000    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- none method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.001925</span>,<span class="fl">0.095955</span>,<span class="fl">0.243171</span>),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.005775 0.191910 0.243171</code></pre>
</div>
</div>
<p>The above analyses suggest that the error counts were Poisson-distributed. The above analyses suggest that there was a significant Recognizer<span class="math inline">\(\times\)</span>Hand interaction. The above analyses suggest that for recognizer A, there were significantly more errors for right-handed participants than for left-handed participants.</p>
</section>
<section id="ease-of-booking-international-or-domestic-flights-on-three-different-services" class="level3" data-number="13.11.3">
<h3 data-number="13.11.3" class="anchored" data-anchor-id="ease-of-booking-international-or-domestic-flights-on-three-different-services"><span class="header-section-number">13.11.3</span> Ease of booking international or domestic flights on three different services</h3>
<p>This study describes flight bookings using one of three services, Expedia, Orbitz, or Priceline. Each booking was either International or Domestic and the Ease of each interaction was recorded on a 7 point Likert scale where 7 was easiest. Examine the data and determine the number of participants in the study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a>bf <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/bookflights.csv"</span>))</span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a>bf<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(bf<span class="sc">$</span>Subject)</span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a>bf<span class="sc">$</span>International<span class="ot">&lt;-</span><span class="fu">factor</span>(bf<span class="sc">$</span>International)</span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a>bf<span class="sc">$</span>Website<span class="ot">&lt;-</span><span class="fu">factor</span>(bf<span class="sc">$</span>Website)</span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a>bf<span class="sc">$</span>International<span class="ot">&lt;-</span><span class="fu">factor</span>(bf<span class="sc">$</span>International)</span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a>bf<span class="sc">$</span>Ease<span class="ot">&lt;-</span><span class="fu">as.ordered</span>(bf<span class="sc">$</span>Ease)</span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject         Website    International Ease   
 1      :  1   Expedia  :200   0:300         1: 87  
 2      :  1   Orbitz   :200   1:300         2: 58  
 3      :  1   Priceline:200                 3:108  
 4      :  1                                 4:107  
 5      :  1                                 5: 95  
 6      :  1                                 6: 71  
 (Other):594                                 7: 74  </code></pre>
</div>
</div>
<p>Draw an interaction plot with Website on the x-axis and International as the traces. Determine how many times the traces cross.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(bf,<span class="fu">interaction.plot</span>(Website,International,<span class="fu">as.numeric</span>(Ease),</span>
<span id="cb477-3"><a href="#cb477-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="fu">as.numeric</span>(bf<span class="sc">$</span>Ease)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Use ordinal logistic regression to examine Ease by Website and International. Report the <span class="math inline">\(p\)</span>-value of the Website main effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(MASS) # provides polr()</span></span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(car) # provides Anova()</span></span>
<span id="cb478-3"><a href="#cb478-3" aria-hidden="true" tabindex="-1"></a><span class="co">#. set sum-to-zero contrasts for the Anova call</span></span>
<span id="cb478-4"><a href="#cb478-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(bf<span class="sc">$</span>Website) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb478-5"><a href="#cb478-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(bf<span class="sc">$</span>International) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb478-6"><a href="#cb478-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">polr</span>(Ease <span class="sc">~</span> Website<span class="sc">*</span>International, <span class="at">data=</span>bf, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb478-7"><a href="#cb478-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Ease
                      LR Chisq Df Pr(&gt;Chisq)    
Website                  6.811  2    0.03319 *  
International            0.668  1    0.41383    
Website:International   90.590  2    &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Conduct three pairwise comparisons of Ease between domestic and international for each service. Report the largest adjusted <span class="math inline">\(p\)</span>-value. Use the same technique as above where you extracted the relevant unadjusted <span class="math inline">\(p\)</span>-values manually and used <code>p.adjust()</code> to adjust them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.glht</span>(<span class="fu">pairs</span>(<span class="fu">lsmeans</span>(m, pairwise <span class="sc">~</span> Website <span class="sc">*</span> International))),</span>
<span id="cb480-2"><a href="#cb480-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Linear Hypotheses:
                                                         Estimate Std. Error
Expedia International0 - Orbitz International0 == 0       -2.1442     0.2619
Expedia International0 - Priceline International0 == 0    -0.9351     0.2537
Expedia International0 - Expedia International1 == 0      -1.6477     0.2570
Expedia International0 - Orbitz International1 == 0       -0.3217     0.2490
Expedia International0 - Priceline International1 == 0    -0.7563     0.2517
Orbitz International0 - Priceline International0 == 0      1.2091     0.2555
Orbitz International0 - Expedia International1 == 0        0.4965     0.2505
Orbitz International0 - Orbitz International1 == 0         1.8225     0.2571
Orbitz International0 - Priceline International1 == 0      1.3879     0.2546
Priceline International0 - Expedia International1 == 0    -0.7126     0.2518
Priceline International0 - Orbitz International1 == 0      0.6134     0.2497
Priceline International0 - Priceline International1 == 0   0.1789     0.2501
Expedia International1 - Orbitz International1 == 0        1.3260     0.2524
Expedia International1 - Priceline International1 == 0     0.8914     0.2506
Orbitz International1 - Priceline International1 == 0     -0.4345     0.2477
                                                         z value Pr(&gt;|z|)    
Expedia International0 - Orbitz International0 == 0       -8.189 2.22e-16 ***
Expedia International0 - Priceline International0 == 0    -3.686 0.000228 ***
Expedia International0 - Expedia International1 == 0      -6.411 1.44e-10 ***
Expedia International0 - Orbitz International1 == 0       -1.292 0.196380    
Expedia International0 - Priceline International1 == 0    -3.004 0.002663 ** 
Orbitz International0 - Priceline International0 == 0      4.732 2.22e-06 ***
Orbitz International0 - Expedia International1 == 0        1.982 0.047498 *  
Orbitz International0 - Orbitz International1 == 0         7.089 1.35e-12 ***
Orbitz International0 - Priceline International1 == 0      5.452 4.99e-08 ***
Priceline International0 - Expedia International1 == 0    -2.830 0.004659 ** 
Priceline International0 - Orbitz International1 == 0      2.457 0.014023 *  
Priceline International0 - Priceline International1 == 0   0.715 0.474476    
Expedia International1 - Orbitz International1 == 0        5.254 1.49e-07 ***
Expedia International1 - Priceline International1 == 0     3.557 0.000375 ***
Orbitz International1 - Priceline International1 == 0     -1.754 0.079408 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- none method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">1.44e-10</span>,<span class="fl">1.35e-12</span>,<span class="fl">0.474476</span>),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.88000e-10 4.05000e-12 4.74476e-01</code></pre>
</div>
</div>
<p>The above analyses indicate a significant main effect of Website on Ease. The above analyses indicate a significant interaction between Website and International. Expedia was perceived as significantly easier for booking international flights than domestic flights. Orbitz, on the other hand, was perceived as significantly easier for booking domestic flights than international flights.</p>
</section>
</section>
<section id="same-person-using-different-tools-within-subjects-studies" class="level2" data-number="13.12">
<h2 data-number="13.12" class="anchored" data-anchor-id="same-person-using-different-tools-within-subjects-studies"><span class="header-section-number">13.12</span> Same person using different tools (Within subjects studies)</h2>
<section id="two-search-engines-compared" class="level3" data-number="13.12.1">
<h3 data-number="13.12.1" class="anchored" data-anchor-id="two-search-engines-compared"><span class="header-section-number">13.12.1</span> Two search engines compared</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/websearch2.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How many subjects took part in this study?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>ws<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(ws<span class="sc">$</span>Subject)</span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a>ws<span class="sc">$</span>Engine<span class="ot">&lt;-</span><span class="fu">factor</span>(ws<span class="sc">$</span>Engine)</span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject      Engine       Order        Searches         Effort    
 1      : 2   Bing  :30   Min.   :1.0   Min.   : 89.0   Min.   :1.00  
 2      : 2   Google:30   1st Qu.:1.0   1st Qu.:135.8   1st Qu.:2.00  
 3      : 2               Median :1.5   Median :156.5   Median :4.00  
 4      : 2               Mean   :1.5   Mean   :156.9   Mean   :3.90  
 5      : 2               3rd Qu.:2.0   3rd Qu.:175.2   3rd Qu.:5.25  
 6      : 2               Max.   :2.0   Max.   :241.0   Max.   :7.00  
 (Other):48                                                           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(ws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Subject Engine Order Searches Effort
  &lt;fct&gt;   &lt;fct&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 28      Google     2      131      4
2 28      Bing       1      192      4
3 29      Google     1      162      5
4 29      Bing       2      163      3
5 30      Google     2      146      5
6 30      Bing       1      137      2</code></pre>
</div>
</div>
<p>Thirty subjects participated.</p>
<p>What is the average number of searches for the engine with the largest average number of searches?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>ws <span class="sc">|&gt;</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Engine) <span class="sc">|&gt;</span></span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg=</span><span class="fu">mean</span>(Searches))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  Engine   avg
  &lt;fct&gt;  &lt;dbl&gt;
1 Bing    166.
2 Google  148.</code></pre>
</div>
</div>
<p>Bing had 166 searches on average.</p>
<p>What is the <span class="math inline">\(p\)</span>-value (four digits) from a paired-samples <span class="math inline">\(t\)</span>-test of order effect?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(reshape2)</span></span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>ws.wide.order <span class="ot">&lt;-</span> <span class="fu">dcast</span>(ws,Subject <span class="sc">~</span> Order, <span class="at">value.var=</span><span class="st">"Searches"</span>)</span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>tst<span class="ot">&lt;-</span><span class="fu">t.test</span>(ws.wide.order<span class="sc">$</span><span class="st">"1"</span>,ws.wide.order<span class="sc">$</span><span class="st">"2"</span>,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a>tst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  ws.wide.order$"1" and ws.wide.order$"2"
t = 0.34273, df = 29, p-value = 0.7343
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -13.57786  19.04453
sample estimates:
mean difference 
       2.733333 </code></pre>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-value is 0.7343</p>
<p>What is the <span class="math inline">\(t\)</span>-statistic (two digits) for a paired-samples <span class="math inline">\(t\)</span>-test of Searches by Engine?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(reshape2)</span></span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a>ws.wide.engine <span class="ot">&lt;-</span> <span class="fu">dcast</span>(ws,Subject <span class="sc">~</span> Engine, <span class="at">value.var=</span><span class="st">"Searches"</span>)</span>
<span id="cb493-3"><a href="#cb493-3" aria-hidden="true" tabindex="-1"></a>tst<span class="ot">&lt;-</span><span class="fu">t.test</span>(ws.wide.engine<span class="sc">$</span><span class="st">"Bing"</span>,ws.wide.engine<span class="sc">$</span><span class="st">"Google"</span>,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb493-4"><a href="#cb493-4" aria-hidden="true" tabindex="-1"></a>tst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  ws.wide.engine$Bing and ws.wide.engine$Google
t = 2.5021, df = 29, p-value = 0.01824
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
  3.310917 32.955750
sample estimates:
mean difference 
       18.13333 </code></pre>
</div>
</div>
<p>The <span class="math inline">\(t\)</span>-statistic is 2.50.</p>
<p>What is the <span class="math inline">\(p\)</span>-value (four digits) from a Wilcoxon signed-rank test on Effort?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(coin)</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcoxsign_test</span>(Effort<span class="sc">~</span>Engine<span class="sc">|</span>Subject,<span class="at">data=</span>ws,<span class="at">distribution=</span><span class="st">"exact"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon-Pratt Signed-Rank Test

data:  y by x (pos, neg) 
     stratified by block
Z = 0.68343, p-value = 0.5016
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
<p>The <span class="math inline">\(p\)</span>-value is 0.5016.</p>
</section>
<section id="same-but-with-three-search-engines" class="level3" data-number="13.12.2">
<h3 data-number="13.12.2" class="anchored" data-anchor-id="same-but-with-three-search-engines"><span class="header-section-number">13.12.2</span> Same but with three search engines</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a>ws3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/websearch3.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How many subjects took part in this study? ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ws3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject        Engine              Order      Searches         Effort     
 Min.   : 1.0   Length:90          Min.   :1   Min.   : 92.0   Min.   :1.000  
 1st Qu.: 8.0   Class :character   1st Qu.:1   1st Qu.:139.0   1st Qu.:3.000  
 Median :15.5   Mode  :character   Median :2   Median :161.0   Median :4.000  
 Mean   :15.5                      Mean   :2   Mean   :161.6   Mean   :4.256  
 3rd Qu.:23.0                      3rd Qu.:3   3rd Qu.:181.8   3rd Qu.:6.000  
 Max.   :30.0                      Max.   :3   Max.   :236.0   Max.   :7.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>ws3<span class="sc">$</span>Subject<span class="ot">&lt;-</span><span class="fu">as.factor</span>(ws3<span class="sc">$</span>Subject)</span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a>ws3<span class="sc">$</span>Order<span class="ot">&lt;-</span><span class="fu">as.factor</span>(ws3<span class="sc">$</span>Order)</span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a>ws3<span class="sc">$</span>Engine<span class="ot">&lt;-</span><span class="fu">as.factor</span>(ws3<span class="sc">$</span>Engine)</span>
<span id="cb500-4"><a href="#cb500-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(ws3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Subject Engine Order Searches Effort
  &lt;fct&gt;   &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 29      Google 3          157      5
2 29      Bing   1          195      4
3 29      Yahoo  2          182      5
4 30      Google 3          152      1
5 30      Bing   2          188      7
6 30      Yahoo  1          131      3</code></pre>
</div>
<p>:::</p>
<p>Again, thirty subjects participated.</p>
<p>What is the average number of searches for the engine with the largest average number of searches?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(ws3,<span class="sc">~</span> Engine,summarize, <span class="at">Mean=</span><span class="fu">mean</span>(Searches))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Engine     Mean
1   Bing 159.8333
2 Google 152.6667
3  Yahoo 172.4000</code></pre>
</div>
</div>
<p>Yahoo required 172.40 searches on average.</p>
<p>Find Mauchly’s <span class="math inline">\(W\)</span> criterion (four digits) as a value of violation of sphericity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(ez)</span></span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">ezANOVA</span>(<span class="at">dv=</span>Searches, <span class="at">within=</span>Order, <span class="at">wid=</span>Subject, <span class="at">data=</span>ws3)</span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Mauchly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Effect         W         p p&lt;.05
2  Order 0.9416469 0.4309561      </code></pre>
</div>
</div>
<p>Mauchly’s <span class="math inline">\(W = 0.9416\)</span>, indicating that there is no violation of sphericity.</p>
<p>Conduct the appropriate ANOVA and give the <span class="math inline">\(p\)</span>-value of the <span class="math inline">\(F\)</span>-test (four digits).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Effect DFn DFd        F        p p&lt;.05       ges
2  Order   2  58 1.159359 0.320849       0.0278629</code></pre>
</div>
</div>
<p>The relevant <span class="math inline">\(p\)</span>-value is 0.3208.</p>
<p>Conduct a repeated measures ANOVA on Searches by Engine and give the Mauchly’s <span class="math inline">\(W\)</span> criterion (four digits).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(ez)</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">ezANOVA</span>(<span class="at">dv=</span>Searches, <span class="at">within=</span>Engine, <span class="at">wid=</span>Subject, <span class="at">data=</span>ws3)</span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>Mauchly</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Effect         W         p p&lt;.05
2 Engine 0.9420316 0.4334278      </code></pre>
</div>
</div>
<p>Mauchly’s <span class="math inline">\(W = 0.9420\)</span>, indicating that there is no violation of sphericity.</p>
<p>Conduct the appropriate ANOVA and give the <span class="math inline">\(p\)</span>-value of the <span class="math inline">\(F\)</span>-test (four digits).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>m<span class="sc">$</span>ANOVA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Effect DFn DFd        F          p p&lt;.05        ges
2 Engine   2  58 2.856182 0.06560302       0.06498641</code></pre>
</div>
</div>
<p>The relevant <span class="math inline">\(p\)</span>-value is 0.0656.</p>
<p>Conduct post-hoc paired sample <span class="math inline">\(t\)</span>-tests among levels of Engine, assuming equal variances and using “holm” to correct for multiple comparisons. What is the smallest <span class="math inline">\(p\)</span>-value (four digits)? ::: {.cell}</p>
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(reshape2)</span></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a>ws3.wide.engine <span class="ot">&lt;-</span> <span class="fu">dcast</span>(ws3,Subject<span class="sc">~</span>Engine,<span class="at">value.var=</span><span class="st">"Searches"</span>)</span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a>bi.go<span class="ot">&lt;-</span><span class="fu">t.test</span>(ws3.wide.engine<span class="sc">$</span>Bing,ws3.wide.engine<span class="sc">$</span>Google,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a>bi.ya<span class="ot">&lt;-</span><span class="fu">t.test</span>(ws3.wide.engine<span class="sc">$</span>Bing,ws3.wide.engine<span class="sc">$</span>Yahoo,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a>go.ya<span class="ot">&lt;-</span><span class="fu">t.test</span>(ws3.wide.engine<span class="sc">$</span>Google,ws3.wide.engine<span class="sc">$</span>Yahoo,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(bi.go<span class="sc">$</span>p.value,bi.ya<span class="sc">$</span>p.value,go.ya<span class="sc">$</span>p.value),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.37497103 0.37497103 0.05066714</code></pre>
</div>
<p>::: The smallest <span class="math inline">\(p\)</span>-value is 0.0507.</p>
<p>Conduct a Friedman (nonparametric) test on Effort. Find the <span class="math inline">\(\chi^2\)</span> statistic (four digits).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(coin)</span></span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman_test</span>(Effort<span class="sc">~</span>Engine<span class="sc">|</span>Subject,<span class="at">data=</span>ws3,<span class="at">distribution=</span><span class="st">"asymptotic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Friedman Test

data:  Effort by
     Engine (Bing, Google, Yahoo) 
     stratified by Subject
chi-squared = 8.0182, df = 2, p-value = 0.01815</code></pre>
</div>
</div>
<p><span class="math inline">\(\chi^2=8.0182\)</span></p>
<p>Conduct post hoc pairwise Wilcoxon signed-rank tests on Effort by Engine with “holm” for multiple comparison correction. Give the smallest <span class="math inline">\(p\)</span>-value (four digits).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(reshape2)</span></span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a>ws3.wide.effort <span class="ot">&lt;-</span> <span class="fu">dcast</span>(ws3,Subject<span class="sc">~</span>Engine,<span class="at">value.var=</span><span class="st">"Effort"</span>)</span>
<span id="cb516-3"><a href="#cb516-3" aria-hidden="true" tabindex="-1"></a>bi.go<span class="ot">&lt;-</span><span class="fu">wilcox.test</span>(ws3.wide.effort<span class="sc">$</span>Bing,ws3.wide.effort<span class="sc">$</span>Google,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb516-4"><a href="#cb516-4" aria-hidden="true" tabindex="-1"></a>bi.ya<span class="ot">&lt;-</span><span class="fu">wilcox.test</span>(ws3.wide.effort<span class="sc">$</span>Bing,ws3.wide.effort<span class="sc">$</span>Yahoo,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb516-5"><a href="#cb516-5" aria-hidden="true" tabindex="-1"></a>go.ya<span class="ot">&lt;-</span><span class="fu">wilcox.test</span>(ws3.wide.effort<span class="sc">$</span>Google,ws3.wide.effort<span class="sc">$</span>Yahoo,<span class="at">paired=</span><span class="cn">TRUE</span>,<span class="at">exact=</span><span class="cn">FALSE</span>)</span>
<span id="cb516-6"><a href="#cb516-6" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(bi.go<span class="sc">$</span>p.value,bi.ya<span class="sc">$</span>p.value,go.ya<span class="sc">$</span>p.value),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.69319567 0.03085190 0.04533852</code></pre>
</div>
</div>
<p>The smallest <span class="math inline">\(p\)</span>-value is 0.0309.</p>
</section>
</section>
<section id="experiments-with-people-in-groups-doing-tasks-with-different-tools-mixed-models" class="level2" data-number="13.13">
<h2 data-number="13.13" class="anchored" data-anchor-id="experiments-with-people-in-groups-doing-tasks-with-different-tools-mixed-models"><span class="header-section-number">13.13</span> Experiments with people in groups doing tasks with different tools (Mixed models)</h2>
<p>Mixed models contain both fixed effects and random effects. Following are linear mixed models and generalized linear mixed models examples. Recall that linear models have normally distributed residuals while generalized linear models may have residuals following other distributions.</p>
<section id="searching-to-find-facts-and-effort-of-searching-a-linear-mixed-model" class="level3" data-number="13.13.1">
<h3 data-number="13.13.1" class="anchored" data-anchor-id="searching-to-find-facts-and-effort-of-searching-a-linear-mixed-model"><span class="header-section-number">13.13.1</span> Searching to find facts and effort of searching (A linear mixed model)</h3>
<p>Load <code>websearch3.csv</code>. It describes a test of the number of searches required to find out a hundred facts and the perceived effort of searching. How many subjects participated?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>ws <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/websearch3.csv"</span>))</span>
<span id="cb518-2"><a href="#cb518-2" aria-hidden="true" tabindex="-1"></a>ws<span class="ot">&lt;-</span><span class="fu">within</span>(ws,Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(Subject))</span>
<span id="cb518-3"><a href="#cb518-3" aria-hidden="true" tabindex="-1"></a>ws<span class="ot">&lt;-</span><span class="fu">within</span>(ws,Order<span class="ot">&lt;-</span><span class="fu">factor</span>(Order))</span>
<span id="cb518-4"><a href="#cb518-4" aria-hidden="true" tabindex="-1"></a>ws<span class="ot">&lt;-</span><span class="fu">within</span>(ws,Engine<span class="ot">&lt;-</span><span class="fu">factor</span>(Engine))</span>
<span id="cb518-5"><a href="#cb518-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(ws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Subject Engine Order Searches Effort
  &lt;fct&gt;   &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 29      Google 3          157      5
2 29      Bing   1          195      4
3 29      Yahoo  2          182      5
4 30      Google 3          152      1
5 30      Bing   2          188      7
6 30      Yahoo  1          131      3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject      Engine   Order     Searches         Effort     
 1      : 3   Bing  :30   1:30   Min.   : 92.0   Min.   :1.000  
 2      : 3   Google:30   2:30   1st Qu.:139.0   1st Qu.:3.000  
 3      : 3   Yahoo :30   3:30   Median :161.0   Median :4.000  
 4      : 3                      Mean   :161.6   Mean   :4.256  
 5      : 3                      3rd Qu.:181.8   3rd Qu.:6.000  
 6      : 3                      Max.   :236.0   Max.   :7.000  
 (Other):72                                                     </code></pre>
</div>
</div>
<p>What was the average number of Search instances for each Engine?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a>ws <span class="sc">|&gt;</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Engine) <span class="sc">|&gt;</span></span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median=</span><span class="fu">median</span>(Searches),</span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">avg=</span><span class="fu">mean</span>(Searches),</span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">sd=</span><span class="fu">sd</span>(Searches))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Engine median   avg    sd
  &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Bing     162.  160.  30.6
2 Google   152   153.  24.6
3 Yahoo    170.  172.  37.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a>plyr<span class="sc">::</span><span class="fu">ddply</span>(ws,<span class="sc">~</span>Engine,summarize,<span class="at">avg=</span><span class="fu">mean</span>(Searches))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Engine      avg
1   Bing 159.8333
2 Google 152.6667
3  Yahoo 172.4000</code></pre>
</div>
</div>
<p>Conduct a linear mixed model analysis of variance on Search by Engine and report the <span class="math inline">\(p\)</span>-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># for lmer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lme4'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:RVAideMemoire':

    dummy</code></pre>
</div>
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lmerTest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(car) # for Anova</span></span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(ws<span class="sc">$</span>Engine) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Searches <span class="sc">~</span> Engine <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>ws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>, <span class="at">test.statistic=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald F tests with Kenward-Roger df)

Response: Searches
                    F Df Df.res  Pr(&gt;F)    
(Intercept) 2374.8089  1     29 &lt; 2e-16 ***
Engine         3.0234  2     58 0.05636 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Conduct simultaneous pairwise comparisons among all levels of Engine, despite the previous <span class="math inline">\(p\)</span>-value. Report the adjusted(by Holm’s sequential Bonferroni procedure) <span class="math inline">\(p\)</span>-values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(multcomp)</span></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">mcp</span>(<span class="at">Engine=</span><span class="st">"Tukey"</span>)),</span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>)) <span class="co"># Tukey means compare all pairs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lmer(formula = Searches ~ Engine + (1 | Subject), data = ws)

Linear Hypotheses:
                    Estimate Std. Error z value Pr(&gt;|z|)  
Google - Bing == 0    -7.167      8.124  -0.882   0.3777  
Yahoo - Bing == 0     12.567      8.124   1.547   0.2438  
Yahoo - Google == 0   19.733      8.124   2.429   0.0454 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
</section>
<section id="people-judging-social-media-posts-after-viewing-clips-another-linear-mixed-model" class="level3" data-number="13.13.2">
<h3 data-number="13.13.2" class="anchored" data-anchor-id="people-judging-social-media-posts-after-viewing-clips-another-linear-mixed-model"><span class="header-section-number">13.13.2</span> People judging social media posts after viewing clips (Another linear mixed model)</h3>
<p>The file <code>socialvalue.csv</code> describes a study of people viewing a positive or negative film clip then going onto social media and judging the value (1 or 0) of the first hundred posts they see. The number of valued posts was recorded. Load the file and tell how many participated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a>sv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/socialvalue.csv"</span>))</span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a>sv<span class="ot">&lt;-</span><span class="fu">within</span>(sv,Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(Subject))</span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a>sv<span class="ot">&lt;-</span><span class="fu">within</span>(sv,Clip<span class="ot">&lt;-</span><span class="fu">factor</span>(Clip))</span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a>sv<span class="ot">&lt;-</span><span class="fu">within</span>(sv,Social<span class="ot">&lt;-</span><span class="fu">factor</span>(Social))</span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true" tabindex="-1"></a>sv<span class="ot">&lt;-</span><span class="fu">within</span>(sv,ClipOrder<span class="ot">&lt;-</span><span class="fu">factor</span>(ClipOrder))</span>
<span id="cb542-6"><a href="#cb542-6" aria-hidden="true" tabindex="-1"></a>sv<span class="ot">&lt;-</span><span class="fu">within</span>(sv,SocialOrder<span class="ot">&lt;-</span><span class="fu">factor</span>(SocialOrder))</span>
<span id="cb542-7"><a href="#cb542-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject         Clip    ClipOrder      Social   SocialOrder     Valued    
 1      : 4   negative:32   1:32      Facebook:32   1:32        Min.   :13.0  
 2      : 4   positive:32   2:32      Twitter :32   2:32        1st Qu.:52.0  
 3      : 4                                                     Median :56.0  
 4      : 4                                                     Mean   :57.3  
 5      : 4                                                     3rd Qu.:67.0  
 6      : 4                                                     Max.   :95.0  
 (Other):40                                                                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(sv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Subject Clip     ClipOrder Social   SocialOrder Valued
  &lt;fct&gt;   &lt;fct&gt;    &lt;fct&gt;     &lt;fct&gt;    &lt;fct&gt;        &lt;dbl&gt;
1 15      negative 2         Facebook 2               60
2 15      negative 2         Twitter  1               62
3 16      positive 2         Facebook 2               34
4 16      positive 2         Twitter  1               61
5 16      negative 1         Facebook 1               59
6 16      negative 1         Twitter  2               70</code></pre>
</div>
</div>
<p>How many more posts were valued on Facebook than on Twitter after seeing a positive clip?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a>out<span class="ot">&lt;-</span>plyr<span class="sc">::</span><span class="fu">ddply</span>(sv,<span class="sc">~</span>Clip<span class="sc">*</span>Social,summarize,<span class="at">ValuedAvg=</span><span class="fu">mean</span>(Valued))</span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Clip   Social ValuedAvg
1 negative Facebook   46.3125
2 negative  Twitter   55.5625
3 positive Facebook   68.7500
4 positive  Twitter   58.5625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fl">68.75-58.5625</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.1875</code></pre>
</div>
</div>
<p>Conduct a linear mixed model analysis of variance on Valued by Social and Clip. Report the <span class="math inline">\(p\)</span>-value of the interaction effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb550"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(lme4) # for lmer</span></span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(lmerTest)</span></span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(car) # for Anova</span></span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(sv<span class="sc">$</span>Social) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb550-5"><a href="#cb550-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(sv<span class="sc">$</span>Clip) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb550-6"><a href="#cb550-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Valued <span class="sc">~</span> (Social <span class="sc">*</span> Clip) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>sv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb552"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>, <span class="at">test.statistic=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald F tests with Kenward-Roger df)

Response: Valued
                   F Df Df.res    Pr(&gt;F)    
(Intercept) 839.2940  1     15 1.392e-14 ***
Social        0.0140  1     45  0.906195    
Clip         10.3391  1     45  0.002413 ** 
Social:Clip   6.0369  1     45  0.017930 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Conduct planned pairwise comparisons of how the clips may have influenced judgments about the value of social media. Report whether the number of valued posts differed after seeing a positive versus negative clip.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(multcomp) # for glht</span></span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(emmeans) # for lsm</span></span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">lsm</span>(pairwise <span class="sc">~</span> Social <span class="sc">*</span> Clip)),<span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: df set to 45</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lmer(formula = Valued ~ (Social * Clip) + (1 | Subject), data = sv)

Linear Hypotheses:
                                           Estimate Std. Error t value Pr(&gt;|t|)
Facebook negative - Twitter negative == 0    -9.250      5.594  -1.654 0.105175
Facebook negative - Facebook positive == 0  -22.438      5.594  -4.011 0.000225
Facebook negative - Twitter positive == 0   -12.250      5.594  -2.190 0.033759
Twitter negative - Facebook positive == 0   -13.188      5.594  -2.357 0.022810
Twitter negative - Twitter positive == 0     -3.000      5.594  -0.536 0.594397
Facebook positive - Twitter positive == 0    10.188      5.594   1.821 0.075234
                                              
Facebook negative - Twitter negative == 0     
Facebook negative - Facebook positive == 0 ***
Facebook negative - Twitter positive == 0  *  
Twitter negative - Facebook positive == 0  *  
Twitter negative - Twitter positive == 0      
Facebook positive - Twitter positive == 0  .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- none method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb557"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.00017</span>,<span class="fl">0.59374</span>),<span class="at">method=</span><span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.00034 0.59374</code></pre>
</div>
</div>
</section>
<section id="people-watching-teasers-in-different-orders-and-judging-yet-another-linear-mixed-model" class="level3" data-number="13.13.3">
<h3 data-number="13.13.3" class="anchored" data-anchor-id="people-watching-teasers-in-different-orders-and-judging-yet-another-linear-mixed-model"><span class="header-section-number">13.13.3</span> People watching teasers in different orders and judging (Yet another linear mixed model)</h3>
<p>The file <code>teaser.csv</code> describes a study in which people watched teasers for different genres and reported whether they liked them. Load the file and tell the number of participants.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb559"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a>te <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/teaser.csv"</span>))</span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true" tabindex="-1"></a>te<span class="ot">&lt;-</span><span class="fu">within</span>(te,Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(Subject))</span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true" tabindex="-1"></a>te<span class="ot">&lt;-</span><span class="fu">within</span>(te,Order<span class="ot">&lt;-</span><span class="fu">factor</span>(Order))</span>
<span id="cb559-4"><a href="#cb559-4" aria-hidden="true" tabindex="-1"></a>te<span class="ot">&lt;-</span><span class="fu">within</span>(te,Teaser<span class="ot">&lt;-</span><span class="fu">factor</span>(Teaser))</span>
<span id="cb559-5"><a href="#cb559-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(te)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Subject Teaser   Order Liked
  &lt;fct&gt;   &lt;fct&gt;    &lt;fct&gt; &lt;dbl&gt;
1 19      thriller 4         1
2 20      action   3         1
3 20      comedy   2         0
4 20      horror   4         0
5 20      romance  1         0
6 20      thriller 5         1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb561"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Liked<span class="sc">~</span>Teaser,<span class="at">data=</span>te)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-156-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Investigate order effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(te<span class="sc">$</span>Order) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Liked <span class="sc">~</span> Order <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>te, <span class="at">family=</span>binomial, <span class="at">nAGQ=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: Liked
             Chisq Df Pr(&gt;Chisq)
(Intercept) 1.0392  1     0.3080
Order       3.9205  4     0.4169</code></pre>
</div>
</div>
<p>Conduct a linear mixed model analysis of variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb566"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(te<span class="sc">$</span>Teaser) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Liked <span class="sc">~</span> Teaser <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>te, <span class="at">family=</span>binomial, <span class="at">nAGQ=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb568"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: Liked
             Chisq Df Pr(&gt;Chisq)    
(Intercept)  1.209  1     0.2715    
Teaser      26.695  4  2.291e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb570"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(multcomp)</span></span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">mcp</span>(<span class="at">Teaser=</span><span class="st">"Tukey"</span>)),</span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>)) <span class="co"># Tukey means compare all pairs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: glmer(formula = Liked ~ Teaser + (1 | Subject), data = te, family = binomial, 
    nAGQ = 0)

Linear Hypotheses:
                        Estimate Std. Error z value Pr(&gt;|z|)    
comedy - action == 0     -3.7917     1.1361  -3.337 0.006763 ** 
horror - action == 0     -5.1417     1.2681  -4.054 0.000502 ***
romance - action == 0    -2.5390     1.1229  -2.261 0.118786    
thriller - action == 0   -1.5581     1.1684  -1.334 0.389097    
horror - comedy == 0     -1.3499     0.8909  -1.515 0.389097    
romance - comedy == 0     1.2528     0.6682   1.875 0.243191    
thriller - comedy == 0    2.2336     0.7420   3.010 0.018279 *  
romance - horror == 0     2.6027     0.8740   2.978 0.018279 *  
thriller - horror == 0    3.5835     0.9317   3.846 0.001080 ** 
thriller - romance == 0   0.9808     0.7217   1.359 0.389097    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
</section>
<section id="finding-number-of-unique-words-used-in-posts-by-males-and-females-a-generalized-linear-mixed-model" class="level3" data-number="13.13.4">
<h3 data-number="13.13.4" class="anchored" data-anchor-id="finding-number-of-unique-words-used-in-posts-by-males-and-females-a-generalized-linear-mixed-model"><span class="header-section-number">13.13.4</span> Finding number of unique words used in posts by males and females (A generalized linear mixed model)</h3>
<p>The file <code>vocab.csv</code> describes a study in which 50 posts by males and females were analyzed for the number of unique words used. Load the file and tell the number of participants.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a>vo <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">paste0</span>(<span class="fu">Sys.getenv</span>(<span class="st">"STATS_DATA_DIR"</span>),<span class="st">"/vocab.csv"</span>))</span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a>vo<span class="ot">&lt;-</span><span class="fu">within</span>(vo,Subject<span class="ot">&lt;-</span><span class="fu">factor</span>(Subject))</span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>vo<span class="ot">&lt;-</span><span class="fu">within</span>(vo,Sex<span class="ot">&lt;-</span><span class="fu">factor</span>(Sex))</span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a>vo<span class="ot">&lt;-</span><span class="fu">within</span>(vo,Order<span class="ot">&lt;-</span><span class="fu">factor</span>(Order))</span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a>vo<span class="ot">&lt;-</span><span class="fu">within</span>(vo,Social<span class="ot">&lt;-</span><span class="fu">factor</span>(Social))</span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(vo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Subject Sex   Social   Order Vocab
  &lt;fct&gt;   &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt; &lt;dbl&gt;
1 29      M     Facebook 3        46
2 29      M     Twitter  1        38
3 29      M     Gplus    2        22
4 30      F     Facebook 3       103
5 30      F     Twitter  2        97
6 30      F     Gplus    1        92</code></pre>
</div>
</div>
<p>Create an interaction plot and see how often the lines cross.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(vo,<span class="fu">interaction.plot</span>(Social,Sex,Vocab,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(vo<span class="sc">$</span>Vocab))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-161-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Perform Kolmogorov-Smirnov goodness-of-fit tests on Vocab for each level of Social using exponential distributions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb575"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(MASS)</span></span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">fitdistr</span>(vo[vo<span class="sc">$</span>Social <span class="sc">==</span> <span class="st">"Facebook"</span>,]<span class="sc">$</span>Vocab, <span class="st">"exponential"</span>)<span class="sc">$</span>estimate</span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(vo[vo<span class="sc">$</span>Social <span class="sc">==</span> <span class="st">"Facebook"</span>,]<span class="sc">$</span>Vocab, <span class="st">"pexp"</span>, <span class="at">rate=</span>fit[<span class="dv">1</span>], <span class="at">exact=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(vo[vo$Social == "Facebook", ]$Vocab, "pexp", : ties
should not be present for the Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  vo[vo$Social == "Facebook", ]$Vocab
D = 0.17655, p-value = 0.2734
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb578"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">fitdistr</span>(vo[vo<span class="sc">$</span>Social <span class="sc">==</span> <span class="st">"Twitter"</span>,]<span class="sc">$</span>Vocab, <span class="st">"exponential"</span>)<span class="sc">$</span>estimate</span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(vo[vo<span class="sc">$</span>Social <span class="sc">==</span> <span class="st">"Twitter"</span>,]<span class="sc">$</span>Vocab, <span class="st">"pexp"</span>, <span class="at">rate=</span>fit[<span class="dv">1</span>], <span class="at">exact=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ks.test.default(vo[vo$Social == "Twitter", ]$Vocab, "pexp", rate =
fit[1], : ties should not be present for the Kolmogorov-Smirnov test</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  vo[vo$Social == "Twitter", ]$Vocab
D = 0.099912, p-value = 0.8966
alternative hypothesis: two-sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb581"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">fitdistr</span>(vo[vo<span class="sc">$</span>Social <span class="sc">==</span> <span class="st">"Gplus"</span>,]<span class="sc">$</span>Vocab, <span class="st">"exponential"</span>)<span class="sc">$</span>estimate</span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(vo[vo<span class="sc">$</span>Social <span class="sc">==</span> <span class="st">"Gplus"</span>,]<span class="sc">$</span>Vocab, <span class="st">"pexp"</span>, <span class="at">rate=</span>fit[<span class="dv">1</span>], <span class="at">exact=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact one-sample Kolmogorov-Smirnov test

data:  vo[vo$Social == "Gplus", ]$Vocab
D = 0.14461, p-value = 0.5111
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>Use a generallized linear mixed model to conduct a test of order effects on Vocab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb583"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(vo<span class="sc">$</span>Sex) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb583-2"><a href="#cb583-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(vo<span class="sc">$</span>Order) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb583-3"><a href="#cb583-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Vocab <span class="sc">~</span> Sex<span class="sc">*</span>Order <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>vo, <span class="at">family=</span><span class="fu">Gamma</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb583-4"><a href="#cb583-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: Vocab
                Chisq Df Pr(&gt;Chisq)    
(Intercept) 1179.0839  1     &lt;2e-16 ***
Sex            1.3687  1     0.2420    
Order          0.7001  2     0.7047    
Sex:Order      2.0655  2     0.3560    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Conduct a test of Vocab by Sex and Social using a generalized linear mixed model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb585"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(vo<span class="sc">$</span>Sex) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb585-2"><a href="#cb585-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(vo<span class="sc">$</span>Social) <span class="ot">&lt;-</span> <span class="st">"contr.sum"</span></span>
<span id="cb585-3"><a href="#cb585-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">glmer</span>(Vocab <span class="sc">~</span> Sex<span class="sc">*</span>Social <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>vo, <span class="at">family=</span><span class="fu">Gamma</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb585-4"><a href="#cb585-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: Vocab
                Chisq Df Pr(&gt;Chisq)    
(Intercept) 1172.6022  1  &lt; 2.2e-16 ***
Sex            0.7925  1     0.3733    
Social        26.2075  2  2.038e-06 ***
Sex:Social     0.3470  2     0.8407    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Perform post hoc pairwise comparisons among levels of Social adjusted with Holm’s sequential Bonferroni procedure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb587"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(multcomp)</span></span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m, <span class="fu">mcp</span>(<span class="at">Social=</span><span class="st">"Tukey"</span>)),</span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>)) <span class="co"># Tukey means compare all pairs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mcp2matrix(model, linfct = linfct): covariate interactions found --
default contrast might be inappropriate</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: glmer(formula = Vocab ~ Sex * Social + (1 | Subject), data = vo, 
    family = Gamma(link = "log"))

Linear Hypotheses:
                        Estimate Std. Error z value Pr(&gt;|z|)    
Gplus - Facebook == 0     0.8676     0.2092   4.148 6.72e-05 ***
Twitter - Facebook == 0  -0.1128     0.2026  -0.556    0.578    
Twitter - Gplus == 0     -0.9803     0.2071  -4.734 6.60e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
</section>
<section id="judging-search-effort-among-different-search-engines-another-generalized-linear-mixed-model" class="level3" data-number="13.13.5">
<h3 data-number="13.13.5" class="anchored" data-anchor-id="judging-search-effort-among-different-search-engines-another-generalized-linear-mixed-model"><span class="header-section-number">13.13.5</span> Judging search effort among different search engines (Another generalized linear mixed model)</h3>
<p>Recode Effort from <code>websearch3.csv</code> as an ordinal response.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb590"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a>ws<span class="ot">&lt;-</span><span class="fu">within</span>(ws,Effort<span class="ot">&lt;-</span><span class="fu">factor</span>(Effort))</span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a>ws<span class="ot">&lt;-</span><span class="fu">within</span>(ws,Effort<span class="ot">&lt;-</span><span class="fu">ordered</span>(Effort))</span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Subject      Engine   Order     Searches     Effort
 1      : 3   Bing  :30   1:30   Min.   : 92.0   1: 6  
 2      : 3   Google:30   2:30   1st Qu.:139.0   2: 8  
 3      : 3   Yahoo :30   3:30   Median :161.0   3:19  
 4      : 3                      Mean   :161.6   4:16  
 5      : 3                      3rd Qu.:181.8   5:16  
 6      : 3                      Max.   :236.0   6:15  
 (Other):72                                      7:10  </code></pre>
</div>
</div>
<p>Conduct an ordinal logistic regression to determine Effort by Engine, using a generalized linear mixed model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb592"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal) <span class="co"># provides clmm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ordinal'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    slice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(RVAideMemoire) # provides Anova.clmm</span></span>
<span id="cb595-2"><a href="#cb595-2" aria-hidden="true" tabindex="-1"></a>ws2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(ws)</span>
<span id="cb595-3"><a href="#cb595-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">clmm</span>(Effort<span class="sc">~</span>Engine <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject),<span class="at">data=</span>ws2)</span>
<span id="cb595-4"><a href="#cb595-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova.clmm</span>(m,<span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Effort
       LR Chisq Df Pr(&gt;Chisq)  
Engine    8.102  2     0.0174 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Perform pairwise comparisons of Engine on Effort.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb597"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pin=</span><span class="fu">c</span>(<span class="fl">2.75</span>,<span class="fl">1.25</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.numeric</span>(Effort) <span class="sc">~</span> Engine,<span class="at">data=</span>ws2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week13_files/figure-html/unnamed-chunk-168-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb598"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(lme4)</span></span>
<span id="cb598-2"><a href="#cb598-2" aria-hidden="true" tabindex="-1"></a><span class="co">#. library(multcomp)</span></span>
<span id="cb598-3"><a href="#cb598-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="fu">as.numeric</span>(Effort)<span class="sc">~</span>Engine <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Subject), <span class="at">data=</span>ws2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(m,<span class="fu">mcp</span>(<span class="at">Engine=</span><span class="st">"Tukey"</span>)),<span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lmer(formula = as.numeric(Effort) ~ Engine + (1 | Subject), data = ws2)

Linear Hypotheses:
                    Estimate Std. Error z value Pr(&gt;|z|)  
Google - Bing == 0  -0.03333    0.42899  -0.078   0.9381  
Yahoo - Bing == 0    1.10000    0.42899   2.564   0.0247 *
Yahoo - Google == 0  1.13333    0.42899   2.642   0.0247 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- holm method)</code></pre>
</div>
</div>
<!--

How many people prefer website A over website B?
How many people prefer website A, website B, or website C?
How many males vs females prefer website A over website B?
How many males vs females prefer website A, website B, or website C?
On average, how many pages of website A vs B did people view?
On average, how long did people take to complete a task based on which of two tools they used?
On average, how long did people take to complete a task based on which of three tools they used?
On average, how long did people take to complete a task based on which of two tools they used (another pair of tools)?
On average, how many words per minute did people achieve writing with three different text entry systems?
On average, how long does it take to find contacts depending on whether you search or scroll?
Which takes more effort, searching or scrolling for contacts?
Which is more error-prone, searching or scrolling for contacts?
-->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week12.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Milestone 4; Take-home Exam</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>