<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Welcome to the Command Line - 16&nbsp; Text manipulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./vim.html" rel="next">
<link href="./fileManipulation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>
#quarto-sidebar .menu-text {
  display: flex;
}
#quarto-sidebar .chapter-number {
  display: block;
  width: 1.5rem;
  text-align: right;
}
#quarto-sidebar .chapter-title {
  display: block;
  padding-left: 8px;
  text-indent: -2px;
  width: 100%;
}
</style>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./textManipulation.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Text manipulation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Welcome to the Command Line</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./macSetupIntelFull.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">macOS full setup for Intel machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./macSetupIntelMinimal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">macOS minimal setup for Intel machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./macSetupM1Full.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">macOS full setup for M1/2 machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./macSetupM1Minimal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">macOS minimal setup for M1/2 machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whyCLI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Why CLI (command line interface)?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./whyVIM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Why VIM (text editor)?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unixNature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The Unix nature</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./man.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Unix manual</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./terminal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Terminal emulators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./macGeneral/iTerm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">iTerm (terminal emulator for macOS)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bash.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><code>bash</code>, a command processor</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tmux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title"><code>tmux</code>, a terminal multiplexer</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bearings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Getting your bearings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fileIO.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Unix File Input / Output</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fileManipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">File manipulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./textManipulation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Text manipulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vim, a text editor</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./macGeneral/macDotFiles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">macOS dotfiles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./macGeneral/macVim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">MacVim, a text editor</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#an-advanced-use-of-grep" id="toc-an-advanced-use-of-grep" class="nav-link active" data-scroll-target="#an-advanced-use-of-grep"><span class="header-section-number">16.1</span> An advanced use of <code>grep</code></a></li>
  <li><a href="#examining-a-complicated-regular-expression" id="toc-examining-a-complicated-regular-expression" class="nav-link" data-scroll-target="#examining-a-complicated-regular-expression"><span class="header-section-number">16.2</span> Examining a complicated regular expression</a></li>
  <li><a href="#an-example-of-grep-with-a-posix-bracket-expression" id="toc-an-example-of-grep-with-a-posix-bracket-expression" class="nav-link" data-scroll-target="#an-example-of-grep-with-a-posix-bracket-expression"><span class="header-section-number">16.3</span> An example of <code>grep</code> with a POSIX bracket expression</a></li>
  <li><a href="#the-problem-of-email-addresses" id="toc-the-problem-of-email-addresses" class="nav-link" data-scroll-target="#the-problem-of-email-addresses"><span class="header-section-number">16.4</span> The problem of email addresses</a></li>
  <li><a href="#find-and-replace" id="toc-find-and-replace" class="nav-link" data-scroll-target="#find-and-replace"><span class="header-section-number">16.5</span> Find and replace</a></li>
  <li><a href="#pcre" id="toc-pcre" class="nav-link" data-scroll-target="#pcre"><span class="header-section-number">16.6</span> PCRE</a></li>
  <li><a href="#lazy-and-greedy-regular-expressions" id="toc-lazy-and-greedy-regular-expressions" class="nav-link" data-scroll-target="#lazy-and-greedy-regular-expressions"><span class="header-section-number">16.7</span> Lazy and Greedy Regular Expressions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Text manipulation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The most important kind of text manipulation is the use of <em>regular expressions</em>. These are patterns representing text. The name is usually abbreviated to <em>regex</em>. The first way people learn about regexes is often the Unix utility <code>grep</code>. By default, this utility searches for text matching a regular expression in a file or files and returns the line(s) containing a match.</p>
<p>The simplest regular expression is literal text. For example, I could search for my name in a file called <code>example.md</code> by saying</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> Mick example.md</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and the output would be any lines in <code>example.md</code> containing my name, written to <code>stdout</code>, which by default is the screen. There are many more advanced uses of <code>grep</code>.</p>
<section id="an-advanced-use-of-grep" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="an-advanced-use-of-grep"><span class="header-section-number">16.1</span> An advanced use of <code>grep</code></h2>
<p>I needed the email addresses of job candidates in the file <code>candidates.md</code>. Following are a couple of approaches of using grep to find them. Because this use of <code>grep</code> is quite complicated, I’ll spend a few paragraphs dissecting it.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-o</span> <span class="st">' [a-z0-9.]+@[a-z0-9.]+( |$)'</span> candidates.md <span class="kw">|</span> <span class="fu">nl</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-o</span> <span class="st">' [[:graph:]]+@[[:graph:]]+( |$)'</span> candidates.md <span class="kw">|</span> <span class="fu">nl</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-o</span> <span class="st">' [[:graph:]]+@[[:graph:]]+( |$)'</span> candidates.md <span class="op">&gt;</span>emails.md</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The first command above includes the option <code>-o</code> which means to only return the matching part of the line. This way, I just get the email addresses and nothing else. The regular expression here is enclosed in apostrophes, then comes the name of the file I’m searching in, <code>candidates.md</code>, then a pipe character, <code>|</code>, which pipes the output of the first command to the second command, in this case the <code>nl</code> command, which numbers lines. Since I know that there are 21 lines in the <code>candidates.md</code> file, I expect to get 21 numbered lines in the final output, but I only got twenty. Let’s examine the regular expression to see why this is.</p>
</section>
<section id="examining-a-complicated-regular-expression" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="examining-a-complicated-regular-expression"><span class="header-section-number">16.2</span> Examining a complicated regular expression</h2>
<p>The first item in the regular expression is a literal space character because I knew that the email addresses all came after a space following the candidates’ names.</p>
<p>Next is a <em>bracket expression</em>. A bracket expression contains a list of characters in square brackets. It matches any one of these characters. It also allows some special characters as used here. For example, instead of writing out the entire alphabet, it allows <code>a-z</code> to stand for all the lowercase letters. I happened to know that the email addresses in this file had no uppercase characters, or I could have added <code>A-Z</code> to the bracket expression. I also knew that some candidates included numbers in their email addresses, so I also included <code>0-9</code>, which stands for any digit. I also knew that some candidates included a dot in their email addresses, so I also included <code>.</code> in the bracket expression. So far, so good. I’ve matched any single character in an email address.</p>
<p>Next is a plus sign <code>+</code>. This symbol says to match a series of one or more of the previous element. Since the previous element is a bracket expression, this will match any string of characters containing letters, numbers, or dots in any combination. By itself, it would only stop when it reached a space or control character.</p>
<p>Next is an at sign <code>@</code>. This occurs in every email address and it is the main way that I distinguish between email addresses and other items in the <code>candidates.md</code> file. Now my regular expression won’t match anything except an email address.</p>
<p>Next is another bracket expression, just like the one above. It matches the end of the email address, which always contains a dot and some text. Usually, it’s <code>utexas.edu</code> in this file, but not always. I don’t think it contains any digits, but I was too lazy to check.</p>
<p>Last is a set of parentheses with a special construct inside them. This is a way of letting regular expressions match a choice. The pipe symbol <code>|</code> in this context means <em>or</em>. So this construct matches a space or the end of a line. Wait, what? The end of a line? Yes, the dollar sign <code>$</code> in this context stands for the end of a line. Lines are actually ended by invisible control characters and, if we put one of those in here, it would unintentionally end the regular expression, so we need a shorthand that represents the end of a line. The dollar sign is almost always used for that, although we will later learn another context in which the dollar sign means the end of a file instead of the end of a line. This <em>or</em> construct differs from bracket expressions in an important way. The elements on either side of the <code>|</code> symbol can be of any length. For example, I may be called Mick or Michael in a file, so I may want to search for the regular expression <code>(Mick|Michael)</code> if I’m looking for my name. This differs from a bracket expression because it is searching for a string, not an individual character.</p>
</section>
<section id="an-example-of-grep-with-a-posix-bracket-expression" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="an-example-of-grep-with-a-posix-bracket-expression"><span class="header-section-number">16.3</span> An example of <code>grep</code> with a POSIX bracket expression</h2>
<p>The second command above worked a little better because one candidate had an underscore in their email address. I would have needed to include the underscore explicitly in the first one. I used the <code>nl</code> command to see if all the addresses were being picked up, which is how I noticed the underscore. The construct <code>[:graph:]</code> is called a POSIX bracket expression. You can find a list of them at <a href="https://www.regular-expressions.info/posixbrackets.html">https://www.regular-expressions.info/posixbrackets.html</a>. They need to be enclosed inside another bracket expression, hence the double square brackets. The POSIX bracket expression <code>[:graph:]</code> represents any single visible character. That is, any character except spaces and control characters.</p>
<p>The second command above has the added advantage that it is easier to read and remember. Don’t try to use it for all email addresses, though, because some legal email addresses are more complicated than this! I only used it because I knew that there were no unusual email addresses in my file and this was borne out by the fact that it returned 21 email addresses from a file 21 lines long.</p>
<p>The third command above was not strictly necessary. Since I only had 21 email addresses they all fit on the screen and I could have copied and pasted them into the email message I wanted to send to all candidates but instead I decided to put them all in a file and paste that file into the email. Not all email programs will allow that, though. Anyway, the third command sends its output to the file <code>emails.md</code> by using the <code>&gt;</code> redirection operator that redirects <code>stdout</code> away from the screen and into a file. On traditional Unix systems you could also use the <code>&gt;</code> redirection operator to redirect <code>stdout</code> to a printer attached to the computer. Since most printers today are wireless, that’s not practical, but it illustrates how nearly everything in Unix can be addressed as if it were a file.</p>
</section>
<section id="the-problem-of-email-addresses" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="the-problem-of-email-addresses"><span class="header-section-number">16.4</span> The problem of email addresses</h2>
<p>The question and answers at <a href="https://stackoverflow.com/questions/2898463/using-grep-to-find-all-emails">https://stackoverflow.com/questions/2898463/using-grep-to-find-all-emails</a> give some idea of how difficult it would be to match <em>any</em> valid email address. In the above example, I knew that there was exactly one column of email addresses in a file arranged as a table. There were few enough email addresses that I could fit them on one screen and visually inspect them for oddities. Even so, I did not notice the underscore in one address until it was passed over by the first attempt to extract it. In school you will mostly see easy, well-formed files, but in the working world you may be surprised by all the eccentricities you will experience when trying to use externally sourced files.</p>
</section>
<section id="find-and-replace" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="find-and-replace"><span class="header-section-number">16.5</span> Find and replace</h2>
<p>There are vastly many ways to find and replace text in files, some using a combination of <code>grep</code> and <code>sed</code>, others using a combination of <code>find</code> and <code>sed</code>, still others using <code>awk</code>. Personally, I use <code>perl</code> in one of two ways.</p>
<p>To replace old with new in .txt files, say</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">perl</span> <span class="at">-ipe</span> <span class="st">'s/old/new/g;'</span> <span class="pp">*</span>.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which is destructive, though, so you have to either do it right the first time or say</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">perl</span> <span class="at">-i.bk</span> <span class="at">-pe</span> <span class="st">'s/old/new/g;'</span> <span class="pp">*</span>.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to get backup files for each altered .txt file. Then check the new files and, if they’re good, say <code>trash *.bk</code>. (Bear in mind that there’s no obvious way to <em>undo</em> the programs above so, if you write a bad regular expression and you have no backups, you may find yourself in a lot of trouble.)</p>
<p>Consider the options to this command, <code>i</code>, <code>p</code>, and <code>e</code>. To find out more about them, you might say <code>man perl</code> but you would find that it introduces you to the <code>perldoc</code> system instead of explaining them. You would actually say <code>perldoc perlrun</code> to find out their meanings.</p>
<p>The <code>i</code> option says to edit files in place. It renames the input file if you include some characters after the <code>i</code>. In this case, I’ve said <code>i.bk</code> so it adds <code>.bk</code> to the filename. Then it opens the original contents of that file and does whatever you tell it to do under the original name.</p>
<p>The <code>p</code> option causes <code>perl</code> to assume the following loop around your program:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode perl code-with-copy"><code class="sourceCode perl"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> (&lt;&gt;) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  ... <span class="co"># your program will go here</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>} <span class="kw">continue</span> {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span> <span class="ot">or</span> <span class="fu">die</span> <span class="ot">"</span><span class="st">-p destination: </span><span class="wa">$!</span><span class="ch">\n</span><span class="ot">"</span>;</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This loop means that your program (see below) will try to run on every line of input as long as there is input and unless the output encounters a write error, in which case it will abort.</p>
<p>The <code>e</code> option says that what comes next is a program fragment, usually a one-line program.</p>
<p>The one line program in this case is <code>s/old/new/g;</code>. Since it is enclosed in a while loop (see above) it runs on every line of input unless it encounters an error, in which case it will abort. <code>s</code> stands for substitute and you could actually write out the word substitute if it helps you remember. Next is a separator character, in the usual case it is <code>/</code> but you could substitute another character if there is a <code>/</code> in the text you want to match. For instance, I usually use <code>:</code> if there is a <code>/</code> in the input. If there is both a colon and a slash, e.g., in a URL, I usually use a <code>!</code>. Anyway, this separator character separates what I want to match (old) with what I want to replace it with (new). After the second separator, I can give options, in this case <code>g</code> for global. It is an annoying feature of the <code>s</code> command that it only replaces the first instance of <code>old</code> with <code>new</code> on each line. If <code>old</code> may occur two or more times on each line, you must use the <code>g</code> option.</p>
<p>The last item in the program is a semicolon <code>;</code>. This is an example of what many people hate about <code>perl</code>. It is always correct to include a semicolon at the end of a statement, but <code>perl</code> will often let you get away with omitting it. This is one of those cases, so you don’t really need a semicolon here but you would if you wanted to include two <code>perl</code> statements in your program fragment. The reason people hate this is because it is hard to remember the rules allowing you to omit the semicolon. <code>perl</code> was really intended to be used every day. Back in the years when I did use <code>perl</code> every day, I found it easy to remember all the idiosyncracies like that. Nowadays, not so much.</p>
<p>After the program comes the files I want to operate on, all files ending in <code>.txt</code> by using the wildcard character <code>*</code> that matches anything in a filename. Unfortunately, there are two major contexts for using <code>*</code>. One is its use in the <code>bash</code> shell, which is how it’s used here. You must be able to distinguish between the <code>bash</code> shell and the utilities it invokes. In the <code>bash</code> shell, <code>*</code> is a wildcard character, which replaces any series of legal pathname or filename characters. The other major context is in utilities like <code>sed</code>, <code>awk</code>, <code>perl</code>, and <code>vim</code>, where it is used as a quantifier in regular expressions. <code>bash</code> itself has no concept of regular expressions. In a regular expression, the <code>*</code> stands for <em>zero or more occurrences of the element that preceded it</em>. This causes a lot of confusion for users of regular expressions and users of <code>bash</code>!</p>
</section>
<section id="pcre" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="pcre"><span class="header-section-number">16.6</span> PCRE</h2>
<p>The most common kind of regular expression is called the PCRE, which stands for <em>Perl Compatible Regular Expression</em>. Although <code>perl</code> has fallen in popularity, its regular expressions have not and most text-handling utilities (but not all!) follow the regular expression syntax used in <code>perl</code>. I learned regular expressions from a book, <span class="citation" data-cites="Friedl2006">Friedl (<a href="references.html#ref-Friedl2006" role="doc-biblioref">2006</a>)</span>, in its most recent edition. This covers PCRE plus all the variants and was available free online the last time I looked. I can’t emphasize enough that, before the first edition of this book in 1997, there was no comprehensive reference to regular expressions. Hence, most older software developers have read it. Now, many other resources are available, such as <a href="https://www.regular-expressions.info/tutorial.html">https://www.regular-expressions.info/tutorial.html</a>.</p>
</section>
<section id="lazy-and-greedy-regular-expressions" class="level2" data-number="16.7">
<h2 data-number="16.7" class="anchored" data-anchor-id="lazy-and-greedy-regular-expressions"><span class="header-section-number">16.7</span> Lazy and Greedy Regular Expressions</h2>
<p>One concept in regular expressions revolves around the question of whether a given symbol is <em>greedy</em> or <em>lazy</em>. A greedy quantifier looks as far ahead in the text as it can for a match. A lazy quantifier stops looking as soon as it finds a valid match. This is important when a pattern occurs more than once on a given line. Take the expression <code>.*</code> which matches any character at all, represented by dot <code>.</code>, and then zero or more occurrences of any character, represented by <code>*</code>. This is greedy. It will, by itself, match a whole line of text. Greedy quantifiers include <code>*</code>, <code>+</code>, <code>?</code>, and <code>{</code><em>num,num</em><code>}</code>. Lazy quantifiers are less common and not all tools support them. These quantifiers include <code>??</code>, <code>*?</code>, <code>+?</code>, and <code>{</code><em>num,num</em><code>}?</code>, according to <span class="citation" data-cites="Friedl2006">Friedl (<a href="references.html#ref-Friedl2006" role="doc-biblioref">2006</a>)</span>, p 141.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Friedl2006" class="csl-entry" role="listitem">
Friedl, Jeffrey E. F. 2006. <em>Mastering Regular Expressions, 3rd Edition</em>. Sebastopol, CA: O’Reilly Media.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./fileManipulation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">File manipulation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./vim.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Vim, a text editor</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>